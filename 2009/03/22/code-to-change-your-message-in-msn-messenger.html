<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta property="og:title" content="Code to change your message in MSN messenger">
<meta property="og:description" content="I&rsquo;ve always wanted to know how does the code to show what was I listening to looked like. I found it after installing XMPlay and XMPlay MSN Plug-in. The plug-in zip had the plug-in itself and its source code. And what a neat source code (-:.
Basically, you just send a message to the MSN UI API with a defined data structure. And to remove the message, just send again with an empty string.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://kinoshita.eti.br/2009/03/22/code-to-change-your-message-in-msn-messenger.html"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2009-03-22T00:00:00+00:00">
<meta property="article:modified_time" content="2009-03-22T00:00:00+00:00">
<link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.de6eddbd022e2ff31c7675270a2ccd00d63fa2c52ca6dc77e1a974bc7b0b7103.css integrity="sha256-3m7dvQIuL/McdnUnCizNANY/osUsptx34al0vHsLcQM=">
<title>kinow | Code to change your message in MSN messenger</title>
</head>
<body>
<header role=banner class=content>
<nav id=nav aria-label=Main role=navigation class=content>
<ul><li>
<a href=/><i data-feather=about></i> About</a>
</li><li>
<a href=/blog/><i data-feather=blog></i> Blog</a>
</li><li>
<a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a>
</li>
</ul>
</nav>
</header>
<main>
<article class=content>
<h2>Code to change your message in MSN messenger</h2><div class=metadata>
<i data-feather=calendar></i>
<time datetime=2009-03-22>Mar 22, 2009</time>
</div>
<p>I&rsquo;ve always wanted to know how does the code to show what was I listening to looked like. I found it after installing XMPlay and XMPlay MSN Plug-in. The plug-in zip had the plug-in itself and its source code. And what a neat source code (-:.</p>
<p>Basically, you just send a message to the MSN UI API with a defined data structure. And to remove the message, just send again with an empty string.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#080;font-style:italic>/*
</span><span style=color:#080;font-style:italic>Bruno de Paula Kinoshita
</span><span style=color:#080;font-style:italic>original src code:
</span><span style=color:#080;font-style:italic>XMPlay MSN Plugin (c) 2005-2006 Elliott Sales de Andrade
</span><span style=color:#080;font-style:italic>*/</span>

<span style=color:teal>#include</span> <span style=color:teal>&lt;cstdlib&gt;</span><span style=color:teal>
</span><span style=color:teal>#include</span> <span style=color:teal>&lt;iostream&gt;</span><span style=color:teal>
</span><span style=color:teal>#include</span> <span style=color:teal>&lt;windows.h&gt;</span><span style=color:teal>
</span><span style=color:teal></span>
using namespace std;

<span style=color:navy;font-weight:700>typedef</span> <span style=color:navy;font-weight:700>struct</span> {
BOOL showCues;
BOOL keepOnClose;
} MSNStuff;
<span style=color:navy;font-weight:700>static</span> MSNStuff msnConf;

<span style=color:navy;font-weight:700>void</span> setNowPlaying( <span style=color:navy;font-weight:700>char</span> *title)
{
    wchar_t *lpMsn;
    <span style=color:navy;font-weight:700>int</span> strLen = <span style=color:#00f>20</span>;
    HWND xmpwin;
    HWND msnui=<span style=color:#00f>0</span>;
    
    lpMsn = (wchar_t*)calloc(<span style=color:#00f>1024</span>,<span style=color:#00f>1024</span>);
    <span style=color:#080;font-style:italic>// stuff for MSN before...
</span><span style=color:#080;font-style:italic></span>    memcpy(lpMsn, L&amp;quot;<span style=color:#a61717;background-color:#e3d2d2>\</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>92</span>;&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>48</span>;Music<span style=color:#a61717;background-color:#e3d2d2>\</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>92</span>;&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>48</span>;<span style=color:#00f>1</span><span style=color:#a61717;background-color:#e3d2d2>\</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>92</span>;&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>48</span>;{<span style=color:#00f>0</span>}<span style=color:#a61717;background-color:#e3d2d2>\</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>92</span>;&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>48</span>;&amp;quot;, <span style=color:#00f>17</span>*<span style=color:#00f>2</span>);
    <span style=color:#080;font-style:italic>// actual title...
</span><span style=color:#080;font-style:italic></span>    strLen=MultiByteToWideChar(false?CP_UTF8:CP_ACP,<span style=color:#00f>0</span>,title,-<span style=color:#00f>1</span>,lpMsn+<span style=color:#00f>17</span>,<span style=color:#00f>492</span>)-<span style=color:#00f>1</span>;<span style=color:#a61717;background-color:#e3d2d2>Â</span>  <span style=color:#080;font-style:italic>/* 1024/2 - 20 */</span>
    <span style=color:#080;font-style:italic>// stuff for MSN after...
</span><span style=color:#080;font-style:italic></span>    memcpy(lpMsn + <span style=color:#00f>17</span> + strLen, L&amp;quot;<span style=color:#a61717;background-color:#e3d2d2>\</span>&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>92</span>;&amp;<span style=color:#a61717;background-color:#e3d2d2>#</span><span style=color:#00f>48</span>;&amp;quot;, <span style=color:#00f>3</span>*<span style=color:#00f>2</span>);
    strLen += <span style=color:#00f>20</span>;
    
    COPYDATASTRUCT msndata;
    msndata.dwData = <span style=color:#00f>0x547</span>;
    msndata.lpData = (<span style=color:navy;font-weight:700>void</span>*)lpMsn;
    msndata.cbData = strLen * <span style=color:#00f>2</span>;
    
    <span style=color:navy;font-weight:700>while</span> ( msnui = FindWindowEx(NULL, msnui, &amp;quot;MsnMsgrUIManager&amp;quot;, NULL) )
        SendMessage(msnui, WM_COPYDATA, (WPARAM)xmpwin, (LPARAM)&amp;amp;msndata);
}

<span style=color:navy;font-weight:700>int</span> main(<span style=color:navy;font-weight:700>int</span> argc, <span style=color:navy;font-weight:700>char</span> *argv[])
{
    <span style=color:navy;font-weight:700>char</span> *title;
    
    <span style=color:navy;font-weight:700>if</span> ( argc == <span style=color:#00f>1</span> )
        title = &amp;quot;&amp;quot;;
    <span style=color:navy;font-weight:700>else</span>
        title = argv[<span style=color:#00f>1</span>];
    
    setNowPlaying ( title );
    
    <span style=color:navy;font-weight:700>return</span> EXIT_SUCCESS;
}
</code></pre></div>
<aside class=links>
<a class=previous href=https://kinoshita.eti.br/2009/03/06/displaying-japanese-characters-in-java-swing.html>&#171; Previous</a>
<a class=next href=https://kinoshita.eti.br/2010/04/07/ccm-hudson-plugin.html>Next &#187;</a>
</aside>
</article>
</main>
<footer role=contentinfo>
<ul id=social-media-icons>
<li>
<a href=https://www.instagram.com/brunokinoshita/>
<img src=/assets/icons/instagram.png alt="Instagram link">
</a>
</li>
<li>
<a href=https://twitter.com/kinow/>
<img src=/assets/icons/twitter.png alt="Twitter link">
</a>
</li>
<li>
<a href=https://github.com/kinow/>
<img src=/assets/icons/github.png alt="GitHub link">
</a>
</li>
<li>
<a href=/feed.xml>
<img src=/assets/icons/news.png alt="RSS feed link">
</a>
</li>
</ul>
</footer>
</body>
</html>