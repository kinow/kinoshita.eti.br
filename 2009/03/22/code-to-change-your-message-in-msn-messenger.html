<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://kinoshita.eti.br/2009/03/22/code-to-change-your-message-in-msn-messenger.html"><meta property="og:site_name" content="kinow"><meta property="og:title" content="Code to change your message in MSN messenger"><meta property="og:description" content="I&amp;rsquo;ve always wanted to know how does the code to show what was I listening to looked like. I found it after installing XMPlay and XMPlay MSN Plug-in. The plug-in zip had the plug-in itself and its source code. And what a neat source code (-:.
Basically, you just send a message to the MSN UI API with a defined data structure. And to remove the message, just send again with an empty string."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2009-03-22T00:00:00+00:00"><meta property="article:modified_time" content="2025-02-16T08:42:56+01:00"><meta property="article:tag" content="C++"><meta property="og:image" content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta property="fb:admins" content="bruno.kinoshita"><meta name=twitter:title content="Code to change your message in MSN messenger"><meta name=twitter:description content="I&rsquo;ve always wanted to know how does the code to show what was I listening to looked like. I found it after installing XMPlay and XMPlay MSN Plug-in. The plug-in zip had the plug-in itself and its source code. And what a neat source code (-:.
Basically, you just send a message to the MSN UI API with a defined data structure. And to remove the message, just send again with an empty string."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta name=twitter:site content="@kinow"><link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2009/03/22/code-to-change-your-message-in-msn-messenger/feed.xml title=kinow><link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.ecb27dc5d5ced6616f17336fdf32a78aff8278ec4b599f9e5cdc5bb8a09a9f28.css integrity="sha256-7LJ9xdXO1mFvFzNv3zKniv+CeOxLWZ+eXNxbuKCanyg="><title>kinow | Code to change your message in MSN messenger</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Code to change your message in MSN messenger","headline":"Code to change your message in MSN messenger","alternativeHeadline":"","description":"I\u0026rsquo;ve always wanted to know how does the code to show what was I listening to looked like. I found it after installing XMPlay and XMPlay MSN Plug-in. The plug-in zip had the plug-in itself and its source code. And what a neat source code (-:.\nBasically, you just send a message to the MSN UI API with a defined data structure. And to remove the message, just send again with an empty string.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kinoshita.eti.br\/2009\/03\/22\/code-to-change-your-message-in-msn-messenger.html"},"author":{"@type":"Person","name":""},"creator":{"@type":"Person","name":""},"accountablePerson":{"@type":"Person","name":""},"copyrightHolder":"kinow","copyrightYear":"2009","dateCreated":"2009-03-22T00:00:00.00Z","datePublished":"2009-03-22T00:00:00.00Z","dateModified":"2025-02-16T08:42:56.00Z","publisher":{"@type":"Organization","name":"kinow","url":"https://kinoshita.eti.br/","logo":{"@type":"ImageObject","url":"https:\/\/kinoshita.eti.br\/","width":"32","height":"32"}},"image":"https://kinoshita.eti.br/","url":"https:\/\/kinoshita.eti.br\/2009\/03\/22\/code-to-change-your-message-in-msn-messenger.html","wordCount":"218","genre":["c\u002b\u002b"],"keywords":[]}</script></head><body><header role=banner class=content><nav id=nav aria-label=Main role=navigation class=content><ul style=position:relative><li><a href=/><i data-feather=about></i> About</a></li><li><a href=/blog/><i data-feather=blog></i> Blog</a></li><li><a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a></li><li style=position:absolute;right:0;bottom:-.75rem;text-align:right><span style=text-transform:uppercase;font-weight:700;font-size:3rem;color:#fffefa;line-height:normal;letter-spacing:-.1rem>Kinow</span></li></ul></nav></header><main><article class=content><h1>Code to change your message in MSN messenger</h1><div class=metadata><i data-feather=calendar></i>
<time datetime=2009-03-22>Mar 22, 2009</time></div><aside><nav id=TableOfContents></nav></aside><p>I&rsquo;ve always wanted to know how does the code to show what was I listening to looked like. I found it after installing XMPlay and XMPlay MSN Plug-in. The plug-in zip had the plug-in itself and its source code. And what a neat source code (-:.</p><p>Basically, you just send a message to the MSN UI API with a defined data structure. And to remove the message, just send again with an empty string.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#177500>/*
</span></span></span><span style=display:flex><span><span style=color:#177500>Bruno de Paula Kinoshita
</span></span></span><span style=display:flex><span><span style=color:#177500>original src code:
</span></span></span><span style=display:flex><span><span style=color:#177500>XMPlay MSN Plugin (c) 2005-2006 Elliott Sales de Andrade
</span></span></span><span style=display:flex><span><span style=color:#177500>*/</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#633820>#include</span> <span style=color:#633820>&lt;cstdlib&gt;</span><span style=color:#633820>
</span></span></span><span style=display:flex><span><span style=color:#633820>#include</span> <span style=color:#633820>&lt;iostream&gt;</span><span style=color:#633820>
</span></span></span><span style=display:flex><span><span style=color:#633820>#include</span> <span style=color:#633820>&lt;windows.h&gt;</span><span style=color:#633820>
</span></span></span><span style=display:flex><span><span style=color:#633820></span>
</span></span><span style=display:flex><span><span style=color:#000>using</span> <span style=color:#000>namespace</span> <span style=color:#000>std</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>typedef</span> <span style=color:#a90d91>struct</span> {
</span></span><span style=display:flex><span><span style=color:#000>BOOL</span> <span style=color:#000>showCues</span>;
</span></span><span style=display:flex><span><span style=color:#000>BOOL</span> <span style=color:#000>keepOnClose</span>;
</span></span><span style=display:flex><span>} <span style=color:#000>MSNStuff</span>;
</span></span><span style=display:flex><span><span style=color:#a90d91>static</span> <span style=color:#000>MSNStuff</span> <span style=color:#000>msnConf</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>void</span> <span style=color:#000>setNowPlaying</span>( <span style=color:#a90d91>char</span> <span style=color:#000>*</span><span style=color:#000>title</span>)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a90d91>wchar_t</span> <span style=color:#000>*</span><span style=color:#000>lpMsn</span>;
</span></span><span style=display:flex><span>    <span style=color:#a90d91>int</span> <span style=color:#000>strLen</span> <span style=color:#000>=</span> <span style=color:#1c01ce>20</span>;
</span></span><span style=display:flex><span>    <span style=color:#000>HWND</span> <span style=color:#000>xmpwin</span>;
</span></span><span style=display:flex><span>    <span style=color:#000>HWND</span> <span style=color:#000>msnui</span><span style=color:#000>=</span><span style=color:#1c01ce>0</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000>lpMsn</span> <span style=color:#000>=</span> (<span style=color:#a90d91>wchar_t</span><span style=color:#000>*</span>)<span style=color:#000>calloc</span>(<span style=color:#1c01ce>1024</span>,<span style=color:#1c01ce>1024</span>);
</span></span><span style=display:flex><span>    <span style=color:#177500>// stuff for MSN before...
</span></span></span><span style=display:flex><span><span style=color:#177500></span>    <span style=color:#000>memcpy</span>(<span style=color:#000>lpMsn</span>, <span style=color:#000>L</span><span style=color:#000>&amp;</span><span style=color:#000>quot</span>;<span style=color:#000>\</span><span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>92</span>;<span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>48</span>;<span style=color:#000>Music</span><span style=color:#000>\</span><span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>92</span>;<span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>48</span>;<span style=color:#1c01ce>1</span><span style=color:#000>\</span><span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>92</span>;<span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>48</span>;{<span style=color:#1c01ce>0</span>}<span style=color:#000>\</span><span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>92</span>;<span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>48</span>;<span style=color:#000>&amp;</span><span style=color:#000>quot</span>;, <span style=color:#1c01ce>17</span><span style=color:#000>*</span><span style=color:#1c01ce>2</span>);
</span></span><span style=display:flex><span>    <span style=color:#177500>// actual title...
</span></span></span><span style=display:flex><span><span style=color:#177500></span>    <span style=color:#000>strLen</span><span style=color:#000>=</span><span style=color:#000>MultiByteToWideChar</span>(<span style=color:#a90d91>false</span><span style=color:#000>?</span><span style=color:#000>CP_UTF8</span>:<span style=color:#000>CP_ACP</span>,<span style=color:#1c01ce>0</span>,<span style=color:#000>title</span>,<span style=color:#000>-</span><span style=color:#1c01ce>1</span>,<span style=color:#000>lpMsn</span><span style=color:#000>+</span><span style=color:#1c01ce>17</span>,<span style=color:#1c01ce>492</span>)<span style=color:#000>-</span><span style=color:#1c01ce>1</span>;<span style=color:#000>Â</span>  <span style=color:#177500>/* 1024/2 - 20 */</span>
</span></span><span style=display:flex><span>    <span style=color:#177500>// stuff for MSN after...
</span></span></span><span style=display:flex><span><span style=color:#177500></span>    <span style=color:#000>memcpy</span>(<span style=color:#000>lpMsn</span> <span style=color:#000>+</span> <span style=color:#1c01ce>17</span> <span style=color:#000>+</span> <span style=color:#000>strLen</span>, <span style=color:#000>L</span><span style=color:#000>&amp;</span><span style=color:#000>quot</span>;<span style=color:#000>\</span><span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>92</span>;<span style=color:#000>&amp;</span><span style=color:#000>#</span><span style=color:#1c01ce>48</span>;<span style=color:#000>&amp;</span><span style=color:#000>quot</span>;, <span style=color:#1c01ce>3</span><span style=color:#000>*</span><span style=color:#1c01ce>2</span>);
</span></span><span style=display:flex><span>    <span style=color:#000>strLen</span> <span style=color:#000>+=</span> <span style=color:#1c01ce>20</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000>COPYDATASTRUCT</span> <span style=color:#000>msndata</span>;
</span></span><span style=display:flex><span>    <span style=color:#000>msndata</span>.<span style=color:#000>dwData</span> <span style=color:#000>=</span> <span style=color:#1c01ce>0x547</span>;
</span></span><span style=display:flex><span>    <span style=color:#000>msndata</span>.<span style=color:#000>lpData</span> <span style=color:#000>=</span> (<span style=color:#a90d91>void</span><span style=color:#000>*</span>)<span style=color:#000>lpMsn</span>;
</span></span><span style=display:flex><span>    <span style=color:#000>msndata</span>.<span style=color:#000>cbData</span> <span style=color:#000>=</span> <span style=color:#000>strLen</span> <span style=color:#000>*</span> <span style=color:#1c01ce>2</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a90d91>while</span> ( <span style=color:#000>msnui</span> <span style=color:#000>=</span> <span style=color:#000>FindWindowEx</span>(<span style=color:#a90d91>NULL</span>, <span style=color:#000>msnui</span>, <span style=color:#000>&amp;</span><span style=color:#000>quot</span>;<span style=color:#000>MsnMsgrUIManager</span><span style=color:#000>&amp;</span><span style=color:#000>quot</span>;, <span style=color:#a90d91>NULL</span>) )
</span></span><span style=display:flex><span>        <span style=color:#000>SendMessage</span>(<span style=color:#000>msnui</span>, <span style=color:#000>WM_COPYDATA</span>, (<span style=color:#000>WPARAM</span>)<span style=color:#000>xmpwin</span>, (<span style=color:#000>LPARAM</span>)<span style=color:#000>&amp;</span><span style=color:#000>amp</span>;<span style=color:#000>msndata</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a90d91>int</span> <span style=color:#000>main</span>(<span style=color:#a90d91>int</span> <span style=color:#000>argc</span>, <span style=color:#a90d91>char</span> <span style=color:#000>*</span><span style=color:#000>argv</span>[])
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#a90d91>char</span> <span style=color:#000>*</span><span style=color:#000>title</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a90d91>if</span> ( <span style=color:#000>argc</span> <span style=color:#000>==</span> <span style=color:#1c01ce>1</span> )
</span></span><span style=display:flex><span>        <span style=color:#000>title</span> <span style=color:#000>=</span> <span style=color:#000>&amp;</span><span style=color:#000>quot</span>;<span style=color:#000>&amp;</span><span style=color:#000>quot</span>;;
</span></span><span style=display:flex><span>    <span style=color:#a90d91>else</span>
</span></span><span style=display:flex><span>        <span style=color:#000>title</span> <span style=color:#000>=</span> <span style=color:#000>argv</span>[<span style=color:#1c01ce>1</span>];
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#000>setNowPlaying</span> ( <span style=color:#000>title</span> );
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a90d91>return</span> <span style=color:#000>EXIT_SUCCESS</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Categories:
<a href=/categories/blog.html>Blog</a></p><p>Tags:
<a href=/tags/c++.html>C++</a></p><aside class=links><a class=previous href=https://kinoshita.eti.br/2009/03/06/displaying-japanese-characters-in-java-swing.html>&#171; Previous</a><a class=next href=https://kinoshita.eti.br/2010/04/07/ccm-hudson-plugin.html>Next &#187;</a></aside></article></main><footer role=contentinfo><ul id=social-media-icons><li><a href=https://www.instagram.com/brunokinoshita/><img src=/assets/icons/instagram.png alt="Instagram link"></a></li><li><a href=https://bsky.app/profile/kinow.bsky.social><img src=/assets/icons/bluesky.png alt="BlueSky link"></a></li><li><a href=https://twitter.com/kinow/><img src=/assets/icons/twitter.png alt="Twitter link"></a></li><li><a href=https://github.com/kinow/><img src=/assets/icons/github.png alt="GitHub link"></a></li><li><a href=/feed.xml><img src=/assets/icons/news.png alt="RSS feed link"></a></li></ul></footer></body></html>