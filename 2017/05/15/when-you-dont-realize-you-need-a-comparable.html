<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>When you don’t realize you need a Comparable | kinow</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="When you don’t realize you need a Comparable" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In 2012, I wrote about how you always learn something new by following the Apache dev mailing lists. After about five years, I am still learning, and still getting impressed by the knowledge of other developers. Days ago I was massaging some code in a pull request and a developer suggested me to simplify my code." />
<meta property="og:description" content="In 2012, I wrote about how you always learn something new by following the Apache dev mailing lists. After about five years, I am still learning, and still getting impressed by the knowledge of other developers. Days ago I was massaging some code in a pull request and a developer suggested me to simplify my code." />
<link rel="canonical" href="https://kinoshita.eti.br/2017/05/15/when-you-dont-realize-you-need-a-comparable.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2017/05/15/when-you-dont-realize-you-need-a-comparable.html" />
<meta property="og:site_name" content="kinow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-05-15T00:00:00+12:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="When you don’t realize you need a Comparable" />
<script type="application/ld+json">
{"description":"In 2012, I wrote about how you always learn something new by following the Apache dev mailing lists. After about five years, I am still learning, and still getting impressed by the knowledge of other developers. Days ago I was massaging some code in a pull request and a developer suggested me to simplify my code.","@type":"BlogPosting","url":"https://kinoshita.eti.br/2017/05/15/when-you-dont-realize-you-need-a-comparable.html","headline":"When you don’t realize you need a Comparable","datePublished":"2017-05-15T00:00:00+12:00","dateModified":"2017-05-15T00:00:00+12:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2017/05/15/when-you-dont-realize-you-need-a-comparable.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css" /><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="kinow" /><link href="https://unpkg.com/pattern.css" rel="stylesheet" />

</head>
<body>
<div id="mobile-menu"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image"  alt="Instagram link" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" alt="Twitter link" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" alt="GitHub link" />
      </a>
    </li>
  </ul>
</div>
</div>
<div id="wrapper">
  <div id="sidebar"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image"  alt="Instagram link" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" alt="Twitter link" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" alt="GitHub link" />
      </a>
    </li>
  </ul>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">When you don&#39;t realize you need a Comparable</h1>
    <span class="post-meta">
      <time class="dt-published" datetime="2017-05-15T00:00:00+12:00" itemprop="datePublished">May 15, 2017
      </time>
      <span>&mdash; star date: -305547.95.</span>
      <span>
        Number of words: 388.
      </span></span>
  </header>

  


  <div class="post-content e-content" itemprop="articleBody">
    <p><a href="/2012/10/20/replacing-a-hashset-with-a-bitset.html">In 2012, I wrote</a> about how you always learn something
new by following the <a href="http://www.apache.org/foundation/mailinglists.html">Apache dev mailing lists</a>.</p>

<p>After about five years, I am still learning, and still getting impressed by the knowledge of other
developers. Days ago I was massaging some code in <a href="https://github.com/apache/jena/pull/237">a pull request</a>
and a developer suggested me to simplify my code.</p>

<!--more-->

<p>The suggestion was to make a class a <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Comparable.html">Comparable type</a>
to both simplify the code, and also have a better design. I immediately agreed, and looking back in hindsight,
it was the most logical choice. Yet, I simply did not think about that.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// What the code was</span>
<span class="k">case</span> <span class="no">VSPACE_SORTKEY</span> <span class="o">:</span>
    <span class="kt">int</span> <span class="n">cmp</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">nv1</span><span class="o">.</span><span class="na">getCollation</span><span class="o">();</span>
    <span class="nc">String</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">nv2</span><span class="o">.</span><span class="na">getCollation</span><span class="o">();</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">c1</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">c2</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">c1</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">c2</span><span class="o">))</span> <span class="o">{</span>
        <span class="c1">// locales are parsed. Here we could think about caching if necessary</span>
        <span class="nc">Locale</span> <span class="n">desiredLocale</span> <span class="o">=</span> <span class="nc">Locale</span><span class="o">.</span><span class="na">forLanguageTag</span><span class="o">(</span><span class="n">c1</span><span class="o">);</span>
        <span class="nc">Collator</span> <span class="n">collator</span> <span class="o">=</span> <span class="nc">Collator</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="n">desiredLocale</span><span class="o">);</span>
        <span class="n">cmp</span> <span class="o">=</span> <span class="n">collator</span><span class="o">.</span><span class="na">compare</span><span class="o">(</span><span class="n">nv1</span><span class="o">.</span><span class="na">getString</span><span class="o">(),</span> <span class="n">nv2</span><span class="o">.</span><span class="na">getString</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="n">cmp</span> <span class="o">=</span> <span class="nc">XSDFuncOp</span><span class="o">.</span><span class="na">compareString</span><span class="o">(</span><span class="n">nv1</span><span class="o">,</span> <span class="n">nv2</span><span class="o">)</span> <span class="o">;</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">cmp</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// What the code is now</span>
<span class="k">case</span> <span class="no">VSPACE_SORTKEY</span> <span class="o">:</span>
    <span class="k">return</span> <span class="o">((</span><span class="nc">NodeValueSortKey</span><span class="o">)</span> <span class="n">nv1</span><span class="o">).</span><span class="na">compareTo</span><span class="o">((</span><span class="nc">NodeValueSortKey</span><span class="o">)</span> <span class="n">nv2</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div></div>

<p>This moved the logic to a method in the <code class="language-plaintext highlighter-rouge">NodeValueSortKey</code> class. This reduced the complexity
of the class with the <code class="language-plaintext highlighter-rouge">switch</code> statement. And it also made it easier to write unit tests.</p>

<p>If you are not involved in Open Source projects yet, I keep my suggestion from five years ago.
Find a project related to something you like, and start reading the code, lurk in the
mailing list or watch GitHub repositories.</p>

<p>You can always learn more!</p>

<p>♥ Open Source</p>

  </div>

  <div class="tags"><p>Tags:&nbsp;<a class="label" href="/tag/apache software foundation">apache software foundation</a>,&nbsp;<a class="label" href="/tag/java">java</a>,&nbsp;<a class="label" href="/tag/opensource">opensource</a>,&nbsp;<a class="label" href="/tag/programming">programming</a>.<br/></p></div>

  <a class="u-url" href="/2017/05/15/when-you-dont-realize-you-need-a-comparable.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
