<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Exif Odd Offsets | kinow</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Exif Odd Offsets" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A file format like JPEG may contain metadata in JFIF, Exif, or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format. Within an Exif metadata block, you should see directories, with several entries. The entries have fields like description, value, and also an offset. The offset indicates the offset to the next entry. The Exif specification defines that implementers must make sure to keep the offset an even number, within 4 bytes. I recently worked on IMAGING-205, a ticket about odd offsets in files with Exif metadata. This issue was exactly to address that when files were rewritten with Apache Commons Imaging, even though the image initially had no odd offsets, after the entries were rearranged, we could have odd offsets. The fix was simply checking for odd offsets, adding +1, and later it would be put within the 4 bytes limit. Locating the bug One interesting point, however, is that this is in the standard, but not all software that read and write Exif follow the specification. So it is quite common to find images with odd offsets. Which means you could take a picture with your phone, that contains some Exif metadata, and be surprised to analyze it with exiftool and get warnings about odd offsets. Most viewers handle odd and even offsets, so it should work for most cases, unless you have a strict reader/viewer. Happy hacking! &amp;heart; Open Source" />
<meta property="og:description" content="A file format like JPEG may contain metadata in JFIF, Exif, or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format. Within an Exif metadata block, you should see directories, with several entries. The entries have fields like description, value, and also an offset. The offset indicates the offset to the next entry. The Exif specification defines that implementers must make sure to keep the offset an even number, within 4 bytes. I recently worked on IMAGING-205, a ticket about odd offsets in files with Exif metadata. This issue was exactly to address that when files were rewritten with Apache Commons Imaging, even though the image initially had no odd offsets, after the entries were rearranged, we could have odd offsets. The fix was simply checking for odd offsets, adding +1, and later it would be put within the 4 bytes limit. Locating the bug One interesting point, however, is that this is in the standard, but not all software that read and write Exif follow the specification. So it is quite common to find images with odd offsets. Which means you could take a picture with your phone, that contains some Exif metadata, and be surprised to analyze it with exiftool and get warnings about odd offsets. Most viewers handle odd and even offsets, so it should work for most cases, unless you have a strict reader/viewer. Happy hacking! &amp;heart; Open Source" />
<link rel="canonical" href="https://kinoshita.eti.br/2017/12/25/exif-odd-offsets.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2017/12/25/exif-odd-offsets.html" />
<meta property="og:site_name" content="kinow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-12-25T00:00:00+13:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Exif Odd Offsets" />
<script type="application/ld+json">
{"description":"A file format like JPEG may contain metadata in JFIF, Exif, or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format. Within an Exif metadata block, you should see directories, with several entries. The entries have fields like description, value, and also an offset. The offset indicates the offset to the next entry. The Exif specification defines that implementers must make sure to keep the offset an even number, within 4 bytes. I recently worked on IMAGING-205, a ticket about odd offsets in files with Exif metadata. This issue was exactly to address that when files were rewritten with Apache Commons Imaging, even though the image initially had no odd offsets, after the entries were rearranged, we could have odd offsets. The fix was simply checking for odd offsets, adding +1, and later it would be put within the 4 bytes limit. Locating the bug One interesting point, however, is that this is in the standard, but not all software that read and write Exif follow the specification. So it is quite common to find images with odd offsets. Which means you could take a picture with your phone, that contains some Exif metadata, and be surprised to analyze it with exiftool and get warnings about odd offsets. Most viewers handle odd and even offsets, so it should work for most cases, unless you have a strict reader/viewer. Happy hacking! &amp;heart; Open Source","@type":"BlogPosting","url":"https://kinoshita.eti.br/2017/12/25/exif-odd-offsets.html","headline":"Exif Odd Offsets","datePublished":"2017-12-25T00:00:00+13:00","dateModified":"2017-12-25T00:00:00+13:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2017/12/25/exif-odd-offsets.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css" /><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="kinow" /><link href="https://unpkg.com/pattern.css" rel="stylesheet" />

</head>
<body>
<div id="mobile-menu"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image"  alt="Instagram link" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" alt="Twitter link" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" alt="GitHub link" />
      </a>
    </li>
  </ul>
</div>
</div>
<div id="wrapper">
  <div id="sidebar"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image"  alt="Instagram link" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" alt="Twitter link" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" alt="GitHub link" />
      </a>
    </li>
  </ul>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Exif Odd Offsets</h1>
    <span class="post-meta">
      <time class="dt-published" datetime="2017-12-25T00:00:00+13:00" itemprop="datePublished">Dec 25, 2017
      </time>
      <span>&mdash; star date: -305934.25.</span>
      <span>
        Number of words: 271.
      </span></span>
  </header>

  


  <div class="post-content e-content" itemprop="articleBody">
    <p>A file format like JPEG may contain metadata in JFIF, <a href="https://en.wikipedia.org/wiki/Exif">Exif</a>,
or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format.</p>

<p>Within an Exif metadata block, you should see directories, with several entries. The entries have fields
like description, value, and also an offset. The offset indicates the offset to the next entry.</p>

<p>The Exif specification defines that <strong>implementers must make sure to keep the offset an even number,
within 4 bytes</strong>.</p>

<p>I recently worked on <a href="https://issues.apache.org/jira/browse/IMAGING-205">IMAGING-205</a>, a ticket
about odd offsets in files with Exif metadata. This issue was exactly to address that when files
were rewritten with Apache Commons Imaging, even though the image initially had no odd offsets,
after the entries were rearranged, we could have odd offsets.</p>

<p>The fix was simply checking for odd offsets, adding +1, and later it would be put within the
4 bytes limit.</p>

<p style="text-align: center;">
<img style="display: inline" class="ui image" src="/assets/posts/2017-12-25-exif-odd-offsets/screenshot.png" alt="A screen shot of Eclipse with source code" title="Locating the bug" />
<br />
<small>Locating the bug</small>
</p>

<p>One interesting point, however, is that this is in the standard, but not all software that read
and write Exif follow the specification. So it is quite common to find images with odd offsets.</p>

<p>Which means you could take a picture with your phone, that contains some Exif metadata, and
be surprised to analyze it with <code class="language-plaintext highlighter-rouge">exiftool</code> and get warnings about odd offsets. Most viewers
handle odd and even offsets, so it should work for most cases, unless you have a strict reader/viewer.</p>

<p>Happy hacking!</p>

<p>&amp;heart; Open Source</p>

  </div>

  <div class="tags"><p>Tags:&nbsp;<a class="label" href="/tag/programming">programming</a>,&nbsp;<a class="label" href="/tag/java">java</a>,&nbsp;<a class="label" href="/tag/apache software foundation">apache software foundation</a>,&nbsp;<a class="label" href="/tag/opensource">opensource</a>.<br/></p></div>

  <a class="u-url" href="/2017/12/25/exif-odd-offsets.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
