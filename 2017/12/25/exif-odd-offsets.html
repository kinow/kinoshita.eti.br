<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://kinoshita.eti.br/2017/12/25/exif-odd-offsets.html"><meta property="og:site_name" content="kinow"><meta property="og:title" content="Exif Odd Offsets"><meta property="og:description" content="A file format like JPEG may contain metadata in JFIF, Exif, or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format.
Within an Exif metadata block, you should see directories, with several entries. The entries have fields like description, value, and also an offset. The offset indicates the offset to the next entry.
The Exif specification defines that implementers must make sure to keep the offset an even number, within 4 bytes."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-12-25T00:00:00+00:00"><meta property="article:modified_time" content="2024-06-23T17:26:18+02:00"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Java"><meta property="article:tag" content="Apache Software Foundation"><meta property="article:tag" content="Opensource"><meta property="og:image" content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta property="fb:admins" content="bruno.kinoshita"><meta name=twitter:title content="Exif Odd Offsets"><meta name=twitter:description content="A file format like JPEG may contain metadata in JFIF, Exif, or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format.
Within an Exif metadata block, you should see directories, with several entries. The entries have fields like description, value, and also an offset. The offset indicates the offset to the next entry.
The Exif specification defines that implementers must make sure to keep the offset an even number, within 4 bytes."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta name=twitter:site content="@kinow"><link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2017/12/25/exif-odd-offsets/feed.xml title=kinow><link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.c3626db3678f53e4a53e3e75c7b2fe34bb46566f00eb84692501404d0064c32a.css integrity="sha256-w2Jts2ePU+SlPj51x7L+NLtGVm8A64RpJQFATQBkwyo="><title>kinow | Exif Odd Offsets</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Exif Odd Offsets","headline":"Exif Odd Offsets","alternativeHeadline":"","description":"A file format like JPEG may contain metadata in JFIF, Exif, or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format.\nWithin an Exif metadata block, you should see directories, with several entries. The entries have fields like description, value, and also an offset. The offset indicates the offset to the next entry.\nThe Exif specification defines that implementers must make sure to keep the offset an even number, within 4 bytes.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kinoshita.eti.br\/2017\/12\/25\/exif-odd-offsets.html"},"author":{"@type":"Person","name":"Bruno P. Kinoshita"},"creator":{"@type":"Person","name":"Bruno P. Kinoshita"},"accountablePerson":{"@type":"Person","name":"Bruno P. Kinoshita"},"copyrightHolder":"kinow","copyrightYear":"2017","dateCreated":"2017-12-25T00:00:00.00Z","datePublished":"2017-12-25T00:00:00.00Z","dateModified":"2024-06-23T17:26:18.00Z","publisher":{"@type":"Organization","name":"kinow","url":"https://kinoshita.eti.br/","logo":{"@type":"ImageObject","url":"https:\/\/kinoshita.eti.br\/","width":"32","height":"32"}},"image":"https://kinoshita.eti.br/","url":"https:\/\/kinoshita.eti.br\/2017\/12\/25\/exif-odd-offsets.html","wordCount":"251","genre":["programming","java","apache software foundation","opensource"],"keywords":[]}</script></head><body><header role=banner class=content><nav id=nav aria-label=Main role=navigation class=content><ul><li><a href=/><i data-feather=about></i> About</a></li><li><a href=/blog/><i data-feather=blog></i> Blog</a></li><li><a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a></li></ul></nav></header><main><article class=content><h1>Exif Odd Offsets</h1><div class=metadata><i data-feather=calendar></i>
<time datetime=2017-12-25>Dec 25, 2017</time></div><aside><nav id=TableOfContents></nav></aside><p>A file format like JPEG may contain metadata in JFIF, <a href=https://en.wikipedia.org/wiki/Exif>Exif</a>,
or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format.</p><p>Within an Exif metadata block, you should see directories, with several entries. The entries have fields
like description, value, and also an offset. The offset indicates the offset to the next entry.</p><p>The Exif specification defines that <strong>implementers must make sure to keep the offset an even number,
within 4 bytes</strong>.</p><p>I recently worked on <a href=https://issues.apache.org/jira/browse/IMAGING-205>IMAGING-205</a>, a ticket
about odd offsets in files with Exif metadata. This issue was exactly to address that when files
were rewritten with Apache Commons Imaging, even though the image initially had no odd offsets,
after the entries were rearranged, we could have odd offsets.</p><p>The fix was simply checking for odd offsets, adding +1, and later it would be put within the
4 bytes limit.</p><p style=text-align:center><figure class=feature><img src=/assets/posts/2017-12-25-exif-odd-offsets/screenshot.png alt='A screen shot of Eclipse with source code' title='A screen shot of Eclipse with source code' style=display:inline width height><figcaption>A screen shot of Eclipse with source code</figcaption></figure><br><small>Locating the bug</small></p><p>One interesting point, however, is that this is in the standard, but not all software that read
and write Exif follow the specification. So it is quite common to find images with odd offsets.</p><p>Which means you could take a picture with your phone, that contains some Exif metadata, and
be surprised to analyze it with <code>exiftool</code> and get warnings about odd offsets. Most viewers
handle odd and even offsets, so it should work for most cases, unless you have a strict reader/viewer.</p><p>Happy hacking!</p><p>&amp;heart; Open Source</p><p>Categories:
<a href=/categories/blog.html>Blog</a></p><p>Tags:
<a href=/tags/programming.html>Programming</a>,
<a href=/tags/java.html>Java</a>,
<a href=/tags/apache-software-foundation.html>Apache Software Foundation</a>,
<a href=/tags/opensource.html>Opensource</a></p><aside class=links><a class=previous href=https://kinoshita.eti.br/2017/12/03/remember-to-synchronize-when-iterating-streams-from-a-synchronized-collection.html>&#171; Previous</a><a class=next href=https://kinoshita.eti.br/2018/02/03/r-shiny--ansible-shiny.nzoss.org.nz.html>Next &#187;</a></aside></article></main><footer role=contentinfo><ul id=social-media-icons><li><a href=https://www.instagram.com/brunokinoshita/><img src=/assets/icons/instagram.png alt="Instagram link"></a></li><li><a href=https://twitter.com/kinow/><img src=/assets/icons/twitter.png alt="Twitter link"></a></li><li><a href=https://github.com/kinow/><img src=/assets/icons/github.png alt="GitHub link"></a></li><li><a href=/feed.xml><img src=/assets/icons/news.png alt="RSS feed link"></a></li></ul></footer></body></html>