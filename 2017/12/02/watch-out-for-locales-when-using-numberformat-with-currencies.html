<!doctype html><html lang=en><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.bb12278f082614f093646fd8c21cd5db009382bf5777a5ca1b84c705f7ff5e2d.css integrity="sha256-uxInjwgmFPCTZG/YwhzV2wCTgr9Xd6XKG4THBff/Xi0=">
<title>kinow | Watch out for Locales when using NumberFormat with currencies</title>
</head>
<body><header role=banner class=content>
<nav id=nav aria-label=Main role=navigation class=content>
<ul><li>
<a href=/>
<i data-feather=about></i> About</a>
</li><li>
<a href=/blog/>
<i data-feather=blog></i> Blog</a>
</li><li>
<a href=/portfolio/>
<i data-feather=portfolio></i> Portfolio</a>
</li><li></li>
</ul>
</nav>
</header>
<main>
<article class=content>
<h2>Watch out for Locales when using NumberFormat with currencies</h2><div class=metadata>
<i data-feather=calendar></i>
<time datetime=2017-12-02>Dec 2, 2017</time>
</div>
<p>In Java you have the <a href=https://docs.oracle.com/javase/9/docs/api/java/text/NumberFormat.html>NumberFormatException</a>
to help you formatting and parsing numbers for any locale. Said that, here&rsquo;s some code.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>BigDecimal negative = new BigDecimal(<span style=color:#00f>&#34;-1234.56&#34;</span>);

DecimalFormat nf = (DecimalFormat) NumberFormat.getCurrencyInstance(Locale.UK);
String formattedNegative = nf.format(negative);

System.out.println(formattedNegative);
</code></pre></div><p>The output for this code is <strong>-£1,234.56</strong>. That&rsquo;s expected, as the locale is set to
UK, so the currency symbol used is for British Pounds. And as the number is negative, you
get that minus sign as a prefix. For Japanese locale you&rsquo;d get <strong>-￥1,235</strong>, and for Brazilian
locale you&rsquo;d get <strong>-R$ 1.234,56</strong>.</p>
<p>So far so good.</p>
<p>What about the following code, with nothing different except for the locale set to <strong>US</strong>.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>BigDecimal negative = new BigDecimal(<span style=color:#00f>&#34;-1234.56&#34;</span>);

DecimalFormat nf = (DecimalFormat) NumberFormat.getCurrencyInstance(Locale.US); // &lt;--- US now
String formattedNegative = nf.format(negative);

System.out.println(formattedNegative);
</code></pre></div><p>Some could intuitively expect <strong>-$1,234.56</strong>. However, <strong>the output is actually ($1,234.56)</strong>.</p>
<p>There are different prefixes and suffixes. But in some locales the prefix can be empty, or, as
in the case of the US locale, it can be quite different than what you could expect.</p>
<p>Learned about this peculiarity from NumberFormat while working on <a href=https://issues.apache.org/jira/browse/VALIDATOR-433>VALIDATOR-433</a> for Apache Commons Validator.</p>
<p>Happy hacking!</p>
<aside class=links>
<a class=previous href=https://kinoshita.eti.br/2017/12/01/what-are-identification-keys.html>&#171; Previous</a>
<a class=next href=https://kinoshita.eti.br/2017/12/03/remember-to-synchronize-when-iterating-streams-from-a-synchronized-collection.html>Next &#187;</a>
</aside>
</article>
</main>
<footer role=contentinfo>
<ul id=social-media-icons>
<li>
<a href=https://www.instagram.com/brunokinoshita/>
<img src=/assets/icons/instagram.png alt="Instagram link">
</a>
</li>
<li>
<a href=https://twitter.com/kinow/>
<img src=/assets/icons/twitter.png alt="Twitter link">
</a>
</li>
<li>
<a href=https://github.com/kinow/>
<img src=/assets/icons/github.png alt="GitHub link">
</a>
</li>
</ul>
</footer>
</body>
</html>