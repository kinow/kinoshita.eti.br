<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://kinoshita.eti.br/2017/01/02/debugging-an-application-that-freezes-the-x-server.html"><meta property="og:site_name" content="kinow"><meta property="og:title" content="Debugging an application that freezes the X server"><meta property="og:description" content="Some time ago, I decided to start writing C++ again, and picked Krita for that. Krita is written in C++ and Qt. The bug I was working on involved a memory issue when changing the UI.
The problem was that this UI change would result in, not only Krita, but the whole X server freezing. My set up was basically Ubuntu 16.04.1 LTS, with Eclipse, Qt5, and the latest version of Krita checked out via git."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-01-02T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-27T17:29:58+02:00"><meta property="article:tag" content="C++"><meta property="article:tag" content="Krita"><meta property="article:tag" content="Opensource"><meta property="article:tag" content="Programming"><meta property="og:image" content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta property="fb:admins" content="bruno.kinoshita"><meta name=twitter:title content="Debugging an application that freezes the X server"><meta name=twitter:description content="Some time ago, I decided to start writing C++ again, and picked Krita for that. Krita is written in C++ and Qt. The bug I was working on involved a memory issue when changing the UI.
The problem was that this UI change would result in, not only Krita, but the whole X server freezing. My set up was basically Ubuntu 16.04.1 LTS, with Eclipse, Qt5, and the latest version of Krita checked out via git."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta name=twitter:site content="@kinow"><link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2017/01/02/debugging-an-application-that-freezes-the-x-server/feed.xml title=kinow><link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.c3626db3678f53e4a53e3e75c7b2fe34bb46566f00eb84692501404d0064c32a.css integrity="sha256-w2Jts2ePU+SlPj51x7L+NLtGVm8A64RpJQFATQBkwyo="><title>kinow | Debugging an application that freezes the X server</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Debugging an application that freezes the X server","headline":"Debugging an application that freezes the X server","alternativeHeadline":"","description":"Some time ago, I decided to start writing C\u002b\u002b again, and picked Krita for that. Krita is written in C\u002b\u002b and Qt. The bug I was working on involved a memory issue when changing the UI.\nThe problem was that this UI change would result in, not only Krita, but the whole X server freezing. My set up was basically Ubuntu 16.04.1 LTS, with Eclipse, Qt5, and the latest version of Krita checked out via git.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kinoshita.eti.br\/2017\/01\/02\/debugging-an-application-that-freezes-the-x-server.html"},"author":{"@type":"Person","name":"Bruno P. Kinoshita"},"creator":{"@type":"Person","name":"Bruno P. Kinoshita"},"accountablePerson":{"@type":"Person","name":"Bruno P. Kinoshita"},"copyrightHolder":"kinow","copyrightYear":"2017","dateCreated":"2017-01-02T00:00:00.00Z","datePublished":"2017-01-02T00:00:00.00Z","dateModified":"2024-05-27T17:29:58.00Z","publisher":{"@type":"Organization","name":"kinow","url":"https://kinoshita.eti.br/","logo":{"@type":"ImageObject","url":"https:\/\/kinoshita.eti.br\/","width":"32","height":"32"}},"image":"https://kinoshita.eti.br/","url":"https:\/\/kinoshita.eti.br\/2017\/01\/02\/debugging-an-application-that-freezes-the-x-server.html","wordCount":"231","genre":["c\u002b\u002b","krita","opensource","programming"],"keywords":[]}</script></head><body><header role=banner class=content><nav id=nav aria-label=Main role=navigation class=content><ul><li><a href=/><i data-feather=about></i> About</a></li><li><a href=/blog/><i data-feather=blog></i> Blog</a></li><li><a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a></li></ul></nav></header><main><article class=content><h1>Debugging an application that freezes the X server</h1><div class=metadata><i data-feather=calendar></i>
<time datetime=2017-01-02>Jan 2, 2017</time></div><aside><nav id=TableOfContents></nav></aside><p>Some time ago, I decided to start writing C++ again, and picked Krita for that.
Krita is written in C++ and Qt. The <a href="https://bugs.kde.org/show_bug.cgi?id=366741">bug I was working on</a>
involved a memory issue when changing the UI.</p><p>The problem was that this UI change would result in, not only Krita, but the whole
X server freezing. My set up was basically Ubuntu 16.04.1 LTS, with Eclipse, Qt5,
and the latest version of Krita checked out via git.</p><p>Initially I spent some time looking at the logs, tracing the binary, even downloaded
some Qt utility tools to look at the events and what was happening with the application
when it froze.</p><p>However, eventually I realized I was going to spend more time on this part of the
issue, rather than on the memory bug. So decided to look for a work-around.</p><p>Thankfully someone else blogged about a similar issue and saved me a lot of time :-)
Here&rsquo;s how I did it, following the instructions in
<a href=http://www.geany.org/manual/gtk/gtk-faq/x462.html>this blog post</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ sudo apt-get install xnest -y
</span></span><span style=display:flex><span>$ <span style=color:#a90d91>cd</span> krita_install/
</span></span><span style=display:flex><span>$ Xnest :10
</span></span><span style=display:flex><span>$ twm -display :10
</span></span><span style=display:flex><span>$ <span style=color:#a90d91>export</span> <span style=color:#000>DISPLAY</span><span style=color:#000>=</span>:10
</span></span><span style=display:flex><span>$ ./krita
</span></span></code></pre></div><p>That&rsquo;s it. You should have Krita running in a separate window, with Xnest, and within
this window the twm window manager running. So when it freezes, at least you can still
debug your application in Eclipse or whatever IDE you prefer.</p><p>Happy hacking!</p><p>Categories:
<a href=/categories/blog.html>Blog</a></p><p>Tags:
<a href=/tags/c++.html>C++</a>,
<a href=/tags/krita.html>Krita</a>,
<a href=/tags/opensource.html>Opensource</a>,
<a href=/tags/programming.html>Programming</a></p><aside class=links><a class=previous href=https://kinoshita.eti.br/2016/12/19/drawing-sketch-uh.html>&#171; Previous</a><a class=next href=https://kinoshita.eti.br/2017/01/03/contributing-to-krita.html>Next &#187;</a></aside></article></main><footer role=contentinfo><ul id=social-media-icons><li><a href=https://www.instagram.com/brunokinoshita/><img src=/assets/icons/instagram.png alt="Instagram link"></a></li><li><a href=https://twitter.com/kinow/><img src=/assets/icons/twitter.png alt="Twitter link"></a></li><li><a href=https://github.com/kinow/><img src=/assets/icons/github.png alt="GitHub link"></a></li><li><a href=/feed.xml><img src=/assets/icons/news.png alt="RSS feed link"></a></li></ul></footer></body></html>