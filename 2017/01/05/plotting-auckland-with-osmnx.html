<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta property="og:title" content="Plotting Auckland with OSMnx">
<meta property="og:description" content="

  
  Auckland




A couple of days ago I saw a thread in reddit
about OSMnx. It is a utilty for interacting with the OpenStreeMap (OSM)
API, manipulate it in pure Python and using libraries like NetworkX (a Python graph package).
With it you can do things like visualize cul-de-sacs or one-way streets, plot shortest-path routes, or calculate stats like intersection density, average node connectivity, or betweenness centrality. Or simply
plot the OSM data as in the graph above.
The source code is hosted at GitHub: https://github.com/gboeing/osmnx.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://kinoshita.eti.br/2017/01/05/plotting-auckland-with-osmnx.html"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2017-01-05T00:00:00+00:00">
<meta property="article:modified_time" content="2017-01-05T00:00:00+00:00">
<link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.bb12278f082614f093646fd8c21cd5db009382bf5777a5ca1b84c705f7ff5e2d.css integrity="sha256-uxInjwgmFPCTZG/YwhzV2wCTgr9Xd6XKG4THBff/Xi0=">
<title>kinow | Plotting Auckland with OSMnx</title>
</head>
<body>
<header role=banner class=content>
<nav id=nav aria-label=Main role=navigation class=content>
<ul><li>
<a href=/><i data-feather=about></i> About</a>
</li><li>
<a href=/blog/><i data-feather=blog></i> Blog</a>
</li><li>
<a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a>
</li>
</ul>
</nav>
</header>
<main>
<article class=content>
<h2>Plotting Auckland with OSMnx</h2><div class=metadata>
<i data-feather=calendar></i>
<time datetime=2017-01-05>Jan 5, 2017</time>
</div>
<figure class=feature>
<img src=/assets/posts/2017-01-05-plotting-auckland-with-osmnx/figure_1.png alt=Auckland title=Auckland style=height:400px width height>
<figcaption>Auckland</figcaption>
</figure>
<p>A couple of days ago I saw <a href=https://www.reddit.com/r/gis/comments/5lnjxs/creating_squaremile_figureground_diagrams_of/>a thread in reddit</a>
about OSMnx. It is a utilty for interacting with the OpenStreeMap (OSM)
API, manipulate it in pure Python and using libraries like NetworkX (a Python graph package).</p>
<p>With it you can do things like <q>visualize cul-de-sacs or one-way streets, plot shortest-path routes, or calculate stats like intersection density, average node connectivity, or betweenness centrality</q>. Or simply
plot the OSM data as in the graph above.</p>
<p>The source code is hosted at GitHub: <a href=https://github.com/gboeing/osmnx>https://github.com/gboeing/osmnx</a>.</p>
<blockquote cite=https://github.com/gboeing/osmnx>OSMnx is a Python 2+3 package that lets you download spatial geometries and construct, project, visualize, and analyze street networks from OpenStreetMap's APIs. Users can download and construct walkable, drivable, or bikable urban networks with a single line of Python code, and then easily analyze and visualize them.</blockquote>
<p>The only issue I found while creating the map for Auckland using the example from the project
README, was that the script would exit with the following error: <strong>&ldquo;ValueError: Geometry must be a shapely Polygon or MultiPolygon&rdquo;</strong>.</p>
<p>After looking at the list of dependencies and finding that everything seemed to be OK,
I started looking at the project issues. And thankfully someone else had found the
<a href=https://github.com/gboeing/osmnx/issues/16>same issue</a>
and the maintainer of the project answered how to fix it.</p>
<p>The issue was that the OSM API returns two <a href="https://nominatim.openstreetmap.org/search?format=json&limit=10&dedupe=0&polygon_geojson=1&q=Auckland,%20New%20Zealand">entries for Auckland</a>
, where the first one is a Point, and the
second is the one that we want (a Polygon). The application defaults to using the first element,
so in order to change it you have to give a <em>which_result</em> argument.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#080;font-style:italic>#!/usr/bin/env python3</span>

<span style=color:navy;font-weight:700>import</span> osmnx <span style=color:navy;font-weight:700>as</span> ox
G = ox.graph_from_place(<span style=color:#00f>&#39;Auckland, NZ&#39;</span>, network_type=<span style=color:#00f>&#39;drive&#39;</span>, which_result=<span style=color:#00f>2</span>)
ox.plot_graph(ox.project_graph(G))
</code></pre></div><p>And after that, and after waiting a few minutes, you should get your map :-)</p>
<p>Happy hacking!</p>
<aside class=links>
<a class=previous href=https://kinoshita.eti.br/2017/01/04/drawing-terra-celta-vocal-elcio.html>&#171; Previous</a>
<a class=next href=https://kinoshita.eti.br/2017/01/07/apache-commons-text.html>Next &#187;</a>
</aside>
</article>
</main>
<footer role=contentinfo>
<ul id=social-media-icons>
<li>
<a href=https://www.instagram.com/brunokinoshita/>
<img src=/assets/icons/instagram.png alt="Instagram link">
</a>
</li>
<li>
<a href=https://twitter.com/kinow/>
<img src=/assets/icons/twitter.png alt="Twitter link">
</a>
</li>
<li>
<a href=https://github.com/kinow/>
<img src=/assets/icons/github.png alt="GitHub link">
</a>
</li>
<li>
<a href=/feed.xml>
<img src=/assets/icons/news.png alt="RSS feed link">
</a>
</li>
</ul>
</footer>
</body>
</html>