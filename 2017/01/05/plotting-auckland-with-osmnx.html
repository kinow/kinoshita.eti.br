<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Plotting Auckland with OSMnx | kinow</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Plotting Auckland with OSMnx" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="A couple of days ago I saw a thread in reddit about OSMnx. It is a utilty for interacting with the OpenStreeMap (OSM) API, manipulate it in pure Python and using libraries like NetworkX (a Python graph package). With it you can do things like visualize cul-de-sacs or one-way streets, plot shortest-path routes, or calculate stats like intersection density, average node connectivity, or betweenness centrality. Or simply plot the OSM data as in the graph above. The source code is hosted at GitHub: https://github.com/gboeing/osmnx." />
<meta property="og:description" content="A couple of days ago I saw a thread in reddit about OSMnx. It is a utilty for interacting with the OpenStreeMap (OSM) API, manipulate it in pure Python and using libraries like NetworkX (a Python graph package). With it you can do things like visualize cul-de-sacs or one-way streets, plot shortest-path routes, or calculate stats like intersection density, average node connectivity, or betweenness centrality. Or simply plot the OSM data as in the graph above. The source code is hosted at GitHub: https://github.com/gboeing/osmnx." />
<link rel="canonical" href="https://kinoshita.eti.br/2017/01/05/plotting-auckland-with-osmnx.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2017/01/05/plotting-auckland-with-osmnx.html" />
<meta property="og:site_name" content="kinow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-01-05T00:00:00+13:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Plotting Auckland with OSMnx" />
<script type="application/ld+json">
{"description":"A couple of days ago I saw a thread in reddit about OSMnx. It is a utilty for interacting with the OpenStreeMap (OSM) API, manipulate it in pure Python and using libraries like NetworkX (a Python graph package). With it you can do things like visualize cul-de-sacs or one-way streets, plot shortest-path routes, or calculate stats like intersection density, average node connectivity, or betweenness centrality. Or simply plot the OSM data as in the graph above. The source code is hosted at GitHub: https://github.com/gboeing/osmnx.","headline":"Plotting Auckland with OSMnx","dateModified":"2017-01-05T00:00:00+13:00","datePublished":"2017-01-05T00:00:00+13:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2017/01/05/plotting-auckland-with-osmnx.html"},"url":"https://kinoshita.eti.br/2017/01/05/plotting-auckland-with-osmnx.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css" /><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="kinow" /><link href="https://unpkg.com/pattern.css" rel="stylesheet" />

</head>
<body>
<div id="mobile-menu"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" />
      </a>
    </li>
  </ul>
</div>
</div>
<div id="wrapper">
  <div id="sidebar"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" />
      </a>
    </li>
  </ul>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Plotting Auckland with OSMnx</h1>
    <span class="post-meta">
      <time class="dt-published" datetime="2017-01-05T00:00:00+13:00" itemprop="datePublished">Jan 5, 2017
      </time>
      <span>&mdash; star date: -305904.11.</span>
      <span>
        Number of words: 344.
      </span></span>
  </header>

  


  <div class="post-content e-content" itemprop="articleBody">
    <p><img style="height: 400px;" class="ui image" src="/assets/posts/2017-01-05-plotting-auckland-with-osmnx/figure_1.png" alt="Auckland" /></p>

<p>A couple of days ago I saw <a href="https://www.reddit.com/r/gis/comments/5lnjxs/creating_squaremile_figureground_diagrams_of/">a thread in reddit</a>
about OSMnx. It is a utilty for interacting with the OpenStreeMap (OSM)
API, manipulate it in pure Python and using libraries like NetworkX (a Python graph package).</p>

<p>With it you can do things like <q>visualize cul-de-sacs or one-way streets, plot shortest-path routes, or calculate stats like intersection density, average node connectivity, or betweenness centrality</q>. Or simply
plot the OSM data as in the graph above.</p>

<p>The source code is hosted at GitHub: <a href="https://github.com/gboeing/osmnx">https://github.com/gboeing/osmnx</a>.</p>

<!--more-->

<blockquote cite="https://github.com/gboeing/osmnx">OSMnx is a Python 2+3 package that lets you download spatial geometries and construct, project, visualize, and analyze street networks from OpenStreetMap's APIs. Users can download and construct walkable, drivable, or bikable urban networks with a single line of Python code, and then easily analyze and visualize them.</blockquote>

<p>The only issue I found while creating the map for Auckland using the example from the project
README, was that the script would exit with the following error: <strong>“ValueError: Geometry must be a shapely Polygon or MultiPolygon”</strong>.</p>

<p>After looking at the list of dependencies and finding that everything seemed to be OK,
I started looking at the project issues. And thankfully someone else had found the
<a href="https://github.com/gboeing/osmnx/issues/16">same issue</a>
and the maintainer of the project answered how to fix it.</p>

<p>The issue was that the OSM API returns two <a href="https://nominatim.openstreetmap.org/search?format=json&amp;limit=10&amp;dedupe=0&amp;polygon_geojson=1&amp;q=Auckland,%20New%20Zealand">entries for Auckland</a>
, where the first one is a Point, and the
second is the one that we want (a Polygon). The application defaults to using the first element,
so in order to change it you have to give a <em>which_result</em> argument.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="n">ox</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">ox</span><span class="p">.</span><span class="n">graph_from_place</span><span class="p">(</span><span class="s">'Auckland, NZ'</span><span class="p">,</span> <span class="n">network_type</span><span class="o">=</span><span class="s">'drive'</span><span class="p">,</span> <span class="n">which_result</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ox</span><span class="p">.</span><span class="n">plot_graph</span><span class="p">(</span><span class="n">ox</span><span class="p">.</span><span class="n">project_graph</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
</code></pre></div></div>

<p>And after that, and after waiting a few minutes, you should get your map :-)</p>

<p>Happy hacking!</p>

  </div>

  <div class="tags"><p>Tags:&nbsp;<a class="label" href="/tag/gis">gis</a>.<br/></p></div>

  <a class="u-url" href="/2017/01/05/plotting-auckland-with-osmnx.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
