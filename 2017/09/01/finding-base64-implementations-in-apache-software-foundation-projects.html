<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Finding Base64 implementations in Apache Software Foundation projects | Bruno P. Kinoshita</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Finding Base64 implementations in Apache Software Foundation projects" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="New Zealand Grey Warbler (riroriro) Some time ago while working in one of the many projects in the Apache Software Foundation (Apache Commons FileUpload if I remember well), I noticed that it had a Base64 implementation. What called my attention was that the project not using the Apache Commons Codec Base64 implementation. While Apache Commons’ mission is to create components that can be re-used across ASF projects, and also by other projects not necessarily under the ASF, it is understandable that some projects prefer to keep its dependencies to a minimum. It is normally a good software engineering practice to carefully manage your dependencies. But would Apache Commons FileUpload be the only project in the ASF with its own Base64 implementation? What is Base64? Simply put, Base64 is a way to encode bytes to strings. It utilises a table, to convert parts of the binary input to certain numbers. These numbers match an entry in the table used by the Base64 implementation. There are several Base64 implementations, though some are obsolete now. The input text “this is base64!” results in “dGhpcyBpcyBiYXNlNjQh”. It can be decoded and will result in the same input text. An image can also be encoded. Or a ZIP file. This is helpful for data transfer and storage. Apache Commons Codec is well known to provide a Bse64 implementation, and used in several projects, both Open Source and in the industry. Its implementation is based on the RFC-2045. Java 8 contains a Base64 implementation, so that may very well replace Apache Commons Coded use in some projects, though that may take some time. The Java 8 implementation supports the RFC-2045, RFC-4648, and has also support to the URL and MIME formats. Searching for other Base64 implementations Using GitHub search, I looked for other Base64 implementations in the ASF projects. Here’s the result table with only the custom implementations found after going through some 15 pages in more than 100 pages with hits for “base64”. Project &amp; link to implementation JVM Base64 implementation Apache ActiveMQ Artemis 8 RFC-3548, based on http://iharder.net/base64 Apache AsterixDB Hyracks (Incubator) 8 ? Apache Calcite Avatica 7 RFC-3548, based on http://iharder.net/base64 Apache Cayenne 8 RFC-2045 (based on codec) Apache Chemistry 7 RFC-3548, based on http://iharder.net/base64 Apache Commons FileUpload 6 ? Apache Commons Net 6 RFC-2045 (copy of codec?) Apache Directory Kerby 7 RFC-2045 (copy of codec?) Apache Felix 5 (?) RFC-2045 (copy of codec?) Apache HBase 8 RFC-3548, based on http://iharder.net/base64 Apache Jackrabbit 8 (?) ? Apache James 6 RFC-2045 via javax.mail.internet.MimeUtility Apache James Mime4J 5 RFC-2045 (based on codec) Apache OFBiz 8 RFC-2045 Apache Pivot 6 RFC-2045 Apache Qpid 8 ? uses javax.xml.bind.DatatypeConverter#parseBase64Binary() Apache Shiro 6 RFC-2045 (based on commons) Apache Tomcat 8 RFC-2045 (copy of codec?) Apache TomEE 7 RFC-2045 Apache TomEE (Site-NG) 6 RFC-2045 Apache Trafodion (Incubator) 7 RFC-3548, based on http://iharder.net/base64 Apache Wave (Incubator) 7 RFC-3548 (?), based on http://iharder.net/base64 Notes and conclusions Projects using Java 8 can likely remove its own implementation in favour of the new JVM 8 implementation. Some projects were already using Java 8 Base64 implementation. Some projects were using Apache Commons Codec. Some projects were using the Base64 implementation from http://iharder.net/base64, which claims to be very fast. It could be interesting to further investigate it. Perhaps projects where Base64 is used a lot, there could be a significant performance increase by using this version. Even though most of these projects are not using Apache Commons Codec, some have either copied or based their implementations on Apache Commons Codec. Perhaps shading would be more effective? Or maybe adding it as a dependency… I guess the Base64 implementations could be hidden from external users with /*protected*/, private scope. As they are probably not part of Apache Commons Net, or Apache Cayenne public API. Which will be solved eventually after Java 9… Some implementations do not make it clear which RFC or standard they are following. Some derived the reference work (e.g. Apache Wave (Incubator) modified the iharder removing features…). It could be that some of these projects that contain many dependencies like Cayenne and Pivot may even have Commons Codec in the class path as a transitive dependency. If so, it could be interesting to add it as a dependency and remove its own implementation, or simply use Java 8’s. Some implementations like HBase and Trafodion were not using the latest version from http://iharder.net/base64. In the case of HBase and Trafodion, several invalid inputs have been fixed from 2.2.1 to 2.3.7. Future work I will try to investigate which of these projects that have a custom Base64 implementation and are using Java 8 can be updated to throw away its own version (時間があるときでしょう!). The implementation from http://iharder.net/base64 promises to be very fast, and Apache ActiveMQ Artemis adopted it. We could consider adding a similar fast version to Apache Commons Codec. This could be a reason for keeping its own Base64 implementation. Java 8 Base64 provides Base64, MIME, and URL formats for encode and decoding. Perhaps we could add more formats to Apache Commons Codec too. Even custom formats. This could be a reason for keeping Apache Commons Codec’s implementation. Happy encoding! ♥ Open Source" />
<meta property="og:description" content="New Zealand Grey Warbler (riroriro) Some time ago while working in one of the many projects in the Apache Software Foundation (Apache Commons FileUpload if I remember well), I noticed that it had a Base64 implementation. What called my attention was that the project not using the Apache Commons Codec Base64 implementation. While Apache Commons’ mission is to create components that can be re-used across ASF projects, and also by other projects not necessarily under the ASF, it is understandable that some projects prefer to keep its dependencies to a minimum. It is normally a good software engineering practice to carefully manage your dependencies. But would Apache Commons FileUpload be the only project in the ASF with its own Base64 implementation? What is Base64? Simply put, Base64 is a way to encode bytes to strings. It utilises a table, to convert parts of the binary input to certain numbers. These numbers match an entry in the table used by the Base64 implementation. There are several Base64 implementations, though some are obsolete now. The input text “this is base64!” results in “dGhpcyBpcyBiYXNlNjQh”. It can be decoded and will result in the same input text. An image can also be encoded. Or a ZIP file. This is helpful for data transfer and storage. Apache Commons Codec is well known to provide a Bse64 implementation, and used in several projects, both Open Source and in the industry. Its implementation is based on the RFC-2045. Java 8 contains a Base64 implementation, so that may very well replace Apache Commons Coded use in some projects, though that may take some time. The Java 8 implementation supports the RFC-2045, RFC-4648, and has also support to the URL and MIME formats. Searching for other Base64 implementations Using GitHub search, I looked for other Base64 implementations in the ASF projects. Here’s the result table with only the custom implementations found after going through some 15 pages in more than 100 pages with hits for “base64”. Project &amp; link to implementation JVM Base64 implementation Apache ActiveMQ Artemis 8 RFC-3548, based on http://iharder.net/base64 Apache AsterixDB Hyracks (Incubator) 8 ? Apache Calcite Avatica 7 RFC-3548, based on http://iharder.net/base64 Apache Cayenne 8 RFC-2045 (based on codec) Apache Chemistry 7 RFC-3548, based on http://iharder.net/base64 Apache Commons FileUpload 6 ? Apache Commons Net 6 RFC-2045 (copy of codec?) Apache Directory Kerby 7 RFC-2045 (copy of codec?) Apache Felix 5 (?) RFC-2045 (copy of codec?) Apache HBase 8 RFC-3548, based on http://iharder.net/base64 Apache Jackrabbit 8 (?) ? Apache James 6 RFC-2045 via javax.mail.internet.MimeUtility Apache James Mime4J 5 RFC-2045 (based on codec) Apache OFBiz 8 RFC-2045 Apache Pivot 6 RFC-2045 Apache Qpid 8 ? uses javax.xml.bind.DatatypeConverter#parseBase64Binary() Apache Shiro 6 RFC-2045 (based on commons) Apache Tomcat 8 RFC-2045 (copy of codec?) Apache TomEE 7 RFC-2045 Apache TomEE (Site-NG) 6 RFC-2045 Apache Trafodion (Incubator) 7 RFC-3548, based on http://iharder.net/base64 Apache Wave (Incubator) 7 RFC-3548 (?), based on http://iharder.net/base64 Notes and conclusions Projects using Java 8 can likely remove its own implementation in favour of the new JVM 8 implementation. Some projects were already using Java 8 Base64 implementation. Some projects were using Apache Commons Codec. Some projects were using the Base64 implementation from http://iharder.net/base64, which claims to be very fast. It could be interesting to further investigate it. Perhaps projects where Base64 is used a lot, there could be a significant performance increase by using this version. Even though most of these projects are not using Apache Commons Codec, some have either copied or based their implementations on Apache Commons Codec. Perhaps shading would be more effective? Or maybe adding it as a dependency… I guess the Base64 implementations could be hidden from external users with /*protected*/, private scope. As they are probably not part of Apache Commons Net, or Apache Cayenne public API. Which will be solved eventually after Java 9… Some implementations do not make it clear which RFC or standard they are following. Some derived the reference work (e.g. Apache Wave (Incubator) modified the iharder removing features…). It could be that some of these projects that contain many dependencies like Cayenne and Pivot may even have Commons Codec in the class path as a transitive dependency. If so, it could be interesting to add it as a dependency and remove its own implementation, or simply use Java 8’s. Some implementations like HBase and Trafodion were not using the latest version from http://iharder.net/base64. In the case of HBase and Trafodion, several invalid inputs have been fixed from 2.2.1 to 2.3.7. Future work I will try to investigate which of these projects that have a custom Base64 implementation and are using Java 8 can be updated to throw away its own version (時間があるときでしょう!). The implementation from http://iharder.net/base64 promises to be very fast, and Apache ActiveMQ Artemis adopted it. We could consider adding a similar fast version to Apache Commons Codec. This could be a reason for keeping its own Base64 implementation. Java 8 Base64 provides Base64, MIME, and URL formats for encode and decoding. Perhaps we could add more formats to Apache Commons Codec too. Even custom formats. This could be a reason for keeping Apache Commons Codec’s implementation. Happy encoding! ♥ Open Source" />
<link rel="canonical" href="https://kinoshita.eti.br/2017/09/01/finding-base64-implementations-in-apache-software-foundation-projects.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2017/09/01/finding-base64-implementations-in-apache-software-foundation-projects.html" />
<meta property="og:site_name" content="Bruno P. Kinoshita" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-01T02:23:03-05:00" />
<script type="application/ld+json">
{"datePublished":"2017-09-01T02:23:03-05:00","headline":"Finding Base64 implementations in Apache Software Foundation projects","description":"New Zealand Grey Warbler (riroriro) Some time ago while working in one of the many projects in the Apache Software Foundation (Apache Commons FileUpload if I remember well), I noticed that it had a Base64 implementation. What called my attention was that the project not using the Apache Commons Codec Base64 implementation. While Apache Commons’ mission is to create components that can be re-used across ASF projects, and also by other projects not necessarily under the ASF, it is understandable that some projects prefer to keep its dependencies to a minimum. It is normally a good software engineering practice to carefully manage your dependencies. But would Apache Commons FileUpload be the only project in the ASF with its own Base64 implementation? What is Base64? Simply put, Base64 is a way to encode bytes to strings. It utilises a table, to convert parts of the binary input to certain numbers. These numbers match an entry in the table used by the Base64 implementation. There are several Base64 implementations, though some are obsolete now. The input text “this is base64!” results in “dGhpcyBpcyBiYXNlNjQh”. It can be decoded and will result in the same input text. An image can also be encoded. Or a ZIP file. This is helpful for data transfer and storage. Apache Commons Codec is well known to provide a Bse64 implementation, and used in several projects, both Open Source and in the industry. Its implementation is based on the RFC-2045. Java 8 contains a Base64 implementation, so that may very well replace Apache Commons Coded use in some projects, though that may take some time. The Java 8 implementation supports the RFC-2045, RFC-4648, and has also support to the URL and MIME formats. Searching for other Base64 implementations Using GitHub search, I looked for other Base64 implementations in the ASF projects. Here’s the result table with only the custom implementations found after going through some 15 pages in more than 100 pages with hits for “base64”. Project &amp; link to implementation JVM Base64 implementation Apache ActiveMQ Artemis 8 RFC-3548, based on http://iharder.net/base64 Apache AsterixDB Hyracks (Incubator) 8 ? Apache Calcite Avatica 7 RFC-3548, based on http://iharder.net/base64 Apache Cayenne 8 RFC-2045 (based on codec) Apache Chemistry 7 RFC-3548, based on http://iharder.net/base64 Apache Commons FileUpload 6 ? Apache Commons Net 6 RFC-2045 (copy of codec?) Apache Directory Kerby 7 RFC-2045 (copy of codec?) Apache Felix 5 (?) RFC-2045 (copy of codec?) Apache HBase 8 RFC-3548, based on http://iharder.net/base64 Apache Jackrabbit 8 (?) ? Apache James 6 RFC-2045 via javax.mail.internet.MimeUtility Apache James Mime4J 5 RFC-2045 (based on codec) Apache OFBiz 8 RFC-2045 Apache Pivot 6 RFC-2045 Apache Qpid 8 ? uses javax.xml.bind.DatatypeConverter#parseBase64Binary() Apache Shiro 6 RFC-2045 (based on commons) Apache Tomcat 8 RFC-2045 (copy of codec?) Apache TomEE 7 RFC-2045 Apache TomEE (Site-NG) 6 RFC-2045 Apache Trafodion (Incubator) 7 RFC-3548, based on http://iharder.net/base64 Apache Wave (Incubator) 7 RFC-3548 (?), based on http://iharder.net/base64 Notes and conclusions Projects using Java 8 can likely remove its own implementation in favour of the new JVM 8 implementation. Some projects were already using Java 8 Base64 implementation. Some projects were using Apache Commons Codec. Some projects were using the Base64 implementation from http://iharder.net/base64, which claims to be very fast. It could be interesting to further investigate it. Perhaps projects where Base64 is used a lot, there could be a significant performance increase by using this version. Even though most of these projects are not using Apache Commons Codec, some have either copied or based their implementations on Apache Commons Codec. Perhaps shading would be more effective? Or maybe adding it as a dependency… I guess the Base64 implementations could be hidden from external users with /*protected*/, private scope. As they are probably not part of Apache Commons Net, or Apache Cayenne public API. Which will be solved eventually after Java 9… Some implementations do not make it clear which RFC or standard they are following. Some derived the reference work (e.g. Apache Wave (Incubator) modified the iharder removing features…). It could be that some of these projects that contain many dependencies like Cayenne and Pivot may even have Commons Codec in the class path as a transitive dependency. If so, it could be interesting to add it as a dependency and remove its own implementation, or simply use Java 8’s. Some implementations like HBase and Trafodion were not using the latest version from http://iharder.net/base64. In the case of HBase and Trafodion, several invalid inputs have been fixed from 2.2.1 to 2.3.7. Future work I will try to investigate which of these projects that have a custom Base64 implementation and are using Java 8 can be updated to throw away its own version (時間があるときでしょう!). The implementation from http://iharder.net/base64 promises to be very fast, and Apache ActiveMQ Artemis adopted it. We could consider adding a similar fast version to Apache Commons Codec. This could be a reason for keeping its own Base64 implementation. Java 8 Base64 provides Base64, MIME, and URL formats for encode and decoding. Perhaps we could add more formats to Apache Commons Codec too. Even custom formats. This could be a reason for keeping Apache Commons Codec’s implementation. Happy encoding! ♥ Open Source","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2017/09/01/finding-base64-implementations-in-apache-software-foundation-projects.html"},"@type":"BlogPosting","url":"https://kinoshita.eti.br/2017/09/01/finding-base64-implementations-in-apache-software-foundation-projects.html","dateModified":"2017-09-01T02:23:03-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="Bruno P. Kinoshita" /></head>
<body>
<div id="wrapper">
  <div id="sidebar"><div id="menu">
  <ul class="menu">
    <li class="item">
      <a href="/" aria-label="Home page link">
        <svg id="svg8" version="1.1" viewBox="0 0 58.208 9.2604" xmlns="http://www.w3.org/2000/svg" role="img"
             aria-labelledby="svg-logo-title svg-logo-desc">
          <title id="svg-logo-title">KINOSHITA image</title>
          <desc id="svg-logo-desc">A logo with the word KINOSHITA</desc>
          <g id="layer1" transform="translate(0 -287.74)">
            <g id="text817" transform="translate(-2.4568 -.23624)">
              <g id="logo" transform="matrix(2.6585 0 0 2.5911 -63.587 100.56)" fill="#000000" stroke-width=".26458px">
                <path role="presentation" id="path819"
                      d="m25.178 72.637h0.54187v2.9633h-0.54187zm0.5842 1.397 1.0964-1.397h0.635l-1.1049 1.397 1.1049 1.5663h-0.635z"/>
                <path role="presentation" id="path821" d="m27.832 72.637h0.54187v2.9633h-0.54187z"/>
                <path role="presentation" id="path823"
                      d="m29.023 72.637h0.5334l1.2658 1.9135v-1.9135h0.54187v2.9633h-0.4445l-1.3547-2.032v2.032h-0.54187z"/>
                <path role="presentation" id="path825"
                      d="m33.298 75.66q-0.4191 0-0.75353-0.1905-0.3302-0.19473-0.5207-0.54187-0.18627-0.35137-0.18627-0.80857t0.18627-0.80433q0.1905-0.35137 0.5207-0.54187 0.33443-0.19473 0.75353-0.19473t0.7493 0.19473q0.33443 0.1905 0.5207 0.54187 0.1905 0.34713 0.1905 0.80433t-0.1905 0.80857q-0.18627 0.34713-0.5207 0.54187-0.3302 0.1905-0.7493 0.1905zm0-0.52493q0.4318 0 0.6604-0.2794 0.23283-0.2794 0.23283-0.7366t-0.23283-0.7366q-0.2286-0.2794-0.6604-0.2794t-0.66463 0.2794q-0.2286 0.2794-0.2286 0.7366t0.2286 0.7366q0.23283 0.2794 0.66463 0.2794z"/>
                <path role="presentation" id="path827"
                      d="m36.091 75.66q-0.24977 0-0.53763-0.06773-0.28363-0.06773-0.4445-0.14817l0.0635-0.57573q0.5588 0.27093 0.98213 0.27093 0.22437 0 0.35137-0.08467 0.127-0.0889 0.127-0.25823 0-0.127-0.07197-0.20743-0.06773-0.08467-0.19897-0.1397-0.13123-0.05927-0.4191-0.16087-0.27093-0.09313-0.44873-0.19473-0.1778-0.10583-0.28363-0.2667-0.1016-0.1651-0.1016-0.40217 0-0.381 0.2794-0.61383t0.8001-0.23283q0.24553 0 0.48683 0.05503 0.24553 0.05503 0.44873 0.13547l-0.05503 0.55457q-0.26247-0.1143-0.4826-0.16933-0.2159-0.05927-0.4318-0.05927-0.2413 0-0.3683 0.08043t-0.127 0.23283q0 0.11853 0.06773 0.19473t0.18203 0.127q0.11853 0.0508 0.34713 0.12277 0.51223 0.16087 0.74507 0.37253 0.23707 0.20743 0.23707 0.5715 0 0.34713-0.2413 0.60537t-0.90593 0.25823z"/>
                <path role="presentation" id="path829"
                      d="m37.688 72.637h0.54187v1.1726h1.3547v-1.1726h0.54187v2.9633h-0.54187v-1.2827h-1.3547v1.2827h-0.54187z"/>
                <path role="presentation" id="path831" d="m40.78 72.637h0.54187v2.9633h-0.54187z"/>
                <path role="presentation" id="path833"
                      d="m42.546 73.162h-0.8382v-0.52493h2.2183v0.52493h-0.8382v2.4384h-0.54187z"/>
                <path role="presentation" id="path835"
                      d="m45.632 74.898h-1.0795l-0.24553 0.70273h-0.52493l1.0541-2.9633h0.51223l1.0541 2.9633h-0.52493zm-0.16933-0.47413-0.3683-1.0583-0.37253 1.0583z"/>
              </g>
            </g>
          </g>
        </svg>
      </a>
    </li>
    <li class="item">
      <a href="/blog/" class="">Blog</a>
      <ul>
        <li class="item">
          <a href="/blog/drawing/">Drawing</a>
        </li>
        <li class="item">
          <a href="/blog/languages/">Languages</a>
        </li>
        <li class="item">
          <a href="/blog/music/">Music</a>
        </li>
        <li class="item">
          <a href="/blog/writing/">Writing</a>
        </li>
      </ul>
    </li>
    <li class="item">
      <a href="/art/" class="">Illustrations</a>
    </li>
    <li class="item">
      <a href="/maps/" class="">Maps</a>
    </li>
  </ul>
  <div id="menu-bottom">
    <p id="feed-subscribe">
      <a href="/feed.xml">
        <svg id="feed-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" width="128px" height="128px"
             viewBox="0 0 256 256">
          <circle cx="68" cy="189" r="24" fill="rgba(255, 255, 255, .2)"/>
          <path d="M160 213h-34a82 82 0 0 0 -82 -82v-34a116 116 0 0 1 116 116z" fill="rgba(255, 255, 255, .2)"/>
          <path d="M184 213A140 140 0 0 0 44 73 V 38a175 175 0 0 1 175 175z" fill="rgba(255, 255, 255, .2)"/>
        </svg>
      </a>
    </p>
  </div>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Finding Base64 implementations in Apache Software Foundation projects</h1>
    <spab class="post-meta">
      <time class="dt-published" datetime="2017-09-01T02:23:03-05:00" itemprop="datePublished">Sep 1, 2017
      </time>
      <span>&mdash; star date: -305252.05</span></spab>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p style="text-align: center;">
<a href="https://kinow.deviantart.com/art/Grey-Warbler-702099183?ga_submit_new=10%3A1504263729">
<img style="display: inline" class="ui image" src="/assets/posts/2017-09-01-finding-base64-implementations-in-apache-software-foundation-projects/GreyWarbler.png" alt="NZ Grey Warbler (riroriro)" title="NZ Grey Warbler (riroriro)" />
</a>
<br />
<small><a href="http://nzbirdsonline.org.nz/species/grey-warbler">New Zealand Grey Warbler (riroriro)</a></small>
</p>

<p>Some time ago while working in one of the many projects in the Apache Software Foundation (Apache Commons FileUpload if I remember well), I noticed that it had a Base64 implementation. What called my attention was that the project not using the <a href="https://github.com/apache/commons-codec/blob/c18b1923b3c1f897c7935d94fb9e443eabfff897/src/main/java/org/apache/commons/codec/binary/Base64.java">Apache Commons Codec</a> Base64 implementation.</p>

<p>While Apache Commons’ mission is to create components that can be re-used across ASF projects, and also by other projects not necessarily under the ASF, it is understandable that some projects prefer to keep its dependencies to a minimum. It is normally a good software engineering practice to carefully manage your dependencies.</p>

<p>But would Apache Commons FileUpload be the only project in the ASF with its own Base64 implementation?</p>

<h3 id="what-is-base64">What is Base64?</h3>

<p>Simply put, Base64 is a way to encode bytes to strings. It utilises a table, to convert parts of the binary input to certain numbers. These numbers match an entry in the table used by the Base64 implementation. There are several Base64 implementations, though some are obsolete now.</p>

<p>The input text “<em>this is base64!</em>” results in “<em>dGhpcyBpcyBiYXNlNjQh</em>”. It can be decoded and will result in the same input text. An image can also be encoded. Or a ZIP file. This is helpful for data transfer and storage.</p>

<p>Apache Commons Codec is well known to provide a Bse64 implementation, and used in several projects, both Open Source and in the industry. Its implementation is based on the <a href="https://www.ietf.org/rfc/rfc2045.txt">RFC-2045</a>.</p>

<p>Java 8 contains a Base64 implementation, so that may very well replace Apache Commons Coded use in some projects, though that may take some time. The Java 8 implementation supports the RFC-2045, RFC-4648, and <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Base64.html">has also</a> support to the URL and MIME formats.</p>

<h3 id="searching-for-other-base64-implementations">Searching for other Base64 implementations</h3>

<p>Using GitHub search, I looked for other Base64 implementations in the ASF projects. Here’s the result table with only the custom implementations found after going through some 15 pages in more than 100 pages with hits for “base64”.</p>

<table>
  <thead>
    <tr>
      <th>Project &amp; link to implementation</th>
      <th style="text-align: center">JVM</th>
      <th style="text-align: right">Base64 implementation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><a href="https://github.com/apache/activemq-artemis/blob/master/artemis-commons/src/main/java/org/apache/activemq/artemis/utils/Base64.java">Apache ActiveMQ Artemis</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">RFC-3548, based on http://iharder.net/base64</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/incubator-asterixdb-hyracks/blob/3f849969f01effc9b6e7f22462ceb4b2bedabdc4/hyracks/hyracks-util/src/main/java/org/apache/hyracks/util/bytes/Base64Parser.java">Apache AsterixDB Hyracks (Incubator)</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">?</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/calcite-avatica/blob/4db1fb9c66db8ccebc9e96ce678154ec69c557f0/core/src/main/java/org/apache/calcite/avatica/util/Base64.java">Apache Calcite Avatica</a></td>
      <td style="text-align: center">7</td>
      <td style="text-align: right">RFC-3548, based on http://iharder.net/base64</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/cayenne/blob/bd1b109a943307a83078399c7a4d6aa53631a065/cayenne-server/src/main/java/org/apache/cayenne/util/Base64Codec.java">Apache Cayenne</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">RFC-2045 (based on codec)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/chemistry-opencmis/blob/trunk/chemistry-opencmis-commons/chemistry-opencmis-commons-impl/src/main/java/org/apache/chemistry/opencmis/commons/impl/Base64.java">Apache Chemistry</a></td>
      <td style="text-align: center">7</td>
      <td style="text-align: right">RFC-3548, based on http://iharder.net/base64</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/commons-fileupload/blob/422caf46e5b7a950c639b8ba9fe41e16279b3aa9/src/main/java/org/apache/commons/fileupload/util/mime/Base64Decoder.java">Apache Commons FileUpload</a></td>
      <td style="text-align: center">6</td>
      <td style="text-align: right">?</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/commons-net/blob/trunk/src/main/java/org/apache/commons/net/util/Base64.java">Apache Commons Net</a></td>
      <td style="text-align: center">6</td>
      <td style="text-align: right">RFC-2045 (copy of codec?)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/directory-kerby/blob/b7da10e3815a8ab84ab7ff4fa3572c92bfa9aef5/kerby-common/kerby-util/src/main/java/org/apache/kerby/util/Base64.java">Apache Directory Kerby</a></td>
      <td style="text-align: center">7</td>
      <td style="text-align: right">RFC-2045 (copy of codec?)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/felix/blob/a4755e768329a29252b1d7d8e52537941768606d/webconsole-plugins/upnp/src/main/java/org/apache/felix/webconsole/plugins/upnp/internal/Base64.java">Apache Felix</a></td>
      <td style="text-align: center">5 (?)</td>
      <td style="text-align: right">RFC-2045 (copy of codec?)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/hbase/blob/a66d491892514fd4a188d6ca87d6260d8ae46184/hbase-common/src/main/java/org/apache/hadoop/hbase/util/Base64.java">Apache HBase</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">RFC-3548, based on http://iharder.net/base64</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/jackrabbit/blob/adb1e79ae26aba5d068be56e5e9eb562344e5bb9/jackrabbit-jcr-commons/src/main/java/org/apache/jackrabbit/util/Base64.java">Apache Jackrabbit</a></td>
      <td style="text-align: center">8 (?)</td>
      <td style="text-align: right">?</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/james-project/blob/bab5ff434c407b98432cdc9af00b0263184de26a/server/protocols/protocols-smtp/src/test/java/org/apache/james/smtpserver/Base64.java">Apache James</a></td>
      <td style="text-align: center">6</td>
      <td style="text-align: right">RFC-2045 via javax.mail.internet.MimeUtility</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/james-mime4j/blob/cb48082fb7cbbfb111c926cc8ae953d7261c235c/core/src/main/java/org/apache/james/mime4j/codec/Base64OutputStream.java">Apache James Mime4J</a></td>
      <td style="text-align: center">5</td>
      <td style="text-align: right">RFC-2045 (based on codec)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/ofbiz-framework/blob/29b815f1b969653da96995fed25e2cc52f25879d/framework/base/src/main/java/org/apache/ofbiz/base/util/Base64.java">Apache OFBiz</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">RFC-2045</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/pivot/blob/d9a21718f182d3c667b18b0f2c62f6ec1cd0e6dd/core/src/org/apache/pivot/util/Base64.java">Apache Pivot</a></td>
      <td style="text-align: center">6</td>
      <td style="text-align: right">RFC-2045</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/qpid-broker-j/blob/1c20cc32b17c58391b0aefcd00f74bc1b4253db9/broker-core/src/main/java/org/apache/qpid/server/util/Strings.java#L132">Apache Qpid</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">? uses javax.xml.bind.DatatypeConverter#parseBase64Binary()</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/shiro/blob/8acc82ab4775b3af546e3bbde928f299be62dc23/lang/src/main/java/org/apache/shiro/codec/Base64.java">Apache Shiro</a></td>
      <td style="text-align: center">6</td>
      <td style="text-align: right">RFC-2045 (based on commons)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/tomcat/blob/trunk/java/org/apache/tomcat/util/codec/binary/Base64.java">Apache Tomcat</a></td>
      <td style="text-align: center">8</td>
      <td style="text-align: right">RFC-2045 (copy of codec?)</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/tomee/blob/8fc8d8011c5155e7f47ebc162cb88124bf4ca06e/container/openejb-core/src/main/java/org/apache/openejb/util/Base64.java">Apache TomEE</a></td>
      <td style="text-align: center">7</td>
      <td style="text-align: right">RFC-2045</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/tomee-site-ng/blob/8dbf7c5a4bdc6cd5249e00ff85d78a24fd76c7af/container/openejb-core/src/main/java/org/apache/openejb/util/Base64.java">Apache TomEE (Site-NG)</a></td>
      <td style="text-align: center">6</td>
      <td style="text-align: right">RFC-2045</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/incubator-trafodion/blob/b36003cf824bae6b0faf8b03c313f189991d5be1/core/rest/src/main/java/org/trafodion/rest/util/Base64.java">Apache Trafodion (Incubator)</a></td>
      <td style="text-align: center">7</td>
      <td style="text-align: right">RFC-3548, based on http://iharder.net/base64</td>
    </tr>
    <tr>
      <td><a href="https://github.com/apache/incubator-wave/blob/master/wave/src/main/java/org/waveprotocol/wave/model/util/CharBase64.java">Apache Wave (Incubator)</a></td>
      <td style="text-align: center">7</td>
      <td style="text-align: right">RFC-3548 (?), based on http://iharder.net/base64</td>
    </tr>
  </tbody>
</table>

<h3 id="notes-and-conclusions">Notes and conclusions</h3>

<ul>
  <li><strong>Projects using Java 8 can likely remove its own implementation in favour of the new JVM 8 implementation</strong>.</li>
  <li>Some projects were already using <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Base64.Decoder.html">Java 8 Base64 implementation</a>.</li>
  <li>Some projects were using Apache Commons Codec.</li>
  <li>Some projects were using the Base64 implementation from http://iharder.net/base64, which claims to be very fast. It could be interesting to further investigate it. Perhaps projects where Base64 is used a lot, there could be a significant performance increase by using this version.</li>
  <li>Even though most of these projects are not using Apache Commons Codec, some have either copied or based their implementations on Apache Commons Codec. Perhaps shading would be more effective? Or maybe adding it as a dependency…</li>
  <li>I guess the Base64 implementations could be hidden from external users with /*protected*/, private scope. As they are probably not part of Apache Commons Net, or Apache Cayenne public API. Which will be solved eventually after Java 9…</li>
  <li>Some implementations do not make it clear which RFC or standard they are following. Some derived the reference work (e.g. Apache Wave (Incubator) modified the iharder removing features…).</li>
  <li>It could be that some of these projects that contain many dependencies like Cayenne and Pivot may even have Commons Codec in the class path as a transitive dependency. If so, it could be interesting to add it as a dependency and remove its own implementation, or simply use Java 8’s.</li>
  <li>Some implementations like HBase and Trafodion were not using the latest version from http://iharder.net/base64. In the case of HBase and Trafodion, several invalid inputs have been fixed from 2.2.1 to 2.3.7.</li>
</ul>

<h3 id="future-work">Future work</h3>

<ul>
  <li>I will try to investigate which of these projects that have a custom Base64 implementation and are using Java 8 can be updated to throw away its own version (時間があるときでしょう!).</li>
  <li>The implementation from <a href="http://iharder.net/base64">http://iharder.net/base64</a> promises to be very fast, and Apache ActiveMQ Artemis adopted it. We could consider adding a similar <em>fast</em> version to Apache Commons Codec. This could be a reason for keeping its own Base64 implementation.</li>
  <li>Java 8 Base64 provides Base64, MIME, and URL formats for encode and decoding. Perhaps we could add more formats to Apache Commons Codec too. Even <a href="https://github.com/apache/commons-codec/pull/3">custom formats</a>. This could be a reason for keeping Apache Commons Codec’s implementation.</li>
</ul>

<p>Happy encoding!</p>

<p>♥ Open Source</p>

  </div>

  <div class="tags"><a class="label" href="/tags#java">java</a><a class="label" href="/tags#programming">programming</a><a class="label" href="/tags#opensource">opensource</a><a class="label" href="/tags#apache software foundation">apache software foundation</a></div>

  <a class="u-url" href="/2017/09/01/finding-base64-implementations-in-apache-software-foundation-projects.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
