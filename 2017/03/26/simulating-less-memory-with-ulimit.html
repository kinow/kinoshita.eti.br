<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://kinoshita.eti.br/2017/03/26/simulating-less-memory-with-ulimit.html"><meta property="og:site_name" content="kinow"><meta property="og:title" content="Simulating less memory with ulimit"><meta property="og:description" content="These days I was trying to reproduce a bug in Krita where it would crash when a user copied group layers between windows. It appeared that the user was getting a segmentation fault due to the user&amp;rsquo;s computer running out of memory.
I could not reproduce the issue, but my computer has 16 GB. The first thing that came to my mind was to create a virtual machine with less memory to reproduce the issue."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-03-26T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-28T13:29:56+02:00"><meta property="article:tag" content="C++"><meta property="article:tag" content="Krita"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Opensource"><meta property="og:image" content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta property="fb:admins" content="bruno.kinoshita"><meta name=twitter:title content="Simulating less memory with ulimit"><meta name=twitter:description content="These days I was trying to reproduce a bug in Krita where it would crash when a user copied group layers between windows. It appeared that the user was getting a segmentation fault due to the user&rsquo;s computer running out of memory.
I could not reproduce the issue, but my computer has 16 GB. The first thing that came to my mind was to create a virtual machine with less memory to reproduce the issue."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta name=twitter:site content="@kinow"><link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2017/03/26/simulating-less-memory-with-ulimit/feed.xml title=kinow><link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.c3626db3678f53e4a53e3e75c7b2fe34bb46566f00eb84692501404d0064c32a.css integrity="sha256-w2Jts2ePU+SlPj51x7L+NLtGVm8A64RpJQFATQBkwyo="><title>kinow | Simulating less memory with ulimit</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Simulating less memory with ulimit","headline":"Simulating less memory with ulimit","alternativeHeadline":"","description":"These days I was trying to reproduce a bug in Krita where it would crash when a user copied group layers between windows. It appeared that the user was getting a segmentation fault due to the user\u0026rsquo;s computer running out of memory.\nI could not reproduce the issue, but my computer has 16 GB. The first thing that came to my mind was to create a virtual machine with less memory to reproduce the issue.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kinoshita.eti.br\/2017\/03\/26\/simulating-less-memory-with-ulimit.html"},"author":{"@type":"Person","name":"Bruno P. Kinoshita"},"creator":{"@type":"Person","name":"Bruno P. Kinoshita"},"accountablePerson":{"@type":"Person","name":"Bruno P. Kinoshita"},"copyrightHolder":"kinow","copyrightYear":"2017","dateCreated":"2017-03-26T00:00:00.00Z","datePublished":"2017-03-26T00:00:00.00Z","dateModified":"2024-05-28T13:29:56.00Z","publisher":{"@type":"Organization","name":"kinow","url":"https://kinoshita.eti.br/","logo":{"@type":"ImageObject","url":"https:\/\/kinoshita.eti.br\/","width":"32","height":"32"}},"image":"https://kinoshita.eti.br/","url":"https:\/\/kinoshita.eti.br\/2017\/03\/26\/simulating-less-memory-with-ulimit.html","wordCount":"186","genre":["c\u002b\u002b","krita","programming","opensource"],"keywords":[]}</script></head><body><header role=banner class=content><nav id=nav aria-label=Main role=navigation class=content><ul><li><a href=/><i data-feather=about></i> About</a></li><li><a href=/blog/><i data-feather=blog></i> Blog</a></li><li><a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a></li></ul></nav></header><main><article class=content><h1>Simulating less memory with ulimit</h1><div class=metadata><i data-feather=calendar></i>
<time datetime=2017-03-26>Mar 26, 2017</time></div><aside><nav id=TableOfContents></nav></aside><p>These days I was trying to reproduce <a href="https://bugs.kde.org/show_bug.cgi?id=376382">a bug in Krita</a>
where it would crash when a user copied group layers between windows. It appeared that the user was
getting a segmentation fault due to the user&rsquo;s computer running out of memory.</p><p>I could not reproduce the issue, but my computer has 16 GB. The first thing that came to my mind was
to create a virtual machine with less memory to reproduce the issue. But I decided to spend some time
looking for a <a href=http://wiki.c2.com/?LazinessImpatienceHubris>simpler way</a> of doing it.</p><p>Searching the web I found some suggestions that <code>ulimit</code> could work. After playing for a while with
<code>ulimit</code> and <code>htop</code>, and verifying the amount of memory necessary to open two files in two windows
in Krita, I came up with the following settings.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#177500># 2550 mb in kb</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>ulimit</span> -v <span style=color:#1c01ce>2550000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500># 2 gb in kb</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>ulimit</span> -m <span style=color:#1c01ce>2000000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#177500># Confirm limits</span>
</span></span><span style=display:flex><span><span style=color:#a90d91>ulimit</span> -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdb <span style=color:#000>$HOME</span>/Development/cpp/workspace/krita_install/bin/krita
</span></span></code></pre></div><p>Then after copying a few layers from one window to another, I successfully reproduced the issue,
and could include a backtrace in the Krita issue tracking system.</p><p>â™¥ Open Source</p><p>Categories:
<a href=/categories/blog.html>Blog</a></p><p>Tags:
<a href=/tags/c++.html>C++</a>,
<a href=/tags/krita.html>Krita</a>,
<a href=/tags/programming.html>Programming</a>,
<a href=/tags/opensource.html>Opensource</a></p><aside class=links><a class=previous href=https://kinoshita.eti.br/2017/03/15/using-google-natural-language-api-in-an-aws-elastic-beanstalk-application.html>&#171; Previous</a><a class=next href=https://kinoshita.eti.br/2017/04/02/fixing-qt-warning-qlayout-attempting-to-add-qlayout-to-qwidget-which-already-has-a-layout.html>Next &#187;</a></aside></article></main><footer role=contentinfo><ul id=social-media-icons><li><a href=https://www.instagram.com/brunokinoshita/><img src=/assets/icons/instagram.png alt="Instagram link"></a></li><li><a href=https://twitter.com/kinow/><img src=/assets/icons/twitter.png alt="Twitter link"></a></li><li><a href=https://github.com/kinow/><img src=/assets/icons/github.png alt="GitHub link"></a></li><li><a href=/feed.xml><img src=/assets/icons/news.png alt="RSS feed link"></a></li></ul></footer></body></html>