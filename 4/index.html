  
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
    <title>Bruno P. Kinoshita &mdash; Home</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Bruno de Paula Kinoshita personal web site" />
    <meta name="keywords"
        content="kinoshita, bruno de paula kinoshita, geek, geek stuff, java, python, c, c++, msn now playing, neural network, mackenzie, sao paulo, brasil, brazil, nerd, nerd stuff, cool, jenkins, illustration, quadrinhos, machine learning, linguistic, apache, open source, codigo livre, codigo aberto" />
    <meta name="author" content="" />
    <meta name="generator" content="PieCrust 3.2.1" />
    <meta name="template-engine" content="Twig" />
    <meta name="robots" content="all=index,follow" />
    <meta name="revisit-after" content="15 days" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta name="distribution" content="Global" />
    <meta name="url" content="/" />
    <meta name="copyright" content="Bruno de Paula Kinoshita" />
    <meta name="Googlebot" content="all" />
    <meta name="rating" content="general" />
    <meta http-equiv="expires" content="0" />
    <meta name="city" content="Sao Paulo" />
    <meta name="state" content="Brasil, Sao Paulo" />
    <meta http-equiv="content-language" content="en" />
    <meta http-equiv="imagetoolbar" content="no" />
    <meta id="page_favicon" href="/favicon.ico" rel="icon" type="image/x-icon" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="alternate" type="application/rss+xml" title="Bruno P. Kinoshita &raquo; Feed" href="/feed.xml" />
    <link rel="stylesheet" href="/css/semantic/dist/semantic.min.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    <link rel="stylesheet" href="/css/prettyPhoto.css" type="text/css" media="all" />
</head>
<body id="body">
    <div class="ui vertical sidebar menu" id="toc">
        <nav class="menu" role="navigation">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/art">Art</a>
    </div>
    <div class="item">
        <a href="/articles/">Articles</a>
    </div>
    <div class="item">
        <a href="/books/">Books</a>
    </div>
    <div class="item">
      <a href="/presentations/">Presentations</a>
    </div>
    <div class="item">
        <a href="/software/">Software</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
    <div class="item">
        <a href="/about/">About &#038; CV</a>
    </div>
</nav>
<img src="/img/bruno.jpg" title="Hmmmm" alt="My picture" width="134px" height="215px" />
    </div>
    <div class="ui black big launch right attached fixed button">
        <i class="content icon"></i>
        <span class="text">Menu</span>
    </div>
    <div class="ui fixed inverted main menu">
        <div class="ui container">
            <a class="launch icon item">
                <i class="content icon"></i>
            </a>
            <div class="item">
                Home
            </div>
        </div>
    </div>
    <div class="pusher">
        <div class="full height">
            <div class="toc">
                <div class="ui vertical sticky fixed top menu">
                    <nav class="menu" role="navigation">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/art">Art</a>
    </div>
    <div class="item">
        <a href="/articles/">Articles</a>
    </div>
    <div class="item">
        <a href="/books/">Books</a>
    </div>
    <div class="item">
      <a href="/presentations/">Presentations</a>
    </div>
    <div class="item">
        <a href="/software/">Software</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
    <div class="item">
        <a href="/about/">About &#038; CV</a>
    </div>
</nav>
<img src="/img/bruno.jpg" title="Hmmmm" alt="My picture" width="134px" height="215px" />
                </div>
            </div>
            <div class="article">
                <div class="main container" role="main">
                    <!-- right fixed menu -->
                    <div class="ui dividing right rail" id="taxonomy">
                        <div class="ui sticky fixed top">
                            <br/>
                            <h4>Blog Taxonomy</h4>
                            <nav id="tag-cloud" class="sidebar-box" role="complementary">
                              
                              <span style="font-size: 22.5pt"><a href="/tag/apache%20software%20foundation">apache software foundation</a></span>&nbsp;(25)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/articles">articles</a></span>&nbsp;(5)
                              
                              <span style="font-size: 11.5pt"><a href="/tag/aws">aws</a></span>&nbsp;(3)
                              
                              <span style="font-size: 13.5pt"><a href="/tag/c%2B%2B">c++</a></span>&nbsp;(7)
                              
                              <span style="font-size: 14.0pt"><a href="/tag/cylc">cylc</a></span>&nbsp;(8)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/docker">docker</a></span>&nbsp;(5)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/events">events</a></span>&nbsp;(5)
                              
                              <span style="font-size: 11.5pt"><a href="/tag/functional%20programming">functional programming</a></span>&nbsp;(3)
                              
                              <span style="font-size: 16.5pt"><a href="/tag/illustrations">illustrations</a></span>&nbsp;(13)
                              
                              <span style="font-size: 27.5pt"><a href="/tag/java">java</a></span>&nbsp;(35)
                              
                              <span style="font-size: 13.0pt"><a href="/tag/jena">jena</a></span>&nbsp;(6)
                              
                              <span style="font-size: 23.0pt"><a href="/tag/jenkins">jenkins</a></span>&nbsp;(26)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/krita">krita</a></span>&nbsp;(5)
                              
                              <span style="font-size: 12.0pt"><a href="/tag/natural%20language%20processing">natural language processing</a></span>&nbsp;(4)
                              
                              <span style="font-size: 29.5pt"><a href="/tag/opensource">opensource</a></span>&nbsp;(39)
                              
                              <span style="font-size: 26.5pt"><a href="/tag/programming">programming</a></span>&nbsp;(33)
                              
                              <span style="font-size: 18.0pt"><a href="/tag/python">python</a></span>&nbsp;(16)
                              
                              <span style="font-size: 11.5pt"><a href="/tag/r">r</a></span>&nbsp;(3)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/security">security</a></span>&nbsp;(5)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/shell%20script">shell script</a></span>&nbsp;(5)
                              
                              <span style="font-size: 24.5pt"><a href="/tag/software%20quality">software quality</a></span>&nbsp;(29)
                              
                              <span style="font-size: 12.0pt"><a href="/tag/sparql">sparql</a></span>&nbsp;(4)
                              
                              <span style="font-size: 13.5pt"><a href="/tag/test%20anything%20protocol">test anything protocol</a></span>&nbsp;(7)
                              
                              <span style="font-size: 16.5pt"><a href="/tag/testlink">testlink</a></span>&nbsp;(13)
                              
                            </nav>
                            
                        </div>
                    </div>
                
                    
                    <div class='ui padded container'>
                        <h1 class='topic'>Home</h1>
                    </div>
                    
                    
                    <div class="ui raised padded container segment">
                        <h2>
                            <a href="/2018/04/28/learning-more-about-sparql-and-jena-internals" title="Permanent link">Learning more about SPARQL and Jena internals</a>
                        </h2>
                        <small>kinow</small> @ <small>Apr 28, 2018&nbsp;18:20:28 (<span class='stardate' data-input-date='Apr 28, 2018'></span>)</small>
                        <div class="entry">
                            





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2018/04/28/learning-more-about-sparql-and-jena-internals" data-text="Learning more about SPARQL and Jena internals" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                            
                            <p style='text-align: center;'>
<a href="https://kinow.deviantart.com/art/O-Corvo-742473382"><img style="display: inline; width: 600px;" class="ui image" src="/2018/04/28/learning-more-about-sparql-and-jena-internals/ocorvo.jpg" alt="O Corvo" /></a>
<br/>
<small><a href="https://kinow.deviantart.com/art/O-Corvo-742473382">O Corvo</a></small>
</p>

<p>Recently a <a href="https://github.com/apache/jena/pull/114/">pull request</a> for Apache Jena
that I started three years ago got merged. Even though it has been three years since
that pull request, there are still many parts of the project code base that I am
not familiar with.</p>
<p>And not only the code, but there are also many concepts about SPARQL, other standards
used in Jena, and internals about triple stores.</p>
<p>The following list contains some presentations and posts that I am reading right now,
while I try to improve my knowledge of SPARQL and Jena internals.</p>
<ul>
<li><a href="https://www.slideshare.net/olafhartig/the-semantics-of-sparql">The Semantics of SPARQL</a><ul>
<li>Slides with information from Query parsing to Algebra and evaluating the Query</li>
</ul>
</li>
<li><a href="https://wiki.blazegraph.com/wiki/index.php/SPARQL_Order_Matters">SPARQL Order Matters</a><ul>
<li>Short but great post from Blazegraph about order in SPARQL queries with JOIN&#8217;s
and LEFT JOIN&#8217;s</li>
</ul>
</li>
<li><a href="https://gregheartsfield.com/2012/08/26/jena-arq-query-performance.html">Jena ARQ Query Performance</a><ul>
<li>Old post, but still very useful. Related to the post above, as it also talks about
query performances due to the order of statements</li>
</ul>
</li>
<li><a href="http://oracle.readthedocs.io/en/latest/sql/indexes/predicates-lhs-vs-rhs.html">Predicates: LHS vs RHS</a><ul>
<li>Oracle post for SQL, but this part applies to SPARQL, at least terminology-wise. LHS
and RHS appear in <a href="https://issues.apache.org/jira/browse/JENA-1534">some SPARQL related tickets</a>
/documentation too</li>
</ul>
</li>
</ul>
                            
                            
                            
                        </div>
                        <p class="postmetadata">
                            
                            <small>tags 
                             [&nbsp;<a
                                href="/tag/jena/"
                                rel="tag">jena</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/apache%20software%20foundation/"
                                rel="tag">apache software foundation</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/java/"
                                rel="tag">java</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/sparql/"
                                rel="tag">sparql</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/opensource/"
                                rel="tag">opensource</a>&nbsp;]&nbsp;
                            
                            </small>
                            
                            
                        </p>
                    </div>
                    
                    <div class="ui raised padded container segment">
                        <h2>
                            <a href="/2018/02/03/r-shiny-plus-ansible-equals-shinynzossorgnz" title="Permanent link">R Shiny + Ansible = shiny.nzoss.org.nz</a>
                        </h2>
                        <small>kinow</small> @ <small>Feb 03, 2018&nbsp;17:23:03 (<span class='stardate' data-input-date='Feb 03, 2018'></span>)</small>
                        <div class="entry">
                            





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2018/02/03/r-shiny-plus-ansible-equals-shinynzossorgnz" data-text="R Shiny + Ansible = shiny.nzoss.org.nz" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                            
                            <p><strong>R Shiny + Ansible = shiny.nzoss.org.nz</strong></p>
<div class='row'>
<div class="ui embed">
<iframe src="https://kinow.github.io/auckland-r-meetup-shiny-talk/" frameborder="0" allowfullscreen></iframe>
</div>
</div>

<dl>
<dt>Event</dt>
<dd><a href="https://www.meetup.com/Auckland-R-Users-Group-AKLRUG/events/247400612/">R Shiny + Ansible = shiny.nzoss.org.nz</a></dd>
<dt>Where ?</dt>
<dd><a href="https://www.google.com/maps/search/?api=1&query=38+Princes+Street%2C+The+University+of+Auckland%2C+Auckland%2C+nz">Auckland, New Zealand</a></dd>
<dt>When ?</dt>
<dd>2018-02-08</dd>
</dl>
                            
                            
                            
                        </div>
                        <p class="postmetadata">
                            
                            <small>tags 
                             [&nbsp;<a
                                href="/tag/r%20shiny/"
                                rel="tag">r shiny</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/r/"
                                rel="tag">r</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/opensource/"
                                rel="tag">opensource</a>&nbsp;]&nbsp;
                            
                            </small>
                            
                            
                            <br/>
                            <small>posted in 
                            [&nbsp;<a
                                href="/presentations"
                                title="View all posts in presentations"
                                rel="category tag">presentations</a>&nbsp;]
                                &nbsp;category
                            </small>
                            
                        </p>
                    </div>
                    
                    <div class="ui raised padded container segment">
                        <h2>
                            <a href="/2017/12/25/exif-odd-offsets" title="Permanent link">Exif Odd Offsets</a>
                        </h2>
                        <small>kinow</small> @ <small>Dec 25, 2017&nbsp;21:43:33 (<span class='stardate' data-input-date='Dec 25, 2017'></span>)</small>
                        <div class="entry">
                            





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/12/25/exif-odd-offsets" data-text="Exif Odd Offsets" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                            
                            <p>A file format like JPEG may contain metadata in JFIF, <a href="https://en.wikipedia.org/wiki/Exif">Exif</a>,
or a vendor proprietary format. The Exif format is based - or uses parts of - on the TIFF format.</p>
<p>Within an Exif metadata block, you should see directories, with several entries. The entries have fields
like description, value, and also an offset. The offset indicates the offset to the next entry.</p>
<p>The Exif specification defines that <strong>implementers must make sure to keep the offset an even number,
within 4 bytes</strong>.</p>
<p>I recently worked on <a href="https://issues.apache.org/jira/browse/IMAGING-205">IMAGING-205</a>, a ticket
about odd offsets in files with Exif metadata. This issue was exactly to address that when files
were rewritten with Apache Commons Imaging, even though the image initially had no odd offsets,
after the entries were rearranged, we could have odd offsets.</p>
<p>The fix was simply checking for odd offsets, adding +1, and later it would be put within the
4 bytes limit.</p>
<p style='text-align: center;'>
<img style="display: inline" class="ui image" src="/2017/12/25/exif-odd-offsets/screenshot.png" alt="A screen shot of Eclipse with source code" title="Locating the bug" />
<br/>
<small>Locating the bug</small>
</p>

<p>One interesting point, however, is that this is in the standard, but not all software that read
and write Exif follow the specification. So it is quite common to find images with odd offsets.</p>
<p>Which means you could take a picture with your phone, that contains some Exif metadata, and
be surprised to analyze it with <code>exiftool</code> and get warnings about odd offsets. Most viewers
handle odd and even offsets, so it should work for most cases, unless you have a strict reader/viewer.</p>
<p>Happy hacking!</p>
<p>&heart; Open Source</p>
                            
                            
                            
                        </div>
                        <p class="postmetadata">
                            
                            <small>tags 
                             [&nbsp;<a
                                href="/tag/programming/"
                                rel="tag">programming</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/java/"
                                rel="tag">java</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/apache%20software%20foundation/"
                                rel="tag">apache software foundation</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/opensource/"
                                rel="tag">opensource</a>&nbsp;]&nbsp;
                            
                            </small>
                            
                            
                        </p>
                    </div>
                    
                    <div class="ui raised padded container segment">
                        <h2>
                            <a href="/2017/12/03/remember-to-synchronize-when-iterating-streams-from-a-synchronized-collection" title="Permanent link">Remember to synchronize when iterating streams from a synchronized Collection</a>
                        </h2>
                        <small>kinow</small> @ <small>Dec 03, 2017&nbsp;23:56:13 (<span class='stardate' data-input-date='Dec 03, 2017'></span>)</small>
                        <div class="entry">
                            





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/12/03/remember-to-synchronize-when-iterating-streams-from-a-synchronized-collection" data-text="Remember to synchronize when iterating streams from a synchronized Collection" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                            
                            <p>When iterating collections created via <code>Collections.synchronizedList</code> for instance, you are required
to obtain a lock on the actual list before doing so. So you normally end up with code similar to:</p>
<div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">list</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">synchronizedList</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">());</span>
<span class="kd">synchronized</span> <span class="o">(</span><span class="n">list</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">Iterator</span> <span class="n">i</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="c1">// Must be in synchronized block</span>
  <span class="k">while</span> <span class="o">(</span><span class="n">i</span><span class="o">.</span><span class="na">hasNext</span><span class="o">())</span>
      <span class="n">foo</span><span class="o">(</span><span class="n">i</span><span class="o">.</span><span class="na">next</span><span class="o">());</span>
<span class="o">}</span>
</pre></div>

<p>This requirement is <a href="https://docs.oracle.com/javase/9/docs/api/java/util/Collections.html#synchronizedList-java.util.List-">documented in the javadocs</a>.</p>
<p>Since lambdas and streams are being more widely used, it is important to remind
that when iterating via a stream we also need to obtain a lock on the synchronized
collection created.</p>
<div class="highlight"><pre><span></span><span class="n">List</span> <span class="n">list</span> <span class="o">=</span> <span class="n">Collections</span><span class="o">.</span><span class="na">synchronizedList</span><span class="o">(</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">());</span>
<span class="kd">synchronized</span> <span class="o">(</span><span class="n">list</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">list</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
    <span class="o">.</span><span class="na">anyMatch</span><span class="o">(...)</span>
<span class="o">}</span>
</pre></div>

<p>Here&#8217;s an <a href="https://github.com/zalando/nakadi/pull/786">example from Zalando Nakadi Event Broker</a>.</p>
<p>Happy hacking!</p>
                            
                            
                            
                        </div>
                        <p class="postmetadata">
                            
                            <small>tags 
                             [&nbsp;<a
                                href="/tag/programming/"
                                rel="tag">programming</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/java/"
                                rel="tag">java</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/opensource/"
                                rel="tag">opensource</a>&nbsp;]&nbsp;
                            
                            </small>
                            
                            
                        </p>
                    </div>
                    
                    <div class="ui raised padded container segment">
                        <h2>
                            <a href="/2017/12/02/watch-out-for-locales-when-using-number-format-with-currencies" title="Permanent link">Watch out for Locales when using NumberFormat with currencies</a>
                        </h2>
                        <small>kinow</small> @ <small>Dec 02, 2017&nbsp;22:51:00 (<span class='stardate' data-input-date='Dec 02, 2017'></span>)</small>
                        <div class="entry">
                            





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/12/02/watch-out-for-locales-when-using-number-format-with-currencies" data-text="Watch out for Locales when using NumberFormat with currencies" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                            
                            <p>In Java you have the <a href="https://docs.oracle.com/javase/9/docs/api/java/text/NumberFormat.html">NumberFormatException</a>
to help you formatting and parsing numbers for any locale. Said that, here&#8217;s some code.</p>
<div class="highlight"><pre><span></span>BigDecimal <span class="nv">negative</span> <span class="o">=</span> new BigDecimal<span class="o">(</span><span class="s2">&quot;-1234.56&quot;</span><span class="o">)</span><span class="p">;</span>

DecimalFormat <span class="nv">nf</span> <span class="o">=</span> <span class="o">(</span>DecimalFormat<span class="o">)</span> NumberFormat.getCurrencyInstance<span class="o">(</span>Locale.UK<span class="o">)</span><span class="p">;</span>
String <span class="nv">formattedNegative</span> <span class="o">=</span> nf.format<span class="o">(</span>negative<span class="o">)</span><span class="p">;</span>

System.out.println<span class="o">(</span>formattedNegative<span class="o">)</span><span class="p">;</span>
</pre></div>

<p>The output for this code is <strong>-£1,234.56</strong>. That&#8217;s expected, as the locale is set to
UK, so the currency symbol used is for British Pounds. And as the number is negative, you
get that minus sign as a prefix. For Japanese locale you&#8217;d get <strong>-￥1,235</strong>, and for Brazilian
locale you&#8217;d get <strong>-R$ 1.234,56</strong>.</p>
<p>So far so good. </p>
<p>What about the following code, with nothing different except for the locale set to <strong>US</strong>.</p>
<div class="highlight"><pre><span></span>BigDecimal <span class="nv">negative</span> <span class="o">=</span> new BigDecimal<span class="o">(</span><span class="s2">&quot;-1234.56&quot;</span><span class="o">)</span><span class="p">;</span>

DecimalFormat <span class="nv">nf</span> <span class="o">=</span> <span class="o">(</span>DecimalFormat<span class="o">)</span> NumberFormat.getCurrencyInstance<span class="o">(</span>Locale.US<span class="o">)</span><span class="p">;</span> // &lt;--- US now
String <span class="nv">formattedNegative</span> <span class="o">=</span> nf.format<span class="o">(</span>negative<span class="o">)</span><span class="p">;</span>

System.out.println<span class="o">(</span>formattedNegative<span class="o">)</span><span class="p">;</span>
</pre></div>

<p>Some could intuitively expect <strong>-$1,234.56</strong>. However, <strong>the output is actually ($1,234.56)</strong>.</p>
<p>There are different prefixes and suffixes. But in some locales the prefix can be empty, or, as
in the case of the US locale, it can be quite different than what you could expect.</p>
<p>Learned about this peculiarity from NumberFormat while working on <a href="https://issues.apache.org/jira/browse/VALIDATOR-433">VALIDATOR-433</a> for Apache Commons Validator.</p>
<p>Happy hacking!</p>
                            
                            
                            
                        </div>
                        <p class="postmetadata">
                            
                            <small>tags 
                             [&nbsp;<a
                                href="/tag/programming/"
                                rel="tag">programming</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/java/"
                                rel="tag">java</a>&nbsp;]&nbsp;
                            
                             [&nbsp;<a
                                href="/tag/apache%20software%20foundation/"
                                rel="tag">apache software foundation</a>&nbsp;]&nbsp;
                            
                            </small>
                            
                            
                        </p>
                    </div>
                    
                    
                    <div class="ui pagination menu">
                        
                        <a class="item" href="/5"><i class='left arrow icon'></i> Previous Posts</a>
                        
                        
                        <a class="item" href="/3"><i class='right arrow icon'></i> Next Posts</a>
                        
                    </div>
                    
                
               </div>
            </div>
        </div>
        <div class="ui vertical footer segment">
            <div class="ui center aligned container">
                           <div id="copy" class="">
                <p>&copy; <a href="/about"><span
                            class="b">Bru</span><span
                            class="r">no de</span> <span
                            class="a">Paula</span> <span
                            class="s"></span><span
                            class="i">Kinos</span><span
                            class="l">hita</span></a>
                </p>
            </div>
            </div>
         </div>
    </div>
</body>
</html>
<script src="/js/jquery-2.2.3.min.js"  type="text/javascript"></script>
<script src="/css/semantic/dist/semantic.min.js"  type="text/javascript"></script>
<script src="/js/jquery.prettyPhoto.js"></script>
<script src="/js/site.js"></script>