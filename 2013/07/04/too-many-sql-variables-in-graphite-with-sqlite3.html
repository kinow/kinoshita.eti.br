<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1" /><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Too many SQL variables exception in Graphite with SQLite3 | kinow</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Too many SQL variables exception in Graphite with SQLite3" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Having run Graphite for a while, today I found a rather annoying issue. We were using events, and everything was working perfectly fine so far. But for the 24 last hours, the graph was blank. Actually, in the dashboard, the graph was missing, being displayed as a gray box. Enabling the web inspector in Google Chrome I got the graph URL. Opening the link in a new tab gave me the exception message: too many SQL variables (1). After some research, I found out this was a bug in SQLite. After trying to hack the code, and being concerned about using a patched version of Graphite and having to update it later, I decided to switch database. But to avoid losing the graphs, users and other settings, including the events, I migrated the SQLite database to a MySQL server. This MySQL server was already installed in the server machine, since this machine hosted a Zabbix server too. Here are the steps required to migrate your database from SQLite to MySQL (2). Download sqlite3_mysql python script from http://www.redmine.org/boards/2/topics/12793 Stop Apache/Nginx mysql -u user -p -e “create database redmine graphite set utf8;” sqlite3 graphite.db .dump sqlite3-to-mysql.py mysql -uroot -pyourpass graphite Start Apache again After tail’ing the Graphite webapp log file, tail f- storage/log/webapp/error.log I noticed the Python MySQLdb wasn’t installed. ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb My server was an Ubuntu 13.04, so I installed the module simply with the following command. apt-get install python-mysqldb Hope that helps! 1 You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser 2 Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too" />
<meta property="og:description" content="Having run Graphite for a while, today I found a rather annoying issue. We were using events, and everything was working perfectly fine so far. But for the 24 last hours, the graph was blank. Actually, in the dashboard, the graph was missing, being displayed as a gray box. Enabling the web inspector in Google Chrome I got the graph URL. Opening the link in a new tab gave me the exception message: too many SQL variables (1). After some research, I found out this was a bug in SQLite. After trying to hack the code, and being concerned about using a patched version of Graphite and having to update it later, I decided to switch database. But to avoid losing the graphs, users and other settings, including the events, I migrated the SQLite database to a MySQL server. This MySQL server was already installed in the server machine, since this machine hosted a Zabbix server too. Here are the steps required to migrate your database from SQLite to MySQL (2). Download sqlite3_mysql python script from http://www.redmine.org/boards/2/topics/12793 Stop Apache/Nginx mysql -u user -p -e “create database redmine graphite set utf8;” sqlite3 graphite.db .dump sqlite3-to-mysql.py mysql -uroot -pyourpass graphite Start Apache again After tail’ing the Graphite webapp log file, tail f- storage/log/webapp/error.log I noticed the Python MySQLdb wasn’t installed. ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb My server was an Ubuntu 13.04, so I installed the module simply with the following command. apt-get install python-mysqldb Hope that helps! 1 You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser 2 Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too" />
<link rel="canonical" href="https://kinoshita.eti.br/2013/07/04/too-many-sql-variables-in-graphite-with-sqlite3.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2013/07/04/too-many-sql-variables-in-graphite-with-sqlite3.html" />
<meta property="og:site_name" content="kinow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-07-04T00:00:00+12:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Too many SQL variables exception in Graphite with SQLite3" />
<script type="application/ld+json">
{"description":"Having run Graphite for a while, today I found a rather annoying issue. We were using events, and everything was working perfectly fine so far. But for the 24 last hours, the graph was blank. Actually, in the dashboard, the graph was missing, being displayed as a gray box. Enabling the web inspector in Google Chrome I got the graph URL. Opening the link in a new tab gave me the exception message: too many SQL variables (1). After some research, I found out this was a bug in SQLite. After trying to hack the code, and being concerned about using a patched version of Graphite and having to update it later, I decided to switch database. But to avoid losing the graphs, users and other settings, including the events, I migrated the SQLite database to a MySQL server. This MySQL server was already installed in the server machine, since this machine hosted a Zabbix server too. Here are the steps required to migrate your database from SQLite to MySQL (2). Download sqlite3_mysql python script from http://www.redmine.org/boards/2/topics/12793 Stop Apache/Nginx mysql -u user -p -e “create database redmine graphite set utf8;” sqlite3 graphite.db .dump sqlite3-to-mysql.py mysql -uroot -pyourpass graphite Start Apache again After tail’ing the Graphite webapp log file, tail f- storage/log/webapp/error.log I noticed the Python MySQLdb wasn’t installed. ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb My server was an Ubuntu 13.04, so I installed the module simply with the following command. apt-get install python-mysqldb Hope that helps! 1 You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser 2 Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too","@type":"BlogPosting","headline":"Too many SQL variables exception in Graphite with SQLite3","url":"https://kinoshita.eti.br/2013/07/04/too-many-sql-variables-in-graphite-with-sqlite3.html","dateModified":"2013-07-04T00:00:00+12:00","datePublished":"2013-07-04T00:00:00+12:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2013/07/04/too-many-sql-variables-in-graphite-with-sqlite3.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css" /><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="kinow" /><link href="https://unpkg.com/pattern.css" rel="stylesheet" />

</head>
<body>
<div id="mobile-menu"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" />
      </a>
    </li>
  </ul>
</div>
</div>
<div id="wrapper">
  <div id="sidebar"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" />
      </a>
    </li>
  </ul>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Too many SQL variables exception in Graphite with SQLite3</h1>
    <span class="post-meta">
      <time class="dt-published" datetime="2013-07-04T00:00:00+12:00" itemprop="datePublished">Jul 4, 2013
      </time>
      <span>&mdash; star date: -309410.96.</span>
      <span>
        Number of words: 329.
      </span></span>
  </header>

  


  <div class="post-content e-content" itemprop="articleBody">
    <p>Having run <a href="http://graphite.wikidot.com/">Graphite</a> for a while, today I found a rather annoying issue. We were using 
<a href="https://code.launchpad.net/~lucio.torre/graphite/add-events/+merge/69142">events</a>, and everything was working perfectly fine so far. But for the 24 last hours, 
the graph was blank.</p>

<p>Actually, in the dashboard, the graph was <em>missing</em>, being displayed as a gray box. 
Enabling the web inspector in Google Chrome I got the graph URL. Opening the link in 
a new tab gave me the exception message: <strong>too many SQL variables</strong> (<sup>1</sup>).</p>

<p>After some research, I found out this was a bug in SQLite. After trying to hack the code, 
and being concerned about using a patched version of Graphite and having to update it 
later, I decided to switch database.</p>

<p>But to avoid losing the graphs, users and other settings, including the events, I 
migrated the SQLite database to a MySQL server. This MySQL server was already installed in 
the server machine, since this machine hosted a <a href="http://www.zabbix.com/">Zabbix</a> server too.</p>

<p>Here are the steps required to migrate your database from SQLite to MySQL (<sup>2</sup>).</p>

<ul>
  <li>Download <strong>sqlite3_mysql</strong> python script from <a href="http://www.redmine.org/boards/2/topics/12793">http://www.redmine.org/boards/2/topics/12793</a></li>
  <li>Stop Apache/Nginx</li>
  <li>mysql -u user -p -e “create database redmine graphite set utf8;”</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>sqlite3 graphite.db .dump</td>
          <td>sqlite3-to-mysql.py</td>
          <td>mysql -uroot -pyourpass graphite</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Start Apache again</li>
</ul>

<p>After tail’ing the Graphite webapp log file,</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tail </span>f- storage/log/webapp/error.log
</code></pre></div></div>

<p>I noticed the Python MySQLdb wasn’t installed.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ImproperlyConfigured</span><span class="p">:</span> <span class="n">Error</span> <span class="n">loading</span> <span class="n">MySQLdb</span> <span class="n">module</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">MySQLdb</span>
</code></pre></div></div>

<p>My server was an Ubuntu 13.04, so I installed the module simply with the following 
command.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>apt-get <span class="nb">install </span>python-mysqldb
</code></pre></div></div>

<p>Hope that helps!</p>

<p><small><sup>1</sup> You may have to enable *DEBUG* in your Django settings for seeing the exception in your browser</small></p>
<p><small><sup>2</sup> Zabbix needed some minor tweaks in order to use [MariaDB](https://mariadb.org/), but probably you can give it a try too</small></p>

  </div>

  <div class="tags"><p>Tags:&nbsp;<a class="label" href="/tag/monitoring">monitoring</a>,&nbsp;<a class="label" href="/tag/python">python</a>.<br/></p></div>

  <a class="u-url" href="/2013/07/04/too-many-sql-variables-in-graphite-with-sqlite3.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
