<!doctype html><html lang=en><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.e392e97e7e5991e363403c494b51d829efa207842d755622976c2537d0509be0.css integrity="sha256-45Lpfn5ZkeNjQDxJS1HYKe+iB4QtdVYil2wlN9BQm+A=">
<title>kinow | Testing shell code and producing TAP using Jenkins?</title>
</head>
<body><header role=banner class=content>
<nav id=nav aria-label=Main role=navigation class=content>
<ul><li>
<a href=/>
<i data-feather=about></i> About</a>
</li><li>
<a href=/blog/>
<i data-feather=blog></i> Blog</a>
</li><li>
<a href=/portfolio/>
<i data-feather=portfolio></i> Portfolio</a>
</li><li></li>
</ul>
</nav>
</header>
<main>
<article class=content>
<h2>Testing shell code and producing TAP using Jenkins?</h2><div class=metadata>
<i data-feather=calendar></i>
<time datetime=2011-12-30>Dec 30, 2011</time>
</div>
<p>Definitely reading <a title="Hacker News" href=http://news.ycombinator.com/>Hacker News</a> before going to bed is a bad idea :-) Same goes for <a title=Reddit href=http://www.reddit.com>Reddit</a>. So, I found a link about <a title=Bats href=https://github.com/sstephenson/bats>Bats</a>, a tool to execute tests in Shell and output <a title="Test Anything Protocol" href=http://testanything.org>TAP</a> - Test Anything Protocol. Then I thought; why not ask the author to include Bats under the list of <a title="TAP Producers" href=http://testanything.org/wiki/index.php/TAP_Producers#SH_.2F_Shell_Script>Producers</a> in <a title="Test Anything Protocol" href=http://testanything.org>testanything.org</a>?</p>
<p>But you know what? Why not execute execute locally first to check if that&rsquo;s working&mldr; moreover, why not use <a title="Jenkins TAP Plug-in" href=https://wiki.jenkins-ci.org/display/JENKINS/TAP+Plugin>Jenkins TAP Plug-in</a> and see what happens?</p>
<p>Here&rsquo;s what is necessary.</p>
<ul>
<li><a title="Jenkins CI" href=http://www.jenkins-ci.org>Jenkins</a> (duh)</li>
<li><a title="Jenkins TAP Plug-in" href=https://wiki.jenkins-ci.org/display/JENKINS/TAP+Plugin>tap plug-in</a></li>
<li><a title="Jenkins Git Plugin" href=https://wiki.jenkins-ci.org/display/JENKINS/git+Plugin>git plug-in</a></li>
<li><a title="Bast git repository" href=https://github.com/sstephenson/bats>Bats git repository URL</a></li>
<li><a title="Baden Baden" href=http://www.badenbaden.com.br/>Baden Baden Red Ale beer</a> (it's Friday, almost new years' eve, c'mon)</li>
</ul>
Install Jenkins, tap plug-in and git plug-in. Create a new free style build. Add Bats git repository url under SCM. This way Jenkins will retrieve Bats code from Github (you don't need to install it if you don't want to). Add a build step which executes the following shell code: <tt>./bin/bats test/bats.bats > test.t</tt>
<figure class=feature>
<img src=/assets/posts/2011-12-30-testing-shell-code-and-producing-tap-using-jenkins/Screenshot_at_2011_12_30_233256.png alt title width height>
<figcaption></figcaption>
</figure>
<p>Before executing the build, you have to check the option to publish TAP results in the end of the configuration screen. That&rsquo;s it. Execute your job, chug the remaining of your beer and now you can go to bed&mldr; or just refresh Hacker News and Reddit once more&mldr;</p>
<figure class=feature>
<img src=/assets/posts/2011-12-30-testing-shell-code-and-producing-tap-using-jenkins/Screenshot_at_2011_12_30_233313.png alt title width height>
<figcaption></figcaption>
</figure>
<figure class=feature>
<img src=/assets/posts/2011-12-30-testing-shell-code-and-producing-tap-using-jenkins/Screenshot_at_2011_12_30_233323.png alt title width height>
<figcaption></figcaption>
</figure>
<p>Bats is a very nice TAP producer for Shell. Haven&rsquo;t had time to play with the other producers for Shell, or explore Bats thoroughly, but it looks very promising. Hope to see more people writing tests for shell code.</p>
<p>Cheers -B</p>
<aside class=links>
<a class=previous href=https://kinoshita.eti.br/2011/12/24/listing-of-current-projects-achievements-and-my-new-years-resolutions.html>&#171; Previous</a>
<a class=next href=https://kinoshita.eti.br/2012/01/22/ranges-in-apache-commons-functor.html>Next &#187;</a>
</aside>
</article>
</main>
<footer role=contentinfo>
<ul id=social-media-icons>
<li>
<a href=https://www.instagram.com/brunokinoshita/>
<img src=/assets/icons/instagram.png alt="Instagram link">
</a>
</li>
<li>
<a href=https://twitter.com/kinow/>
<img src=/assets/icons/twitter.png alt="Twitter link">
</a>
</li>
<li>
<a href=https://github.com/kinow/>
<img src=/assets/icons/github.png alt="GitHub link">
</a>
</li>
</ul>
</footer>
</body>
</html>