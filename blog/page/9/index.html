<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Page 9 of 31 for Blog - page 9 | Bruno P. Kinoshita</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Blog - page 9" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Bruno P. Kinoshita personal home page" />
<meta property="og:description" content="Bruno P. Kinoshita personal home page" />
<link rel="canonical" href="https://kinoshita.eti.br/blog/page/9/" />
<meta property="og:url" content="https://kinoshita.eti.br/blog/page/9/" />
<meta property="og:site_name" content="Bruno P. Kinoshita" />
<link rel="prev" href="https://kinoshita.eti.br/blog/page/8/" />
<link rel="next" href="https://kinoshita.eti.br/blog/page/10/" />
<script type="application/ld+json">
{"headline":"Blog - page 9","description":"Bruno P. Kinoshita personal home page","@type":"WebPage","url":"https://kinoshita.eti.br/blog/page/9/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="Bruno P. Kinoshita" /></head>
<body>
<div id="wrapper">
  <div id="sidebar"><div id="menu">
  <ul class="menu">
    <li class="item">
      <a href="/" aria-label="Home page link">
        <svg id="svg8" version="1.1" viewBox="0 0 58.208 9.2604" xmlns="http://www.w3.org/2000/svg" role="img"
             aria-labelledby="svg-logo-title svg-logo-desc">
          <title id="svg-logo-title">KINOSHITA image</title>
          <desc id="svg-logo-desc">A logo with the word KINOSHITA</desc>
          <g id="layer1" transform="translate(0 -287.74)">
            <g id="text817" transform="translate(-2.4568 -.23624)">
              <g id="logo" transform="matrix(2.6585 0 0 2.5911 -63.587 100.56)" fill="#000000" stroke-width=".26458px">
                <path role="presentation" id="path819"
                      d="m25.178 72.637h0.54187v2.9633h-0.54187zm0.5842 1.397 1.0964-1.397h0.635l-1.1049 1.397 1.1049 1.5663h-0.635z"/>
                <path role="presentation" id="path821" d="m27.832 72.637h0.54187v2.9633h-0.54187z"/>
                <path role="presentation" id="path823"
                      d="m29.023 72.637h0.5334l1.2658 1.9135v-1.9135h0.54187v2.9633h-0.4445l-1.3547-2.032v2.032h-0.54187z"/>
                <path role="presentation" id="path825"
                      d="m33.298 75.66q-0.4191 0-0.75353-0.1905-0.3302-0.19473-0.5207-0.54187-0.18627-0.35137-0.18627-0.80857t0.18627-0.80433q0.1905-0.35137 0.5207-0.54187 0.33443-0.19473 0.75353-0.19473t0.7493 0.19473q0.33443 0.1905 0.5207 0.54187 0.1905 0.34713 0.1905 0.80433t-0.1905 0.80857q-0.18627 0.34713-0.5207 0.54187-0.3302 0.1905-0.7493 0.1905zm0-0.52493q0.4318 0 0.6604-0.2794 0.23283-0.2794 0.23283-0.7366t-0.23283-0.7366q-0.2286-0.2794-0.6604-0.2794t-0.66463 0.2794q-0.2286 0.2794-0.2286 0.7366t0.2286 0.7366q0.23283 0.2794 0.66463 0.2794z"/>
                <path role="presentation" id="path827"
                      d="m36.091 75.66q-0.24977 0-0.53763-0.06773-0.28363-0.06773-0.4445-0.14817l0.0635-0.57573q0.5588 0.27093 0.98213 0.27093 0.22437 0 0.35137-0.08467 0.127-0.0889 0.127-0.25823 0-0.127-0.07197-0.20743-0.06773-0.08467-0.19897-0.1397-0.13123-0.05927-0.4191-0.16087-0.27093-0.09313-0.44873-0.19473-0.1778-0.10583-0.28363-0.2667-0.1016-0.1651-0.1016-0.40217 0-0.381 0.2794-0.61383t0.8001-0.23283q0.24553 0 0.48683 0.05503 0.24553 0.05503 0.44873 0.13547l-0.05503 0.55457q-0.26247-0.1143-0.4826-0.16933-0.2159-0.05927-0.4318-0.05927-0.2413 0-0.3683 0.08043t-0.127 0.23283q0 0.11853 0.06773 0.19473t0.18203 0.127q0.11853 0.0508 0.34713 0.12277 0.51223 0.16087 0.74507 0.37253 0.23707 0.20743 0.23707 0.5715 0 0.34713-0.2413 0.60537t-0.90593 0.25823z"/>
                <path role="presentation" id="path829"
                      d="m37.688 72.637h0.54187v1.1726h1.3547v-1.1726h0.54187v2.9633h-0.54187v-1.2827h-1.3547v1.2827h-0.54187z"/>
                <path role="presentation" id="path831" d="m40.78 72.637h0.54187v2.9633h-0.54187z"/>
                <path role="presentation" id="path833"
                      d="m42.546 73.162h-0.8382v-0.52493h2.2183v0.52493h-0.8382v2.4384h-0.54187z"/>
                <path role="presentation" id="path835"
                      d="m45.632 74.898h-1.0795l-0.24553 0.70273h-0.52493l1.0541-2.9633h0.51223l1.0541 2.9633h-0.52493zm-0.16933-0.47413-0.3683-1.0583-0.37253 1.0583z"/>
              </g>
            </g>
          </g>
        </svg>
      </a>
    </li>
    <li class="item">
      <a href="/blog/" class="">Blog</a>
      <ul>
        <li class="item">
          <a href="/blog/drawing/">Drawing</a>
        </li>
        <li class="item">
          <a href="/blog/languages/">Languages</a>
        </li>
        <li class="item">
          <a href="/blog/music/">Music</a>
        </li>
        <li class="item">
          <a href="/blog/writing/">Writing</a>
        </li>
      </ul>
    </li>
    <li class="item">
      <a href="/art/" class="">Illustrations</a>
    </li>
    <li class="item">
      <a href="/maps/" class="">Maps</a>
    </li>
  </ul>
  <div id="menu-bottom">
    <p id="feed-subscribe">
      <a href="/feed.xml">
        <svg id="feed-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" width="128px" height="128px"
             viewBox="0 0 256 256">
          <circle cx="68" cy="189" r="24" fill="rgba(255, 255, 255, .2)"/>
          <path d="M160 213h-34a82 82 0 0 0 -82 -82v-34a116 116 0 0 1 116 116z" fill="rgba(255, 255, 255, .2)"/>
          <path d="M184 213A140 140 0 0 0 44 73 V 38a175 175 0 0 1 175 175z" fill="rgba(255, 255, 255, .2)"/>
        </svg>
      </a>
    </p>
  </div>
</div>
</div>
  <div id="content">
    <h1 class="page-heading">Blog - page 9</h1><div class="note"><p>Posts about technology.</p>
</div>

<div class="blog"><div class="post">
  <h3 class="post-header">
    <a class="post-link" href="/2017/07/21/scico-2017-an-introduction-to-the-international-image-interoperability-framework-iiif.html">
      SciCo 2017: An Introduction to the International Image Interoperability Framework (IIIF)
    </a>
  </h3><span class="post-meta">Jul 21, 2017<span>&mdash; star date: -305364.38</span></span><p><strong>An Introduction to the International Image Interoperability Framework (IIIF)</strong></p>

<div class="row">
<div class="ui embed">
<iframe src="https://kinow.github.io/scico-2017/" frameborder="0" allowfullscreen=""></iframe>
</div>
</div>

<dl>
<dt>Event</dt>
<dd><a href="http://nesi-cri.nz/">Science Coding Conference 2017</a></dd>
<dt>Where ?</dt>
<dd><a href="https://www.google.co.nz/maps/place/Wellington/@-41.244027,174.6217709,11z/data=!3m1!4b1!4m5!3m4!1s0x6d38b1fc49e974cb:0xa00ef63a213b470!8m2!3d-41.2864603!4d174.776236">Wellington, New Zealand</a></dd>
<dt>When ?</dt>
<dd>2017-08-04</dd>
</dl>
</div>
<div class="post">
  <h3 class="post-header">
    <a class="post-link" href="/2017/06/26/drawing-archer.html">
      Drawing Archer
    </a>
  </h3><span class="post-meta">Jun 26, 2017<span>&mdash; star date: -305435.62</span></span><p>Archer, from <a href="https://www.reddit.com/r/redditgetsdrawn/comments/4cwiyf/flinging_arrows_in_humid_louisiana_yesterday_my/">redditgetsdrawn</a>.</p>

<p><img style="height: 400px;" class="ui image" src="/assets/posts/2017-06-26-drawing-archer/archer1.png" alt="Archer drawing" /></p>

<p><img style="height: 400px;" class="ui image" src="/assets/posts/2017-06-26-drawing-archer/sBcgBwm6ZuoLOjHPf_tAS5kp6qRxUxhTpZUWj9tuADs.jpg" alt="Archer photo" /></p>

<p>Simplified and changed her angle. On <a href="http://kinow.deviantart.com/art/Archer1-688782846">DeviantArt</a> too.</p>
</div>
<div class="post">
  <h3 class="post-header">
    <a class="post-link" href="/2017/06/13/how-to-remove-the-signature-from-emails-with-nlp.html">
      How to remove the signature from e-mails with NLP?
    </a>
  </h3><span class="post-meta">Jun 13, 2017<span>&mdash; star date: -305471.23</span></span><p>Some time ago I stumbled across <a href="https://github.com/mynameisvinn/EmailParser">EmailParser</a>, a Python utility to remove e-mail signatures. Here’s a sample input e-mail from the project documentation.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Wendy – thanks for the intro! Moving you to bcc.
 
Hi Vincent – nice to meet you over email. Apologize for the late reply, I was on PTO for a couple weeks and this is my first week back in office. As Wendy mentioned, I am leading an AR/VR taskforce at Foobar Retail Solutions. The goal of the taskforce is to better understand how AR/VR can apply to retail/commerce and if/what is the role of a shopping center in AR/VR applications for retail.
 
Wendy mentioned that you would be a great person to speak to since you are close to what is going on in this space. Would love to set up some time to chat via phone next week. What does your availability look like on Monday or Wednesday?
 
Best,
Joe Smith
 
Joe Smith | Strategy &amp; Business Development
111 Market St. Suite 111| San Francisco, CA 94103
M: 111.111.1111| joe@foobar.com
</code></pre></div></div>

<p>And here’s what it looks like afterwards.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Wendy – thanks for the intro! Moving you to bcc.
 
Hi Vincent – nice to meet you over email. Apologize for the late reply, I was on PTO for a couple weeks and this is my first week back in office. As Wendy mentioned, I am leading an AR/VR taskforce at Foobar Retail Solutions. The goal of the taskforce is to better understand how AR/VR can apply to retail/commerce and if/what is the role of a shopping center in AR/VR applications for retail.
 
Wendy mentioned that you would be a great person to speak to since you are close to what is going on in this space. Would love to set up some time to chat via phone next week. What does your availability look like on Monday or Wednesday?
</code></pre></div></div>

<p>As you can see, it removed all the lines after the main part of the message (i.e. after the three paragraphs). Here’s what the Python code looks like.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">Parser</span> <span class="kn">import</span> <span class="n">read_email</span><span class="p">,</span> <span class="n">strip</span><span class="p">,</span> <span class="n">prob_block</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">spacy.en</span> <span class="kn">import</span> <span class="n">English</span> 

<span class="o">&gt;&gt;&gt;</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">English</span><span class="p">()</span>  <span class="c1"># part-of-speech tagger
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">msg_raw</span> <span class="o">=</span> <span class="n">read_email</span><span class="p">(</span><span class="s">'emails/test1.txt'</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">msg_stripped</span> <span class="o">=</span> <span class="n">strip</span><span class="p">(</span><span class="n">msg_raw</span><span class="p">)</span>  <span class="c1"># preprocessing text before POS tagging
</span>
<span class="c1"># iterate through lines, write to file if not signature block
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">generate_text</span><span class="p">(</span><span class="n">msg_stripped</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="n">pos_tagger</span><span class="p">,</span> <span class="s">'emails/test1_clean.txt'</span><span class="p">)</span> 
</code></pre></div></div>

<p>What got me interested about this utility was the use of NLP. I couldn’t imagine how someone could use NLP for that. And I liked the simplicity of the approach, which is not perfect, but can be useful someday.</p>

<p>After the imports in the code, it creates a <a href="https://en.wikipedia.org/wiki/Part_of_speech">Part of Speech</a> tagger using <a href="https://spacy.io/">spaCy</a> NLP library, reads the e-mail from a file, and sripts and creates an array with each paragraph of the message.</p>

<p>The magic happens in the <code class="language-plaintext highlighter-rouge">generate_text</code> function, which receives the <strong>array of paragraphs</strong>, a <strong>threshold</strong>, the <strong>POS tagger</strong>, and the <strong>output destination</strong>. Here’s what the function does.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>for each message
    if probability ( signature block | message ) &lt; threshold
        write to output file
</code></pre></div></div>

<p>And the formula for calculating the probability is quite simple too.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. For a given paragraph (message block), find all the sentences in it.
2. Then for each word (token) in the sentence, count the number of times a non-verb appears.
3. Return the proportion of non-verbs per sentence, i.e. number of non-verbs / number of sentences.
</code></pre></div></div>

<p>In summary, it discards blocks that do not contain enough verbs to be considered a message block, being treated as signature blocks instead.</p>

<p>Never thought about using an approach like this. It may definitely be helpful when doing data analysis, information retrieval, or scraping data from the web. Not necessarily with e-mails and signatures, but you got the gist of it.</p>

<p>♥ Open Source</p>
</div>
<div class="post">
  <h3 class="post-header">
    <a class="post-link" href="/2017/06/09/backward-compatibility-and-switch-statements-with-constant-expressions.html">
      Backward compatibility and switch statement with constant expressions
    </a>
  </h3><span class="post-meta">Jun 9, 2017<span>&mdash; star date: -305482.19</span></span><p>Maintaining Open Source software can be challenging. Making sure you keep backward compatibility (not only binary) can be even more challenging. <a href="https://commons.apache.org/proper/commons-lang/">Apache Commons Lang</a> 3.6 release is happening right now thanks to <a href="http://www.benediktritter.de/">Benedikt Ritter</a>, and it is on its fourth Release Candidate (i.e. RC4).</p>

<p>A previous RC2 was cancelled due to <a href="http://commons.markmail.org/thread/57sqt2hkusegda73#query:+page:1+mid:dnwo5tjqo2e5bwuo+state:results">IBM JDK 8 compatibility</a>, more specifically the lazy initialization of ArrayList’s seems to be different in Oracle JDK and IBM JDK.</p>

<p>The RC3 was cancelled due to a <a href="https://github.com/apache/commons-lang/commit/18e692478dcf91fdceb9b9fdca7c61a1111d63aa">change</a> that could affect users using a switch statement.</p>

<p>The change was in the <em>CharEncoding</em> class. The issue was that this class has some constants, that stopped being <a href="http://docs.oracle.com/javase/specs/jls/se8/html/jls-15.html#jls-15.28">constant expressions</a>.</p>

<blockquote>A constant expression is an expression denoting a value of primitive type or a String that does not complete abruptly and is composed using only the following (...)</blockquote>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CharEncoding</span> <span class="o">{</span>
    <span class="c1">// ...</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">ISO_8859_1</span> <span class="o">=</span> <span class="s">"ISO-8859-1"</span><span class="o">;</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The code above contains a constant (<em>static final</em>) variable, that is a constant expression. So users can safely use it in switch statements, and the Java compiler won’t complain about it.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CharEncoding</span> <span class="o">{</span>
    <span class="c1">// ...</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="nc">String</span> <span class="no">ISO_8859_1</span> <span class="o">=</span> <span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">ISO_8859_1</span><span class="o">.</span><span class="na">name</span><span class="o">();</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</code></pre></div></div>

<p>The code above is from the change that caused the regression. Any user that was using the ISO_8859_1 constant variable in a switch statement would get a compilation error (e.g. <em>case expressions must be constant expressions</em>) when updating to Apache Commons Lang 3.6. That is because the constant variable is not a constant expression.</p>

<p>I think I learned that some time ago, but if you asked me what was wrong with the change, and if it would break backward compatibility, I would probably fail to spot the issue. There are tools for that now (e.g. Clirr, japicmp) though they may miss some cases too.</p>

<p>Luckily in this case a user subscribed to the Apache Commons development mailing list spotted the issue and quickly reported it. It gets easier maintaining an Open Source project with the constructive feedback of users, like this one.</p>

<p>♥ Open Source</p>
</div>
<div class="post">
  <h3 class="post-header">
    <a class="post-link" href="/2017/06/03/securely-using-passwords-with-r.html">
      Securely using passwords with R
    </a>
  </h3><span class="post-meta">Jun 3, 2017<span>&mdash; star date: -305498.63</span></span><p>It is quite common to have code that needs to interact with another system, database, or third party application, and need to use some sort of credentials to securely communicate.</p>

<p>Most of the code I wrote in <strong>R</strong>, or reviewed, had normally no borders (from a system analysis perspective) with other systems, or basically just interacted with the file system to retrieve NetCDF or JSON files.</p>

<p>However, after I saw a comment in <em>Reddit</em> [1] some time ago about this, I decided to check what others used. With <strong>R Shiny</strong> becoming more popular, and moving more R code to the web, I think this will become a common requirement for R code.</p>

<p>There is a blog post from <strong>RevolutionAnalytics</strong> [2] that does a nice summary of the options for that. The post is from 2015, but I do not think much changed now in 2017. From the blog post and comments, there are seven methods listed:</p>

<ol>
  <li>Put <a href="https://github.com/ropensci/fishbaseapi/blob/80393023a958aee54e2daa58c337458db5480b84/config_template.yaml">credentials</a> in your source code</li>
  <li>Put credentials in a file in your project, but do not share this file (<em>#3</em>, <em>#4</em>, and <em>#5</em> are similar to this one)</li>
  <li>Put credentials in a <a href="https://csgillespie.github.io/efficientR/3-3-r-startup.html#rprofile">.Rprofile</a> file</li>
  <li><strong>Put credentials in a <a href="https://csgillespie.github.io/efficientR/3-3-r-startup.html#renviron">.Renviron</a> file</strong></li>
  <li>Put <a href="https://github.com/ropensci/fishbaseapi/blob/80393023a958aee54e2daa58c337458db5480b84/config_template.yaml">credentials</a> in a JSON or YAML file</li>
  <li>Put credentials in a secure store that you can access from R</li>
  <li>Ask the user for the credentials when the script is executed (possibly not useful for R Shiny applications)</li>
</ol>

<p><strong>My preferred way for R is the .Renviron (or a <a href="https://github.com/gaborcsardi/dotenv">dotEnv</a>) file</strong>. You basically store your password in this file, make sure you do not share this (a global gitignore could be helpful to prevent any accident) and read the variables when you start your code.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Secrets</span><span class="w">
</span><span class="n">MYSQL_PASSWORD</span><span class="o">=</span><span class="n">secret</span><span class="w">
</span></code></pre></div></div>

<p>If you would like to increase the security, you can combine it with a variation of <em>#6</em>. You use a .Renviron file, and use an encryption service like <a href="https://aws.amazon.com/kms/">Amazon KMS</a> (KMS stands for Key Management Service).</p>

<p>With <a href="https://github.com/cardcorp/AWR.KMS">AWS KMS in R</a>, you can encrypt your values, put them encrypted in your .Renviron, and even if someone gets hold of your .Renviron file, you have an extra layer of protection, as the attacker would require access to your cloud environment to decrypt it too.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">## Secrets</span><span class="w">
</span><span class="n">MYSQL_PASSWORD</span><span class="o">=</span><span class="n">AQECAHga320J8WadplGCqqVAr4HNvDaFSQ</span><span class="o">+</span><span class="n">NaiwIBhmm6qDSFwAAAGIwYAYJKoZIhvcNAQcGoFMwUQIBADBMBgkqhkiG9w0BBwEwHgYJYIZIAWUDBAEuMBEE99</span><span class="o">+</span><span class="n">LoLdvYv8l41OhAAIBEIAfx49FFJCLeYrkfMfAw6XlnxP23MmDBdqP8dPp28OoAQ</span><span class="o">==</span><span class="w">
</span></code></pre></div></div>

<h3 id="references">References</h3>

<ul>
  <li>[1] <a href="https://www.reddit.com/r/rstats/comments/6aonwx/open_source_r_applications_and_hiding_database/">r/stats * Open source R applications and hiding database connection</a></li>
  <li>[2] <a href="http://blog.revolutionanalytics.com/2015/11/how-to-store-and-use-authentication-details-with-r.html">How to store and use webservice keys and authentication details with R</a></li>
</ul>

<p>♥ Open Source</p>
</div>
<!-- Pagination links -->
  <div class="pagination">
    <p>
      
      <a href="/blog/page/8/" class="icon item">
        <i class="left chevron icon"></i>Previous
      </a>
      
      <span class="page_number ">Page: 9 of 31</span>
      
      <a href="/blog/page/10/" class="next">
        Next<i class="right chevron icon"></i>
      </a>
      
    </p>
  </div></div>

  </div>
</div>
</body>
</html>
