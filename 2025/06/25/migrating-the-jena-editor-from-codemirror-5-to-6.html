<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://kinoshita.eti.br/2025/06/25/migrating-the-jena-editor-from-codemirror-5-to-6.html"><meta property="og:site_name" content="kinow"><meta property="og:title" content="Migrating the Jena editor from CodeMirror 5 to 6"><meta property="og:description" content="On October last year, Dependabot&rsquo;s bot sent Apache Jena a pull request to update CodeMirror (a code editor component for web) to from our current 5.x version to 6.0.1. The build failed, as there were breaking changes in the CodeMirror API going from 5.x to 6.x.
CodeMirror developers wrote a nice documentation for users to migrate and update their code.
After following their documentation, unfortunately there were still build errors. Several months later, I found myself on a Saturday afternoon in a room struggling with the first heat wave in Barcelona this year, and decided to cool down by writing some code under the ceiling fan.
"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-25T09:38:52+03:00"><meta property="article:modified_time" content="2025-09-03T13:29:05+02:00"><meta property="article:tag" content="Opensource"><meta property="article:tag" content="Javascript"><meta property="article:tag" content="Programming"><meta property="og:image" content="https://kinoshita.eti.br/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/01.png"><meta property="fb:admins" content="bruno.kinoshita"><meta name=twitter:title content="Migrating the Jena editor from CodeMirror 5 to 6"><meta name=twitter:description content="On October last year, Dependabot&rsquo;s bot sent Apache Jena a pull request
to update CodeMirror (a code editor component for web) to from our current 5.x version
to 6.0.1. The build failed, as there were breaking changes in the CodeMirror
API going from 5.x to 6.x.
CodeMirror developers wrote a nice documentation for users to
migrate and update their code.
After following their documentation, unfortunately there were still build
errors. Several months later, I found myself on a Saturday afternoon in
a room struggling with the first heat wave in Barcelona this year, and
decided to cool down by writing some code under the ceiling fan."><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kinoshita.eti.br/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/01.png"><meta name=twitter:site content="@kinow"><link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2025/06/25/migrating-the-jena-editor-from-codemirror-5-to-6/feed.xml title=kinow><link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.2bf0e81b866986f8e894e04d30e6e1e76e2829c06afda356b6fca355d1000a94.css integrity="sha256-K/DoG4ZphvjolOBNMObh524oKcBq/aNWtvyjVdEACpQ="><title>kinow | Migrating the Jena editor from CodeMirror 5 to 6</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Migrating the Jena editor from CodeMirror 5 to 6","headline":"Migrating the Jena editor from CodeMirror 5 to 6","alternativeHeadline":"","description":"\u003cp\u003eOn October last year, Dependabot\u0026rsquo;s bot sent Apache Jena \u003ca href=\u0022https:\/\/github.com\/apache\/jena\/pull\/2789\u0022\u003ea pull request\u003c\/a\u003e\nto update CodeMirror (a code editor component for web) to from our current 5.x version\nto 6.0.1. The build failed, as there were breaking changes in the CodeMirror\nAPI going from 5.x to 6.x.\u003c\/p\u003e\n\u003cp\u003eCodeMirror developers wrote a nice documentation for users to\n\u003ca href=\u0022https:\/\/codemirror.net\/docs\/migration\/\u0022\u003emigrate and update their code\u003c\/a\u003e.\u003c\/p\u003e\n\u003cp\u003eAfter following their documentation, unfortunately there were still build\nerrors. Several months later, I found myself on a Saturday afternoon in\na room struggling with the first heat wave in Barcelona this year, and\ndecided to cool down by writing some code under the ceiling fan.\u003c\/p\u003e","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kinoshita.eti.br\/2025\/06\/25\/migrating-the-jena-editor-from-codemirror-5-to-6.html"},"author":{"@type":"Person","name":""},"creator":{"@type":"Person","name":""},"accountablePerson":{"@type":"Person","name":""},"copyrightHolder":"kinow","copyrightYear":"2025","dateCreated":"2025-06-25T09:38:52.00Z","datePublished":"2025-06-25T09:38:52.00Z","dateModified":"2025-09-03T13:29:05.00Z","publisher":{"@type":"Organization","name":"kinow","url":"https://kinoshita.eti.br/","logo":{"@type":"ImageObject","url":"https:\/\/kinoshita.eti.br\/","width":"32","height":"32"}},"image":["https://kinoshita.eti.br/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/01.png"],"url":"https:\/\/kinoshita.eti.br\/2025\/06\/25\/migrating-the-jena-editor-from-codemirror-5-to-6.html","wordCount":"424","genre":["opensource","javascript","programming"],"keywords":[]}</script></head><body><header role=banner class=content><nav id=nav aria-label=Main role=navigation class=content><ul style=position:relative><li><a href=/><i data-feather=about></i> About</a></li><li><a href=/blog/><i data-feather=blog></i> Blog</a></li><li><a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a></li><li style=position:absolute;right:0;bottom:-.75rem;text-align:right><span style=text-transform:uppercase;font-weight:700;font-size:3rem;color:#fffefa;line-height:normal;letter-spacing:-.1rem>Kinow</span></li></ul></nav></header><main><article class=content><h1>Migrating the Jena editor from CodeMirror 5 to 6</h1><div class=metadata><i data-feather=calendar></i>
<time datetime=2025-06-25>Jun 25, 2025</time></div><aside><nav id=TableOfContents><ul><li><a href=#turtle-ttl>Turtle (ttl)</a></li><li><a href=#cmscrollto-and-cmgetscrollinfo-are-gone><code>cm.scrollTo</code> and <code>cm.getScrollInfo</code> are gone</a></li><li><a href=#no-on-to-watch-for-change-events-in-codemirror-view-element>No <code>.on</code> to watch for <code>change</code> events in CodeMirror view element</a></li><li><a href=#e2e-test-cannot-locate-codemirror-code>e2e test cannot locate <code>.CodeMirror-code</code></a></li></ul></nav></aside><p>On October last year, Dependabot&rsquo;s bot sent Apache Jena <a href=https://github.com/apache/jena/pull/2789>a pull request</a>
to update CodeMirror (a code editor component for web) to from our current 5.x version
to 6.0.1. The build failed, as there were breaking changes in the CodeMirror
API going from 5.x to 6.x.</p><p>CodeMirror developers wrote a nice documentation for users to
<a href=https://codemirror.net/docs/migration/>migrate and update their code</a>.</p><p>After following their documentation, unfortunately there were still build
errors. Several months later, I found myself on a Saturday afternoon in
a room struggling with the first heat wave in Barcelona this year, and
decided to cool down by writing some code under the ceiling fan.</p><h2 id=turtle-ttl>Turtle (ttl)</h2><p>The first problem I had was that the turtle language syntax was not
available. The solution for that problem was to use the
<a href=https://www.npmjs.com/package/codemirror-lang-turtle>codemirror-lang-turtle</a>.</p><figure class=feature><img src=/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/01.png alt='Using new turtle library codemirror-lang-turtle' title='Using new turtle library codemirror-lang-turtle' style=width:auto width height><figcaption>Using new turtle library codemirror-lang-turtle</figcaption></figure><h2 id=cmscrollto-and-cmgetscrollinfo-are-gone><code>cm.scrollTo</code> and <code>cm.getScrollInfo</code> are gone</h2><p>I could not find anything in the <code>codemirror/view</code> repository (searched
code and issues), nor on the CodeMirror website. But after testing a bit
the new code, I realized that dispatching the change to update the text
content resulted in the new text appearing in the editor without any
issues to the scroll bar.</p><p>So I just removed those lines (for now, at least).</p><figure class=feature><img src=/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/02.png alt='Delete scroll-bar-related code' title='Delete scroll-bar-related code' style=width:auto width height><figcaption>Delete scroll-bar-related code</figcaption></figure><h2 id=no-on-to-watch-for-change-events-in-codemirror-view-element>No <code>.on</code> to watch for <code>change</code> events in CodeMirror view element</h2><p>Previously, we had some code that called <code>.on('change', ...)</code> on the
<code>cm</code> object, to listen for the events and sync it with our Vue elements.</p><p>That one would have been very hard (or at least very boring) problem to fix,
but thankfully <a href=https://discuss.codemirror.net/t/listen-to-change-event/5095>somebody else had already found it</a>.
The user message was also showing that I would have to call that method directly
on <code>EditorView</code>, and not on the <code>cm</code> instance (must be quite interesting
how they hook that up, global objects and all).</p><figure class=feature><img src=/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/03.png alt="Using EditorView.updateListener instead of on('change', ...)" title="Using EditorView.updateListener instead of on('change', ...)" style=width:auto width height><figcaption>Using EditorView.updateListener instead of on('change', ...)</figcaption></figure><h2 id=e2e-test-cannot-locate-codemirror-code>e2e test cannot locate <code>.CodeMirror-code</code></h2><p>The tests in Jena UI are written with Cypress, which works similarly to
Selenium. Elements are located by selectors like CSS classes. The only remaining
test failure was due to an element selected by <code>.CodeMirror-code</code> that was
not found.</p><p>So I fired the UI in offline mode &ndash; something I have always available when I
work in frontend projects &ndash; and checked the new CSS class: <code>.cm-content</code>.
Changed that, and the test passed! 🎉</p><figure class=feature><img src=/assets/posts/2025-06-28-migrating-the-jena-editor-from-codemirror-5-to-6/04.png alt='Last fix, using the right CSS class' title='Last fix, using the right CSS class' style=width:auto width height><figcaption>Last fix, using the right CSS class</figcaption></figure><p>Now the code is ready for review, and hopefully it will work well when it is
included in a future release of Jena &ndash; fingers crossed for that! 🤞</p><p>Categories:
<a href=/categories/blog.html>Blog</a></p><p>Tags:
<a href=/tags/opensource.html>Opensource</a>,
<a href=/tags/javascript.html>Javascript</a>,
<a href=/tags/programming.html>Programming</a></p><aside class=links><a class=previous href=https://kinoshita.eti.br/2025/05/25/running-cylc-workflows-on-bsc-marenostrum5.html>&#171; Previous</a><a class=next href=https://kinoshita.eti.br/2025/08/02/loading-javascript-in-jenkins-active-choices-parameters.html>Next &#187;</a></aside></article></main><footer role=contentinfo><ul id=social-media-icons><li><a href=https://www.instagram.com/brunokinoshita/><img src=/assets/icons/instagram.png alt="Instagram link"></a></li><li><a href=https://bsky.app/profile/kinow.bsky.social><img src=/assets/icons/bluesky.png alt="BlueSky link"></a></li><li><a href=https://twitter.com/kinow/><img src=/assets/icons/twitter.png alt="Twitter link"></a></li><li><a href=https://github.com/kinow/><img src=/assets/icons/github.png alt="GitHub link"></a></li><li><a href=/feed.xml><img src=/assets/icons/news.png alt="RSS feed link"></a></li></ul></footer></body></html>