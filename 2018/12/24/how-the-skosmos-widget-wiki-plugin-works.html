<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How the Skosmos Widget Wiki plugin works | Bruno P. Kinoshita</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="How the Skosmos Widget Wiki plugin works" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Skosmos can be extended through plugins, or widgets (a widget is a plugin for Skosmos). You can read more about how plugins work in Skosmos here. This post is a note-to-self, explaining how the Skosmos Widget Wiki plugin works. This is a plugin - or widget - that displays Wikipedia information when the concept supports it. Here’s an image of the plugin in action. Or you can go to a live instance of Skosmos that has the plugin enabled." />
<meta property="og:description" content="Skosmos can be extended through plugins, or widgets (a widget is a plugin for Skosmos). You can read more about how plugins work in Skosmos here. This post is a note-to-self, explaining how the Skosmos Widget Wiki plugin works. This is a plugin - or widget - that displays Wikipedia information when the concept supports it. Here’s an image of the plugin in action. Or you can go to a live instance of Skosmos that has the plugin enabled." />
<link rel="canonical" href="https://kinoshita.eti.br/2018/12/24/how-the-skosmos-widget-wiki-plugin-works.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2018/12/24/how-the-skosmos-widget-wiki-plugin-works.html" />
<meta property="og:site_name" content="Bruno P. Kinoshita" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-12-24T00:00:00+13:00" />
<script type="application/ld+json">
{"description":"Skosmos can be extended through plugins, or widgets (a widget is a plugin for Skosmos). You can read more about how plugins work in Skosmos here. This post is a note-to-self, explaining how the Skosmos Widget Wiki plugin works. This is a plugin - or widget - that displays Wikipedia information when the concept supports it. Here’s an image of the plugin in action. Or you can go to a live instance of Skosmos that has the plugin enabled.","@type":"BlogPosting","url":"https://kinoshita.eti.br/2018/12/24/how-the-skosmos-widget-wiki-plugin-works.html","headline":"How the Skosmos Widget Wiki plugin works","dateModified":"2018-12-24T00:00:00+13:00","datePublished":"2018-12-24T00:00:00+13:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2018/12/24/how-the-skosmos-widget-wiki-plugin-works.html"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="Bruno P. Kinoshita" /><link href="https://unpkg.com/pattern.css" rel="stylesheet">

</head>
<body>
<div id="mobile-menu"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" />
      </a>
    </li>
  </ul>
</div>
</div>
<div id="wrapper">
  <div id="sidebar"><div class="menu">
  <ul class="menu">
    <li class="item">
      <h1 id="kinow">KINOW</h1>
    </li>
    <li class="item">
      <a href="/" class="">About</a>
    </li>
    <li class="item">
      <a href="/blog/" class="current">Blog</a>
    </li>
    <li class="item">
      <a href="/portfolio/" class="">Portfolio</a>
    </li>
    <li class="item social-media-item">
      <a href="https://www.instagram.com/brunokinoshita/" class="inline-link">
        <img src="/assets/icons/instagram.png" class="inverted-image" />
      </a>
      <a href="https://twitter.com/kinow/" class="inline-link">
        <img src="/assets/icons/twitter.png" class="inverted-image" />
      </a>
      <a href="https://github.com/kinow/" class="inline-link">
        <img src="/assets/icons/github.png" class="inverted-image" />
      </a>
    </li>
  </ul>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How the Skosmos Widget Wiki plugin works</h1>
    <span class="post-meta">
      <time class="dt-published" datetime="2018-12-24T00:00:00+13:00" itemprop="datePublished">Dec 24, 2018
      </time>
      <span>&mdash; star date: -304936.99.</span>
      <span>
        Number of words: 828.
      </span></span>
  </header>

  <ul>
  <li><a href="#under-the-hood">Under the hood</a></li>
</ul>


  <div class="post-content e-content" itemprop="articleBody">
    <p>Skosmos can be extended through plugins, or widgets (a widget is a plugin for Skosmos).
You can read more about how <a href="https://github.com/NatLibFi/Skosmos/wiki/Plugins">plugins work in Skosmos here</a>.</p>

<p>This post is a note-to-self, explaining how the <strong>Skosmos Widget Wiki plugin</strong> works. This
is a plugin - or widget - that displays Wikipedia information when the concept supports it.</p>

<p>Here’s an image of the plugin in action. Or you can go to
<a href="http://finto.fi/yso-paikat/en/page/p107650">a live instance of Skosmos</a>
that has the plugin enabled.</p>

<p><img class="ui fluid image" src="/assets/posts/2018-12-24-how-the-skosmos-widget-wiki-plugin-works/skosmos-widget-wiki-screenshot.png" /></p>

<!--more-->

<h3 id="under-the-hood">Under the hood</h3>

<p>The plugin exposes a JavaScript callback via its <code class="language-plaintext highlighter-rouge">plugin.json</code> file. In the callback, it
receives a <code class="language-plaintext highlighter-rouge">data</code> object, with the following properties.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">uri</code>, the concept identifier, e.g. <em>http://www.yso.fi/onto/yso/p107650”</em></li>
  <li><code class="language-plaintext highlighter-rouge">prefLabels</code>, the concepts preferred labels, e.g. <em>“Central Asia”@en</em>, <em>“Keski-Aasia”@fi</em></li>
  <li><code class="language-plaintext highlighter-rouge">pageType</code>, defaults to <code class="language-plaintext highlighter-rouge">page</code></li>
  <li><code class="language-plaintext highlighter-rouge">json-ld</code>, which contains the JSON-LD <code class="language-plaintext highlighter-rouge">@context</code>, as well as a <code class="language-plaintext highlighter-rouge">graph</code> property</li>
</ul>

<p>If the <code class="language-plaintext highlighter-rouge">pageType</code> is not <code class="language-plaintext highlighter-rouge">page</code>, or if there are no preferred labels, or if there is no
JSON-LD data, the plugin is not activated.</p>

<p>When the plugin is activated, it will iterate through all entries in the graph, looking
for one which <code class="language-plaintext highlighter-rouge">uri</code> starts with <code class="language-plaintext highlighter-rouge">wd:</code> (for wikidata). Here’s what the <code class="language-plaintext highlighter-rouge">wikidata</code> object
will look like.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">uri</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">wd:Q27275</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://wikiba.se/ontology#Item</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">schema:description</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">lang</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ko</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">아시아의 중앙부.</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">lang</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">pt-br</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">região entre o leste do mar Cáspio e o centro-oeste da China, entre o norte do Irã e o Afeganistão, e o sul da Sibéria</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">lang</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">en</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">core region of the Asian continent</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="c1">//...</span>
  <span class="p">],</span>
  <span class="dl">"</span><span class="s2">schema:name</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">lang</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ko</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">중앙아시아</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="c1">//...</span>
  <span class="p">],</span>
  <span class="dl">"</span><span class="s2">label</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">lang</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ko</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">중앙아시아</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="c1">//...</span>
  <span class="p">],</span>
  <span class="dl">"</span><span class="s2">prefLabel</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">lang</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">ko</span><span class="dl">"</span><span class="p">,</span>
      <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">중앙아시아</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="c1">//...</span>
  <span class="p">],</span>
  <span class="dl">"</span><span class="s2">wdt:P31</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">uri</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">wd:Q82794</span><span class="dl">"</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="dl">"</span><span class="s2">uri</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">wd:Q3502482</span><span class="dl">"</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="dl">"</span><span class="s2">wdt:P625</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">http://www.opengis.net/ont/geosparql#wktLiteral</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">value</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Point(63.9 45.3)</span><span class="dl">"</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now the plugin will iterate the <code class="language-plaintext highlighter-rouge">graph</code> object once again, looking for entries
which the object type is <code class="language-plaintext highlighter-rouge">schema:Article</code>, and the <code class="language-plaintext highlighter-rouge">schema:isPartOf</code> ends with
<code class="language-plaintext highlighter-rouge">.wikipedia.org/</code>. These entries are aggregated into a list, <code class="language-plaintext highlighter-rouge">wikiArticlesList</code>.</p>

<p>This list is then iterated, building a reverse dictionary <code class="language-plaintext highlighter-rouge">keyLangUriValue</code>
with the language as key, and the URI as value. <code class="language-plaintext highlighter-rouge">keyLangUriValue</code> will look
something like the next example.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
  <span class="dl">"</span><span class="s2">ace</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://ace.wikipedia.org/wiki/Asia_Teung%C3%B6h</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">af</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://af.wikipedia.org/wiki/Sentraal-Asi%C3%AB</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">am</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">https://am.wikipedia.org/wiki/%E1%88%98%E1%8A%AB%E1%8A%A8%E1%88%88%E1%8A%9B_%E1%8A%A5%E1%88%B5%E1%8B%AB</span><span class="dl">"</span><span class="p">,</span>
  <span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Now comes the penultimate step. The plugin has access to some global variables,
including <code class="language-plaintext highlighter-rouge">languageOrder</code>, which contains the list of languages available in the
vocabulary used by the concept (actually the current vocabulary configuration).</p>

<p>For each of these languages, we grab the language code, and try to find it in
<code class="language-plaintext highlighter-rouge">keyLangUriValue</code>. Oh, the languages are ordered, and first comes the one we are
currently using! Important to mention it.</p>

<p>So once it locates one match in <code class="language-plaintext highlighter-rouge">keyLangUriValue</code>, the plugin then crafts the
URL (e.g. <em>https://en.wikipedia.org/api/rest_v1/page/html/Central_Asia</em>).</p>

<p>If there is no match, the plugin will render a 404 message. But when there is a
match, and the REST URL was created, it uses JQuery to submit an Ajax request.</p>

<p>Upon a success after querying the Wikipedia public REST API, the plugin will
use JQuery, an existing template.html plus Handlebars to render the template
under the <code class="language-plaintext highlighter-rouge">.concept-info</code> element. It also customizes a scroll bar, and there
are stylesheets applied for theming.</p>

<p>And that’s how the plugin works under the hood!</p>

  </div>

  <div class="tags">
    <p>
      Published Dec 24, 2018 in &ldquo;blog&rdquo; and tagged&nbsp;<a class="label" href="/tags#php">php</a>,&nbsp;<a class="label" href="/tags#skosmos">skosmos</a>,&nbsp;<a class="label" href="/tags#semantic web">semantic web</a>,&nbsp;<a class="label" href="/tags#vocabulary server">vocabulary server</a>. Number of words: 828.
    </p>
  </div>

  <a class="u-url" href="/2018/12/24/how-the-skosmos-widget-wiki-plugin-works.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
