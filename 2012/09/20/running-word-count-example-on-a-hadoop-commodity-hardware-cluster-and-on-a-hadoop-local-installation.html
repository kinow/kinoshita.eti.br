<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Running word-count example on a Hadoop commodity-hardware cluster and on a Hadoop local installation | Bruno P. Kinoshita</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Running word-count example on a Hadoop commodity-hardware cluster and on a Hadoop local installation" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Last weekend I spent some hours assembling old computer parts to create my commodity hardware cluster for running Hadoop. I already had a local installation in my notebook, so I thought it would be cool to run the word-count example in both scenarios to see what would be the results. But first, let&#39;s review the hardware configurations:" />
<meta property="og:description" content="Last weekend I spent some hours assembling old computer parts to create my commodity hardware cluster for running Hadoop. I already had a local installation in my notebook, so I thought it would be cool to run the word-count example in both scenarios to see what would be the results. But first, let&#39;s review the hardware configurations:" />
<link rel="canonical" href="https://kinoshita.eti.br/2012/09/20/running-word-count-example-on-a-hadoop-commodity-hardware-cluster-and-on-a-hadoop-local-installation.html" />
<meta property="og:url" content="https://kinoshita.eti.br/2012/09/20/running-word-count-example-on-a-hadoop-commodity-hardware-cluster-and-on-a-hadoop-local-installation.html" />
<meta property="og:site_name" content="Bruno P. Kinoshita" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2012-09-20T03:49:38-05:00" />
<script type="application/ld+json">
{"datePublished":"2012-09-20T03:49:38-05:00","headline":"Running word-count example on a Hadoop commodity-hardware cluster and on a Hadoop local installation","description":"Last weekend I spent some hours assembling old computer parts to create my commodity hardware cluster for running Hadoop. I already had a local installation in my notebook, so I thought it would be cool to run the word-count example in both scenarios to see what would be the results. But first, let&#39;s review the hardware configurations:","mainEntityOfPage":{"@type":"WebPage","@id":"https://kinoshita.eti.br/2012/09/20/running-word-count-example-on-a-hadoop-commodity-hardware-cluster-and-on-a-hadoop-local-installation.html"},"@type":"BlogPosting","url":"https://kinoshita.eti.br/2012/09/20/running-word-count-example-on-a-hadoop-commodity-hardware-cluster-and-on-a-hadoop-local-installation.html","dateModified":"2012-09-20T03:49:38-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css"><link type="application/atom+xml" rel="alternate" href="https://kinoshita.eti.br/feed.xml" title="Bruno P. Kinoshita" /></head>
<body>
<div id="wrapper">
  <div id="sidebar"><ul class="menu">
  <li class="item">
    <a href="/" aria-label="Home page link">
      <svg id="svg8" version="1.1" viewBox="0 0 58.208 9.2604" xmlns="http://www.w3.org/2000/svg" role="img" aria-labelledby="svg-logo-title svg-logo-desc">
        <title id="svg-logo-title">KINOSHITA image</title>
        <desc id="svg-logo-desc">A logo with the word KINOSHITA</desc>
        <g id="layer1" transform="translate(0 -287.74)">
          <g id="text817" transform="translate(-2.4568 -.23624)">
            <g id="logo" transform="matrix(2.6585 0 0 2.5911 -63.587 100.56)" fill="#000000" stroke-width=".26458px">
              <path role="presentation" id="path819" d="m25.178 72.637h0.54187v2.9633h-0.54187zm0.5842 1.397 1.0964-1.397h0.635l-1.1049 1.397 1.1049 1.5663h-0.635z"/>
              <path role="presentation" id="path821" d="m27.832 72.637h0.54187v2.9633h-0.54187z"/>
              <path role="presentation" id="path823" d="m29.023 72.637h0.5334l1.2658 1.9135v-1.9135h0.54187v2.9633h-0.4445l-1.3547-2.032v2.032h-0.54187z"/>
              <path role="presentation" id="path825" d="m33.298 75.66q-0.4191 0-0.75353-0.1905-0.3302-0.19473-0.5207-0.54187-0.18627-0.35137-0.18627-0.80857t0.18627-0.80433q0.1905-0.35137 0.5207-0.54187 0.33443-0.19473 0.75353-0.19473t0.7493 0.19473q0.33443 0.1905 0.5207 0.54187 0.1905 0.34713 0.1905 0.80433t-0.1905 0.80857q-0.18627 0.34713-0.5207 0.54187-0.3302 0.1905-0.7493 0.1905zm0-0.52493q0.4318 0 0.6604-0.2794 0.23283-0.2794 0.23283-0.7366t-0.23283-0.7366q-0.2286-0.2794-0.6604-0.2794t-0.66463 0.2794q-0.2286 0.2794-0.2286 0.7366t0.2286 0.7366q0.23283 0.2794 0.66463 0.2794z"/>
              <path role="presentation" id="path827" d="m36.091 75.66q-0.24977 0-0.53763-0.06773-0.28363-0.06773-0.4445-0.14817l0.0635-0.57573q0.5588 0.27093 0.98213 0.27093 0.22437 0 0.35137-0.08467 0.127-0.0889 0.127-0.25823 0-0.127-0.07197-0.20743-0.06773-0.08467-0.19897-0.1397-0.13123-0.05927-0.4191-0.16087-0.27093-0.09313-0.44873-0.19473-0.1778-0.10583-0.28363-0.2667-0.1016-0.1651-0.1016-0.40217 0-0.381 0.2794-0.61383t0.8001-0.23283q0.24553 0 0.48683 0.05503 0.24553 0.05503 0.44873 0.13547l-0.05503 0.55457q-0.26247-0.1143-0.4826-0.16933-0.2159-0.05927-0.4318-0.05927-0.2413 0-0.3683 0.08043t-0.127 0.23283q0 0.11853 0.06773 0.19473t0.18203 0.127q0.11853 0.0508 0.34713 0.12277 0.51223 0.16087 0.74507 0.37253 0.23707 0.20743 0.23707 0.5715 0 0.34713-0.2413 0.60537t-0.90593 0.25823z"/>
              <path role="presentation" id="path829" d="m37.688 72.637h0.54187v1.1726h1.3547v-1.1726h0.54187v2.9633h-0.54187v-1.2827h-1.3547v1.2827h-0.54187z"/>
              <path role="presentation" id="path831" d="m40.78 72.637h0.54187v2.9633h-0.54187z"/>
              <path role="presentation" id="path833" d="m42.546 73.162h-0.8382v-0.52493h2.2183v0.52493h-0.8382v2.4384h-0.54187z"/>
              <path role="presentation" id="path835" d="m45.632 74.898h-1.0795l-0.24553 0.70273h-0.52493l1.0541-2.9633h0.51223l1.0541 2.9633h-0.52493zm-0.16933-0.47413-0.3683-1.0583-0.37253 1.0583z"/>
            </g>
          </g>
        </g>
      </svg>
    </a>
  </li>
  <li class="item">
    <a href="/blog/" class="">Blog</a>
    <ul>
      <li class="item">
        <a href="/blog/drawing/">Drawing</a>
      </li>
      <li class="item">
        <a href="/blog/languages/">Languages</a>
      </li>
      <li class="item">
        <a href="/blog/music/">Music</a>
      </li>
      <li class="item">
        <a href="/blog/writing/">Writing</a>
      </li>
    </ul>
  </li>
  <li class="item">
    <a href="/art/" class="">Illustrations</a>
  </li>
  <li class="item">
    <a href="/maps/" class="">Maps</a>
  </li>
</ul>
<div id="menu-bottom">
  <p id="feed-subscribe">
    <a href="/feed.xml">
      <svg id="feed-icon" xmlns="http://www.w3.org/2000/svg" version="1.1" width="128px" height="128px" viewBox="0 0 256 256">
        <circle cx="68" cy="189" r="24" fill="rgba(255, 255, 255, .2)"/>
        <path d="M160 213h-34a82 82 0 0 0 -82 -82v-34a116 116 0 0 1 116 116z" fill="rgba(255, 255, 255, .2)"/>
        <path d="M184 213A140 140 0 0 0 44 73 V 38a175 175 0 0 1 175 175z" fill="rgba(255, 255, 255, .2)"/>
      </svg>
    </a>
  </p>
</div>
</div>
  <div id="content">
    <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Running word-count example on a Hadoop commodity-hardware cluster and on a Hadoop local installation</h1>
    <spab class="post-meta">
      <time class="dt-published" datetime="2012-09-20T03:49:38-05:00" itemprop="datePublished">Sep 20, 2012
      </time>
      6<span>&mdash; star date: -310202.19</span></spab>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Last weekend I spent some hours assembling old computer parts to create my commodity hardware cluster for running Hadoop. I already had a local installation in my notebook, so I thought it would be cool to run the word-count example in both scenarios to see what would be the results.</p>

<p>But first, let's review the hardware configurations:</p>

<!--more-->

<hr />

<h2>Cluster set up</h2>

<h4>devcluster01 (NameNode)</h4>
<ul>
<li>Intel Core 2 Duo 2.3 GHz</li>
<li>4 GB</li>
<li>200 GB</li>
<li>100 Mbps Full Duplex network card</li>
</ul>

<h4>devcluster02</h4>
<ul>
<li>AMD Athlon 1.6 GHz</li>
<li>500 MB</li>
<li>4 GB</li>
<li>100 Mbps Full Duplex network card</li>
</ul>

<h4>devcluster03</h4>
<ul>
<li>Celeron 1.3 GHz</li>
<li>300MB</li>
<li>10 GB</li>
<li>100 Mbps Full Duplex network card</li>
</ul>

<h4>devcluster04 (TaskTracker)</h4>
<ul>
<li>Celeron 2.26 GHz</li>
<li>512 MB</li>
<li>80 GB</li>
<li>100 Mbps Full Duplex network card</li>
</ul>

<h4>devcluster05</h4>
<ul>
<li>AMD Duron 1.1 GHz</li>
<li>512MB</li>
<li>40 GB</li>
<li>100 Mbps Full Duplex network card</li>
</ul>

<h4>Network</h4>

<ul>
<li>Ethernet 10/100 D-Link hub</li>
</ul>

<hr />

<h2>Standalone installation</h2>

<ul>
<li>Intel Core i5 2.3 GHz (quad core)</li>
<li>6 GB</li>
<li>500 GB</li>
</ul>

<hr />

<p>Notice that there is one NameNode (exclusive) and one JobTracker (exclusive too). I'm following the default for a cluster installation, but will try switching a DataNode/TaskTracker with less computing power for the NameNode or the JobTracker (they were randomly selected), and using both servers as DataNode/TaskTracker too.</p>

<p>The word-count example that I used can be found at <a href="http://www.github.com/kinow/hadoop-wordcount" title="http://www.github.com/kinow/hadoop-wordcount">https://github.com/kinow/hadoop-wordcount</a>. And the data used are free e-books from <a href="http://www.gutenberg.org/" title="Gutenberg">Gutenberg project</a>, saved as text plain UTF-8.</p>

<p>First I used the default data from this <a href="http://www.michael-noll.com/tutorials/running-hadoop-on-ubuntu-linux-single-node-cluster/#Copy_local_example_data_to_HDFS" title="Hadoop Tutorial">tutorial</a>, that includes only three books. Then I increased to 8 books. Not happy with the result I tried 30, and finally 66 books. You can get the data from the same GitHub repository mentioned above.</p>

<p>Using the web interface I retrieved the total time to execute each job, and using the following R script, plotted the graph below (for more on plotting R graphs, check this <a href="http://www.harding.edu/fmccown/r/" title="Link">link</a>).</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">73</span><span class="p">,</span><span class="w"> </span><span class="m">75</span><span class="p">,</span><span class="w"> </span><span class="m">132</span><span class="p">,</span><span class="w"> </span><span class="m">248</span><span class="p">)</span><span class="w"> </span><span class="c1"># time in the cluster</span><span class="w">
</span><span class="n">a2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">48</span><span class="p">,</span><span class="w"> </span><span class="m">121</span><span class="p">,</span><span class="w"> </span><span class="m">224</span><span class="p">)</span><span class="w"> </span><span class="c1"># time running locally</span><span class="w">
</span><span class="n">files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">66</span><span class="p">)</span><span class="w"> </span><span class="c1"># number of files used</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="o">=</span><span class="s2">"Number of files"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="o">=</span><span class="s2">"Time (s)"</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"o"</span><span class="p">)</span><span class="w"> </span><span class="c1"># plot cluster line</span><span class="w">
</span><span class="n">lines</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="n">a2</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">files</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">22</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="c1"># add the local line</span><span class="w">
</span><span class="n">title</span><span class="p">(</span><span class="n">main</span><span class="o">=</span><span class="s2">"Hadoop Execution in seconds"</span><span class="p">,</span><span class="w"> </span><span class="n">col.name</span><span class="o">=</span><span class="s2">"black"</span><span class="p">,</span><span class="w"> </span><span class="n">font.main</span><span class="o">=</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">g_range</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">range</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">a1</span><span class="p">,</span><span class="w"> </span><span class="n">files</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">g_range</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Cluster"</span><span class="p">,</span><span class="s2">"Local"</span><span class="p">),</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s2">"red"</span><span class="p">,</span><span class="s2">"blue"</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">21</span><span class="o">:</span><span class="m">22</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1">#legend</span><span class="w">
</span></code></pre></div></div>

<p style="text-align: center"><a href="http://www.kinoshita.eti.br/wp-content/uploads/2012/09/Rplot.png"><img src="http://www.kinoshita.eti.br/wp-content/uploads/2012/09/Rplot.png" alt="" title="Graph" width="550" height="400" class="aligncenter size-full wp-image-1019" /></a></p>

<p><strong>The cluster is running slower than the standalone installation</strong>. During this week I'll investigate how to get better results with the cluster. I have three computers running tasks in the distributed cluster (the other two are the NameNode and JobTracker), and my notebook has four cores. It may be influencing the results. There is also the network latency, low memory in some nodes and changing the NameNode and JobTracker.</p>

<p>All in all, it's been fun to configure the cluster and run the experiments. It is good for practicing with Hadoop and HDFS, as well as getting a better idea on how to manage a cluster.</p>
<p>&lt;/code&gt;</p>

<hr />

<p><em>Edit: JobTracker and TaskTracker were mixed up (thanks rretzbach)</em></p>

  </div>

  <div class="tags"><a class="label" href="/tags#big data">big data</a></div>

  <a class="u-url" href="/2012/09/20/running-word-count-example-on-a-hadoop-commodity-hardware-cluster-and-on-a-hadoop-local-installation.html" hidden></a>
</article>

  </div>
</div>
</body>
</html>
