  
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
    <title>Bruno P. Kinoshita</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Bruno de Paula Kinoshita personal web site" />
    <meta name="keywords"
        content="kinoshita, bruno de paula kinoshita, geek, geek stuff, java, python, c, c++, msn now playing, neural network, mackenzie, sao paulo, brasil, brazil, nerd, nerd stuff, cool, jenkins, illustration, quadrinhos, machine learning, linguistic, apache, open source, codigo livre, codigo aberto" />
    <meta name="author" content="" />
    <meta name="generator" content="PieCrust 3.2.1" />
    <meta name="template-engine" content="Twig" />
    <meta name="robots" content="all=index,follow" />
    <meta name="revisit-after" content="15 days" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta name="distribution" content="Global" />
    <meta name="url" content="/" />
    <meta name="copyright" content="Bruno de Paula Kinoshita" />
    <meta name="Googlebot" content="all" />
    <meta name="rating" content="general" />
    <meta http-equiv="expires" content="0" />
    <meta name="city" content="Sao Paulo" />
    <meta name="state" content="Brasil, Sao Paulo" />
    <meta http-equiv="content-language" content="en" />
    <meta http-equiv="imagetoolbar" content="no" />
    <meta id="page_favicon" href="/favicon.ico" rel="icon" type="image/x-icon" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="alternate" type="application/rss+xml" title="Bruno P. Kinoshita &raquo; Feed" href="/feed.xml" />
    <link rel="stylesheet" href="/css/semantic/dist/semantic.min.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    <link rel="stylesheet" href="/css/prettyPhoto.css" type="text/css" media="all" />
</head>
<body id="body">
    <div class="ui vertical sidebar menu" id="toc">
        <nav class="menu" role="navigation">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/art">Art</a>
    </div>
    <div class="item">
        <a href="/articles/">Articles</a>
    </div>
    <div class="item">
        <a href="/books/">Books</a>
    </div>
    <div class="item">
      <a href="/presentations/">Presentations</a>
    </div>
    <div class="item">
        <a href="/software/">Software</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
    <div class="item">
        <a href="/about/">About &#038; CV</a>
    </div>
</nav>
<img src="/img/bruno.jpg" title="Hmmmm" alt="My picture" width="134px" height="215px" />
    </div>
    <div class="ui black big launch right attached fixed button">
        <i class="content icon"></i>
        <span class="text">Menu</span>
    </div>
    <div class="ui fixed inverted main menu">
        <div class="ui container">
            <a class="launch icon item">
                <i class="content icon"></i>
            </a>
            <div class="item">
                
            </div>
        </div>
    </div>
    <div class="pusher">
        <div class="full height">
            <div class="toc">
                <div class="ui vertical sticky fixed top menu">
                    <nav class="menu" role="navigation">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/art">Art</a>
    </div>
    <div class="item">
        <a href="/articles/">Articles</a>
    </div>
    <div class="item">
        <a href="/books/">Books</a>
    </div>
    <div class="item">
      <a href="/presentations/">Presentations</a>
    </div>
    <div class="item">
        <a href="/software/">Software</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
    <div class="item">
        <a href="/about/">About &#038; CV</a>
    </div>
</nav>
<img src="/img/bruno.jpg" title="Hmmmm" alt="My picture" width="134px" height="215px" />
                </div>
            </div>
            <div class="article">
                <div class="main container" role="main">
                    <!-- right fixed menu -->
                    <div class="ui dividing right rail" id="taxonomy">
                        <div class="ui sticky fixed top">
                            <br/>
                            <h4>Blog Taxonomy</h4>
                            <nav id="tag-cloud" class="sidebar-box" role="complementary">
                              
                              <span style="font-size: 22.5pt"><a href="/tag/apache%20software%20foundation">apache software foundation</a></span>&nbsp;(25)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/articles">articles</a></span>&nbsp;(5)
                              
                              <span style="font-size: 11.5pt"><a href="/tag/aws">aws</a></span>&nbsp;(3)
                              
                              <span style="font-size: 13.5pt"><a href="/tag/c%2B%2B">c++</a></span>&nbsp;(7)
                              
                              <span style="font-size: 14.0pt"><a href="/tag/cylc">cylc</a></span>&nbsp;(8)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/docker">docker</a></span>&nbsp;(5)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/events">events</a></span>&nbsp;(5)
                              
                              <span style="font-size: 11.5pt"><a href="/tag/functional%20programming">functional programming</a></span>&nbsp;(3)
                              
                              <span style="font-size: 16.5pt"><a href="/tag/illustrations">illustrations</a></span>&nbsp;(13)
                              
                              <span style="font-size: 27.5pt"><a href="/tag/java">java</a></span>&nbsp;(35)
                              
                              <span style="font-size: 13.0pt"><a href="/tag/jena">jena</a></span>&nbsp;(6)
                              
                              <span style="font-size: 23.0pt"><a href="/tag/jenkins">jenkins</a></span>&nbsp;(26)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/krita">krita</a></span>&nbsp;(5)
                              
                              <span style="font-size: 12.0pt"><a href="/tag/natural%20language%20processing">natural language processing</a></span>&nbsp;(4)
                              
                              <span style="font-size: 29.5pt"><a href="/tag/opensource">opensource</a></span>&nbsp;(39)
                              
                              <span style="font-size: 26.5pt"><a href="/tag/programming">programming</a></span>&nbsp;(33)
                              
                              <span style="font-size: 18.0pt"><a href="/tag/python">python</a></span>&nbsp;(16)
                              
                              <span style="font-size: 11.5pt"><a href="/tag/r">r</a></span>&nbsp;(3)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/security">security</a></span>&nbsp;(5)
                              
                              <span style="font-size: 12.5pt"><a href="/tag/shell%20script">shell script</a></span>&nbsp;(5)
                              
                              <span style="font-size: 24.5pt"><a href="/tag/software%20quality">software quality</a></span>&nbsp;(29)
                              
                              <span style="font-size: 12.0pt"><a href="/tag/sparql">sparql</a></span>&nbsp;(4)
                              
                              <span style="font-size: 13.5pt"><a href="/tag/test%20anything%20protocol">test anything protocol</a></span>&nbsp;(7)
                              
                              <span style="font-size: 16.5pt"><a href="/tag/testlink">testlink</a></span>&nbsp;(13)
                              
                            </nav>
                            
                        </div>
                    </div>
                

Posts tagged with 'natural language processing'




<div class="ui raised padded container segment">
    <h2><a href="/2017/06/14/how-to-remove-the-signature-from-emails-with-nlp" title="Permanent link">How to remove the signature from e-mails with NLP?</a></h2>
    <p><small>kinow</small> @ <small>Jun 14, 2017&nbsp;13:59:33</small></p>
    
    





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/06/14/how-to-remove-the-signature-from-emails-with-nlp" data-text="How to remove the signature from e-mails with NLP?" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>Some time ago I stumbled across <a href="https://github.com/mynameisvinn/EmailParser">EmailParser</a>, a Python utility to remove e-mail signatures. Here&#8217;s a sample input e-mail from the project documentation.</p>
<div class="highlight"><pre><span></span>Wendy – thanks for the intro! Moving you to bcc.

Hi Vincent – nice to meet you over email. Apologize for the late reply, I was on PTO for a couple weeks and this is my first week back in office. As Wendy mentioned, I am leading an AR/VR taskforce at Foobar Retail Solutions. The goal of the taskforce is to better understand how AR/VR can apply to retail/commerce and if/what is the role of a shopping center in AR/VR applications for retail.

Wendy mentioned that you would be a great person to speak to since you are close to what is going on in this space. Would love to set up some time to chat via phone next week. What does your availability look like on Monday or Wednesday?

Best,
Joe Smith

Joe Smith | Strategy &amp; Business Development
111 Market St. Suite 111| San Francisco, CA 94103
M: 111.111.1111| joe@foobar.com
</pre></div>

<p>And here&#8217;s what it looks like afterwards.</p>
<div class="highlight"><pre><span></span>Wendy – thanks for the intro! Moving you to bcc.

Hi Vincent – nice to meet you over email. Apologize for the late reply, I was on PTO for a couple weeks and this is my first week back in office. As Wendy mentioned, I am leading an AR/VR taskforce at Foobar Retail Solutions. The goal of the taskforce is to better understand how AR/VR can apply to retail/commerce and if/what is the role of a shopping center in AR/VR applications for retail.

Wendy mentioned that you would be a great person to speak to since you are close to what is going on in this space. Would love to set up some time to chat via phone next week. What does your availability look like on Monday or Wednesday?
</pre></div>

<p>As you can see, it removed all the lines after the main part of the message (i.e. after the three paragraphs). Here&#8217;s what the Python code looks like.</p>
<div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">Parser</span> <span class="kn">import</span> <span class="n">read_email</span><span class="p">,</span> <span class="n">strip</span><span class="p">,</span> <span class="n">prob_block</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">spacy.en</span> <span class="kn">import</span> <span class="n">English</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">English</span><span class="p">()</span>  <span class="c1"># part-of-speech tagger</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">msg_raw</span> <span class="o">=</span> <span class="n">read_email</span><span class="p">(</span><span class="s1">&#39;emails/test1.txt&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">msg_stripped</span> <span class="o">=</span> <span class="n">strip</span><span class="p">(</span><span class="n">msg_raw</span><span class="p">)</span>  <span class="c1"># preprocessing text before POS tagging</span>

<span class="c1"># iterate through lines, write to file if not signature block</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">generate_text</span><span class="p">(</span><span class="n">msg_stripped</span><span class="p">,</span> <span class="o">.</span><span class="mi">9</span><span class="p">,</span> <span class="n">pos_tagger</span><span class="p">,</span> <span class="s1">&#39;emails/test1_clean.txt&#39;</span><span class="p">)</span>
</pre></div>

<p>What got me interested about this utility was the use of NLP. I couldn&#8217;t imagine how someone could use NLP for that. And I liked the simplicity of the approach, which is not perfect, but can be useful someday.</p>
<p>After the imports in the code, it creates a <a href="https://en.wikipedia.org/wiki/Part_of_speech">Part of Speech</a> tagger using <a href="https://spacy.io/">spaCy</a> NLP library, reads the e-mail from a file, and sripts and creates an array with each paragraph of the message.</p>
<p>The magic happens in the <code>generate_text</code> function, which receives the <strong>array of paragraphs</strong>, a <strong>threshold</strong>, the <strong>POS tagger</strong>, and the <strong>output destination</strong>. Here&#8217;s what the function does.</p>
<div class="highlight"><pre><span></span>for each message
    if probability ( signature block | message ) &lt; threshold
        write to output file
</pre></div>

<p>And the formula for calculating the probability is quite simple too.</p>
<div class="highlight"><pre><span></span>1. For a given paragraph (message block), find all the sentences in it.
2. Then for each word (token) in the sentence, count the number of times a non-verb appears.
3. Return the proportion of non-verbs per sentence, i.e. number of non-verbs / number of sentences.
</pre></div>

<p>In summary, it discards blocks that do not contain enough verbs to be considered a message block, being treated as signature blocks instead.</p>
<p>Never thought about using an approach like this. It may definitely be helpful when doing data analysis, information retrieval, or scraping data from the web. Not necessarily with e-mails and signatures, but you got the gist of it.</p>
<p>&hearts; Open Source</p><!-- html -->
    
<p class="postmetadata">
    
    <small>tags 
     [&nbsp;<a
        href="/tag/python"
        rel="tag">python</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/programming"
        rel="tag">programming</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/natural%20language%20processing"
        rel="tag">natural language processing</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/opensource"
        rel="tag">opensource</a>&nbsp;]&nbsp;
    
    </small>
    
    
</p>
</div>




<div class="ui raised padded container segment">
    <h2><a href="/2017/06/03/natural-language-processing-and-natural-language-understanding" title="Permanent link">Natural Language Processing and Natural Language Understanding</a></h2>
    <p><small>kinow</small> @ <small>Jun 03, 2017&nbsp;12:30:39</small></p>
    
    





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/06/03/natural-language-processing-and-natural-language-understanding" data-text="Natural Language Processing and Natural Language Understanding" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>I used <a href="https://en.wikipedia.org/wiki/Natural_language_processing"><strong>Natural Language Processing</strong></a> (NLP) tools in a few projects in the past years. But only recently, while involved with a <a href="https://en.wikipedia.org/wiki/Chatbot">chatbot</a> project, I noticed the term <a href="https://en.wikipedia.org/wiki/Natural_language_understanding"><strong>Natural Language Understanding</strong></a> (NLU).</p>
<p>NLU can be seen as a subfield of NLP. NLP englobes all techniques used for parsing text and extracting some knowledge about it. It could be finding out what are the common entities in the text, calculating the likelihood of a certain word being a preposition or a verb, sentiment analysis, or even spell checking sentences.</p>
<div class='row'>
<div class="ui fluid container">
<figure>
<a  href="/2017/06/03/natural-language-processing-and-natural-language-understanding/nlp-nlu.png" rel="prettyPhoto" class="thumbnail" title="NLP, NLU, and NLG">
<img style="height: 400px;" class="ui image" src="/2017/06/03/natural-language-processing-and-natural-language-understanding/nlp-nlu.png" alt="NLP, NLU, and NLG" />
</a>
<figcaption>NLP, NLU, and NLG &mdash; <i>source http://nlp.stanford.edu/~wcmac/papers/20140716-UNLU.pdf</i></figcaption>
</figure>
</div>
</div>

<p>When you are processing a language, it does not mean you are understanding the language. You may simply have rules, statistics, or some heuristics built to extract the information you need for some work.</p>
<p>NLU, on the other hand, implies that a system will try to understand the text. A text such as <em>&#8220;Given the price of mandarin lately, how likely is it to increase as much as the bananas?&#8221;</em>, could be parsed with NLP tools such as OpenNLP, CoreNLP, spaCy, etc.</p>
<p>However, you would have annotated text, entities, sentiment, perhaps coreference, but you still would not be able to build a machine that simply understands it. You can - with some effort - build rule based systems, apply semantics and ontologies, or use information retrieval techniques.</p>
<p>But it is still extremely hard to build a system to understand all the ways it could be said, slightly modified, such as <em>&#8220;are mandarins getting as expensive as bananas?&#8221;</em>, or take into consideration context information like localization or time <em>&#8220;were mandarins getting as expensive as bananas around the Pacific Islands five years ago?&#8221;</em>.</p>
<p>There are other subfields in NLP, such as <a href="https://en.wikipedia.org/wiki/Natural_language_generation"><strong>Natural Language Generation</strong></a> (NLG). Techniques from both NLU and NLG are used in chat bots, to parse the language and also to generate text based on the conversation.</p>
<p>NLP is an extremely interesting topic. 2001: A Space Odissey, Star Trek, The Foundation Series, and other science fiction books and movies. These all have intelligente computer systems that interact with humans. But should we tried to re-create these right now, even with all the work on machine learning, we would still have very funny (and perhaps dangerous) results.</p>
<div class='row'>
<div class="ui fluid container">
<figure>
<a  href="/2017/06/03/natural-language-processing-and-natural-language-understanding/spock-nlp.png" rel="prettyPhoto" class="thumbnail" title="NLP and Spock">
<img style="height: 300px;" class="ui image" src="/2017/06/03/natural-language-processing-and-natural-language-understanding/spock-nlp.png" alt="NLP and Spock" />
</a>
<figcaption>NLP and Spock &mdash; <i>source: <a href="http://kinow.deviantart.com/art/Spock-and-NLP-684434517">http://kinow.deviantart.com/art/Spock-and-NLP-684434517</a></i></figcaption>
</figure>
</div>
</div>

<p>&hearts; NLP</p><!-- html -->
    
<p class="postmetadata">
    
    <small>tags 
     [&nbsp;<a
        href="/tag/natural%20language%20processing"
        rel="tag">natural language processing</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/programming"
        rel="tag">programming</a>&nbsp;]&nbsp;
    
    </small>
    
    
</p>
</div>




<div class="ui raised padded container segment">
    <h2><a href="/2017/03/15/using-google-natural-language-api-in-aws-elastic-beanstalk-application" title="Permanent link">Using Google Natural Language API in an AWS Elastic Beanstalk application</a></h2>
    <p><small>kinow</small> @ <small>Mar 15, 2017&nbsp;13:18:03</small></p>
    
    





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/03/15/using-google-natural-language-api-in-aws-elastic-beanstalk-application" data-text="Using Google Natural Language API in an AWS Elastic Beanstalk application" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>Besides providing an API for users and developers, Google also provides a series of
(very well-written) client implementation, in several programming languages. That&#8217;s the
case for Google Storage, Google Vision, and for Google Natural Language API&#8217;s.</p>
<p>I recently had to use the latter in a POC at work, and ran into an interesting issue with
our AWS Elastic Beanstalk environment.</p>
<p>Google Language API requires that clients authenticate before sending requests. If you use their <a href="https://github.com/GoogleCloudPlatform/google-cloud-java">google-cloud-java</a>, you can define the GOOGLE_APPLICATION_CREDENTIALS. This environment variable must point to a JSON file with the Google Language API credentials.</p>
<p>The issue is that while Google Language API (or more precisely
<a href="https://github.com/google/google-auth-library-java/blob/ae9735c576fd8593636e155ccb26e454576bc2cd/oauth2_http/java/com/google/auth/oauth2/DefaultCredentialsProvider.java#L124">google-auth-library-java</a>)
looks for an environment variable, in Elastic Beanstalk you are able to
specify only system properties (unless you want to try something with ebextensions,
maybe some JNI&#8230;).</p>
<p>A workaround for this issue in Google Natural Language API, is to create and pass a
<a href="http://googlecloudplatform.github.io/google-cloud-java/0.8.0/apidocs/com/google/cloud/language/spi/v1/LanguageServiceSettings.html">LanguageServiceSettings</a>
to your <a href="http://googlecloudplatform.github.io/google-cloud-java/0.8.0/apidocs/com/google/cloud/language/spi/v1/LanguageServiceClient.html">LanguageServiceClient</a>.
This settings object, when created, must be given a
<a href="http://googleapis.github.io/gax-java/0.2.0/apidocs/com/google/api/gax/grpc/ChannelProvider.html">channel provider</a>
with a <a href="http://googleapis.github.io/gax-java/0.2.0/apidocs/com/google/api/gax/core/FixedCredentialsProvider.html">FixedCredentialsProvider</a>.</p>
<p>Of course reading code is way easier than reading this workaround description.</p>
<div class="highlight"><pre><span></span><span class="c1">// File: GoogleNaturalLanguageService.java</span>
<span class="c1">// ...</span>
    <span class="c1">// envvar or property used to specify the Google Application Credentials</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">GOOGLE_APPLICATION_CREDENTIALS</span> <span class="o">=</span> <span class="s">&quot;GOOGLE_APPLICATION_CREDENTIALS&quot;</span><span class="o">;</span>

    <span class="cm">/**</span>
<span class="cm">     * Google Natural Language API.</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="n">LanguageServiceClient</span> <span class="n">languageServiceClient</span><span class="o">;</span>

    <span class="nd">@PostConstruct</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="c1">// Elastic Beanstalk supports Properties, not Environment Variables.</span>
        <span class="c1">// Google credentials library will load</span>
        <span class="c1">// the JSON location for the service to authenticate from an envVar. So</span>
        <span class="c1">// we need to fix that here.</span>
        <span class="n">String</span> <span class="n">googleApplicationCredentials</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getenv</span><span class="o">(</span><span class="n">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">);</span>
        <span class="n">LOGGER</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;GOOGLE_APPLICATION_CREDENTIALS in environment variable: %s&quot;</span><span class="o">,</span> <span class="n">googleApplicationCredentials</span><span class="o">));</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isBlank</span><span class="o">(</span><span class="n">googleApplicationCredentials</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">googleApplicationCredentials</span> <span class="o">=</span> <span class="n">System</span><span class="o">.</span><span class="na">getProperty</span><span class="o">(</span><span class="n">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">);</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;GOOGLE_APPLICATION_CREDENTIALS in JVM property: %s&quot;</span><span class="o">,</span> <span class="n">googleApplicationCredentials</span><span class="o">));</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">googleApplicationCredentials</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&quot;Could not locate GOOGLE_APPLICATION_CREDENTIALS variable!&quot;</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="kd">final</span> <span class="n">LanguageServiceSettings</span> <span class="n">languageServiceSettings</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">(</span><span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">googleApplicationCredentials</span><span class="o">)))</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">GoogleCredentials</span> <span class="n">myCredentials</span> <span class="o">=</span> <span class="n">GoogleCredentials</span>
                    <span class="o">.</span><span class="na">fromStream</span><span class="o">(</span><span class="n">is</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">createScoped</span><span class="o">(</span>
                            <span class="n">Collections</span><span class="o">.</span><span class="na">singleton</span><span class="o">(</span><span class="s">&quot;https://www.googleapis.com/auth/cloud-platform&quot;</span><span class="o">)</span>
                    <span class="o">);</span>
            <span class="kd">final</span> <span class="n">CredentialsProvider</span> <span class="n">credentialsProvider</span> <span class="o">=</span> <span class="n">FixedCredentialsProvider</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">myCredentials</span><span class="o">);</span>

            <span class="kd">final</span> <span class="n">InstantiatingChannelProvider</span> <span class="n">channelProvider</span> <span class="o">=</span> <span class="n">LanguageServiceSettings</span>
                    <span class="o">.</span><span class="na">defaultChannelProviderBuilder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">setCredentialsProvider</span><span class="o">(</span><span class="n">credentialsProvider</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
            <span class="n">languageServiceSettings</span> <span class="o">=</span> <span class="n">LanguageServiceSettings</span>
                    <span class="o">.</span><span class="na">defaultBuilder</span><span class="o">()</span>
                    <span class="o">.</span><span class="na">setChannelProvider</span><span class="o">(</span><span class="n">channelProvider</span><span class="o">)</span>
                    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">ioe</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&quot;IO error creating Google NLP settings: %s&quot;</span><span class="o">,</span> <span class="n">ioe</span><span class="o">.</span><span class="na">getMessage</span><span class="o">()),</span> <span class="n">ioe</span><span class="o">);</span>
            <span class="k">throw</span> <span class="n">ioe</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="c1">// Create Google API client</span>
        <span class="k">this</span><span class="o">.</span><span class="na">languageServiceClient</span> <span class="o">=</span> <span class="n">LanguageServiceClient</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">languageServiceSettings</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@PreDestroy</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">destroy</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">LOGGER</span><span class="o">.</span><span class="na">isDebugEnabled</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">LOGGER</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;Destroying Google NLP API client&quot;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// Close Google API executors and channels</span>
        <span class="k">this</span><span class="o">.</span><span class="na">languageServiceClient</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="c1">// ...</span>
</pre></div>

<p>That way you should be able to use the API with AWS Elastic Beanstalk
without having to hack your environment to provide the GOOGLE_APPLICATION_CREDENTIALS
environment variable.</p>
<p>An alternative would be google-auth-library-java to look for an environment variable
<em>and</em> a system property. Or maybe Amazon AWS add a way to provide environment variables.</p>
<p>Note also that I included the @PostConstruct and @PreDestroy annotated methods. The
API will start an executor thread pool, so if you do not want to risk to have problems
re-deploying your application, then remember to close your streams.</p>
<p>&hearts; Open Source</p><!-- html -->
    
<p class="postmetadata">
    
    <small>tags 
     [&nbsp;<a
        href="/tag/aws"
        rel="tag">aws</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/natural%20language%20processing"
        rel="tag">natural language processing</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/google-cloud"
        rel="tag">google-cloud</a>&nbsp;]&nbsp;
    
    </small>
    
    
    <br/>
    <small>posted in 
    [&nbsp;<a
        href="/blog"
        title="View all posts in blog"
        rel="category tag">blog</a>&nbsp;]&nbsp;
    category </small>
    
</p>
</div>




<div class="ui raised padded container segment">
    <h2><a href="/2017/01/15/proposed-logos-for-opennlp" title="Permanent link">Proposed logos for OpenNLP</a></h2>
    <p><small>kinow</small> @ <small>Jan 15, 2017&nbsp;20:42:03</small></p>
    
    





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2017/01/15/proposed-logos-for-opennlp" data-text="Proposed logos for OpenNLP" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


    <p>A couple of logos submitted to <a href="https://issues.apache.org/jira/browse/OPENNLP-6">OPENNLP-6</a>. Made with Inkscape, fonts from Google Fonts.</p>
<div class='row'>
<div class="ui fluid container">
<figure>
<a  href="/2017/01/15/proposed-logos-for-opennlp/OpenNLP-logos.svg.png" rel="prettyPhoto" class="thumbnail" title="Proposed logos for OpenNLP">
<img style="height: 400px;" class="ui image" src="/2017/01/15/proposed-logos-for-opennlp/OpenNLP-logos.svg.png" alt="Proposed logos for OpenNLP" />
</a>
<figcaption>Proposed logos for OpenNLP</figcaption>
</figure>
</div>
</div>

<p>For more, check out <a href="http://kinow.deviantart.com/art/Proposed-logos-for-Apache-OpenNLP-657512914">my DeviantArt page</a>.</p><!-- html -->
    
<p class="postmetadata">
    
    <small>tags 
     [&nbsp;<a
        href="/tag/illustrations"
        rel="tag">illustrations</a>&nbsp;]&nbsp;
    
     [&nbsp;<a
        href="/tag/natural%20language%20processing"
        rel="tag">natural language processing</a>&nbsp;]&nbsp;
    
    </small>
    
    
    <br/>
    <small>posted in 
    [&nbsp;<a
        href="/blog"
        title="View all posts in blog"
        rel="category tag">blog</a>&nbsp;]&nbsp;
    category </small>
    
</p>
</div>






               </div>
            </div>
        </div>
        <div class="ui vertical footer segment">
            <div class="ui center aligned container">
                           <div id="copy" class="">
                <p>&copy; <a href="/about"><span
                            class="b">Bru</span><span
                            class="r">no de</span> <span
                            class="a">Paula</span> <span
                            class="s"></span><span
                            class="i">Kinos</span><span
                            class="l">hita</span></a>
                </p>
            </div>
            </div>
         </div>
    </div>
</body>
</html>
<script src="/js/jquery-2.2.3.min.js"  type="text/javascript"></script>
<script src="/css/semantic/dist/semantic.min.js"  type="text/javascript"></script>
<script src="/js/jquery.prettyPhoto.js"></script>
<script src="/js/site.js"></script>