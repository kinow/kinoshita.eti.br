<!doctype html><html lang=en>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta property="og:title" content="Content negotiation with Spring Boot and React">
<meta property="og:description" content="A few days ago I had a bug in a system built with Spring Boot and React. The frontend application was using a REST client in React, built in a similar way to what is found in the documentation, and also in blogs.
import rest from 'rest'; const Rest = () => rest.wrap(mime); However, for one of the Spring Boot application endpoints, the React component was not working. The response seemed to be OK in the Network tab, of the browser developer tools.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://kinoshita.eti.br/2016/11/07/content-negotiation-with-spring-boot-and-react.html"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2016-11-07T00:00:00+00:00">
<meta property="article:modified_time" content="2024-04-09T22:22:53+02:00">
<link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2016/11/07/content-negotiation-with-spring-boot-and-react/feed.xml title=kinow>
<link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.edd0fb9d64d9d8f2908cac4e6242f16d6626e9d2f915df8c59b5ad82b0cc0286.css integrity="sha256-7dD7nWTZ2PKQjKxOYkLxbWYm6dL5Fd+MWbWtgrDMAoY=">
<title>kinow | Content negotiation with Spring Boot and React</title>
</head>
<body>
<header role=banner class=content>
<nav id=nav aria-label=Main role=navigation class=content>
<ul><li>
<a href=/><i data-feather=about></i> About</a>
</li><li>
<a href=/blog/><i data-feather=blog></i> Blog</a>
</li><li>
<a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a>
</li>
</ul>
</nav>
</header>
<main>
<article class=content>
<h1>Content negotiation with Spring Boot and React</h1><div class=metadata>
<i data-feather=calendar></i>
<time datetime=2016-11-07>Nov 7, 2016</time>
</div>
<aside>
<nav id=TableOfContents></nav>
</aside>
<p>A few days ago I had a bug in a system built with Spring Boot and React. The frontend application
was using a REST client in React, built in a similar way to what is found in the documentation, and
also in blogs.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#a90d91>import</span> <span style=color:#000>rest</span> <span style=color:#000>from</span> <span style=color:#c41a16>&#39;rest&#39;</span>;
<span style=color:#a90d91>const</span> <span style=color:#000>Rest</span> <span style=color:#000>=</span> () =&gt; <span style=color:#000>rest</span>.<span style=color:#000>wrap</span>(<span style=color:#000>mime</span>);
</code></pre></div><p>However, for one of the Spring Boot application endpoints, the React component was not working. The
response seemed to be OK in the Network tab, of the browser developer tools. But the component was
failing and complaining when parsing the response.</p>
<p>Turns out that the frontend was sending the request with the header <code>Accept: text/plain, application/json</code>.
And Spring Boot was just using its <a href=https://spring.io/blog/2013/05/11/content-negotiation-using-spring-mvc>default content negotiation</a>
and returning what the frontend requested: a text plain version of, what looked like, JSON.</p>
<p>The quick fix was to request the content as JSON in React.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#a90d91>import</span> <span style=color:#000>rest</span> <span style=color:#000>from</span> <span style=color:#c41a16>&#39;rest&#39;</span>;
<span style=color:#a90d91>import</span> <span style=color:#000>mime</span> <span style=color:#000>from</span> <span style=color:#c41a16>&#39;rest/interceptor/mime&#39;</span>;
<span style=color:#a90d91>const</span> <span style=color:#000>Rest</span> <span style=color:#000>=</span> () =&gt; <span style=color:#000>rest</span>.<span style=color:#000>wrap</span>(<span style=color:#000>mime</span> , { <span style=color:#000>mime</span><span style=color:#000>:</span> <span style=color:#c41a16>&#39;application/json&#39;</span> } );
</code></pre></div><p>Now we will revisit the backend to return the JSON content, as content, regardless of what
the user asks :-)</p>
<p>Happy hacking!</p>
<p>
Categories:
<a href=/categories/blog.html>blog</a>
</p>
<p>
Tags:
<a href=/tags/java.html>java</a>
</p>
<aside class=links>
<a class=previous href=https://kinoshita.eti.br/2016/11/05/checking-the-operating-system-type-in-shell-script.html>&#171; Previous</a>
<a class=next href=https://kinoshita.eti.br/2016/11/12/add-a-header-to-a-file-with-shell-script-sed.html>Next &#187;</a>
</aside>
</article>
</main>
<footer role=contentinfo>
<ul id=social-media-icons>
<li>
<a href=https://www.instagram.com/brunokinoshita/>
<img src=/assets/icons/instagram.png alt="Instagram link">
</a>
</li>
<li>
<a href=https://twitter.com/kinow/>
<img src=/assets/icons/twitter.png alt="Twitter link">
</a>
</li>
<li>
<a href=https://github.com/kinow/>
<img src=/assets/icons/github.png alt="GitHub link">
</a>
</li>
<li>
<a href=/feed.xml>
<img src=/assets/icons/news.png alt="RSS feed link">
</a>
</li>
</ul>
</footer>
</body>
</html>