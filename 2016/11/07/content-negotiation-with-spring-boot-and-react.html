<!doctype html><html lang=en><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.5770a4bbb94587745388ea30c6a21828c384682fd7a84b8d636265cbd651d758.css integrity="sha256-V3Cku7lFh3RTiOowxqIYKMOEaC/XqEuNY2Jly9ZR11g=">
<title>kinow | Content negotiation with Spring Boot and React</title>
</head>
<body><header role=banner class=content>
<nav id=nav aria-label=Main role=navigation class=content>
<ul><li>
<a href=/>
<i data-feather=about></i> About</a>
</li><li>
<a href=/blog/>
<i data-feather=blog></i> Blog</a>
</li><li>
<a href=/portfolio/>
<i data-feather=portfolio></i> Portfolio</a>
</li><li></li>
</ul>
</nav>
</header>
<main>
<article class=content>
<h2>Content negotiation with Spring Boot and React</h2><div class=metadata>
<i data-feather=calendar></i>
<time datetime=2016-11-07>Nov 7, 2016</time>
</div>
<p>A few days ago I had a bug in a system built with Spring Boot and React. The frontend application
was using a REST client in React, built in a similar way to what is found in the documentation, and
also in blogs.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:navy;font-weight:700>import</span> rest from <span style=color:#00f>&#39;rest&#39;</span>;
<span style=color:navy;font-weight:700>const</span> Rest = () =&gt; rest.wrap(mime);
</code></pre></div><p>However, for one of the Spring Boot application endpoints, the React component was not working. The
response seemed to be OK in the Network tab, of the browser developer tools. But the component was
failing and complaining when parsing the response.</p>
<p>Turns out that the frontend was sending the request with the header <code>Accept: text/plain, application/json</code>.
And Spring Boot was just using its <a href=https://spring.io/blog/2013/05/11/content-negotiation-using-spring-mvc>default content negotiation</a>
and returning what the frontend requested: a text plain version of, what looked like, JSON.</p>
<p>The quick fix was to request the content as JSON in React.</p>
<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:navy;font-weight:700>import</span> rest from <span style=color:#00f>&#39;rest&#39;</span>;
<span style=color:navy;font-weight:700>import</span> mime from <span style=color:#00f>&#39;rest/interceptor/mime&#39;</span>;
<span style=color:navy;font-weight:700>const</span> Rest = () =&gt; rest.wrap(mime , { mime: <span style=color:#00f>&#39;application/json&#39;</span> } );
</code></pre></div><p>Now we will revisit the backend to return the JSON content, as content, regardless of what
the user asks :-)</p>
<p>Happy hacking!</p>
<aside class=links>
<a class=previous href=https://kinoshita.eti.br/2016/11/05/checking-the-operating-system-type-in-shell-script.html>&#171; Previous</a>
<a class=next href=https://kinoshita.eti.br/2016/11/12/add-a-header-to-a-file-with-shell-script-sed.html>Next &#187;</a>
</aside>
</article>
</main>
<footer role=contentinfo>
<ul id=social-media-icons>
<li>
<a href=https://www.instagram.com/brunokinoshita/>
<img src=/assets/icons/instagram.png alt="Instagram link">
</a>
</li>
<li>
<a href=https://twitter.com/kinow/>
<img src=/assets/icons/twitter.png alt="Twitter link">
</a>
</li>
<li>
<a href=https://github.com/kinow/>
<img src=/assets/icons/github.png alt="GitHub link">
</a>
</li>
</ul>
</footer>
</body>
</html>