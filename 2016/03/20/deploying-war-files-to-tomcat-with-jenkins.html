<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:url" content="https://kinoshita.eti.br/2016/03/20/deploying-war-files-to-tomcat-with-jenkins.html"><meta property="og:site_name" content="kinow"><meta property="og:title" content="Deploying WAR files to Tomcat with Jenkins"><meta property="og:description" content="Table of Contents
Deploying with custom scripts Deploying with a build tool Deploying with a build server Final thoughts A co-worker asked me this week about how to deploy a WAR file to Tomcat with Jenkins. In my team we are currently maintaining and deploying about 10 Java web systems, but we have no consistent way of deploying the applications to Tomcat yet. In the past I used Ant, Maven, Cargo, Grunt, and Jenkins, so I decided to write this short post to show a few different ways it can be achieved, à la Perl&amp;rsquo;s TMTOWTDI motto.
#1 Deploying with custom scripts At first you may be tempted to write your own script to deploy to Tomcat with some Shell, Perl, Python or Java. But I think I would choose this option only because either I needed some feature that is not available in the other options, or in order to call other tasks or debug some problem.
Example:
$ docker run -d -p 8888:8080 jeanblanchard/tomcat:8 $ git clone https://github.com/spring-projects/spring-petclinic.git &amp;amp;&amp;amp; cd spring-petclinic &amp;amp;&amp;amp; mvn package $ curl --upload-file target/petclinic.war &amp;#34;http://admin:admin@localhost:8888/manager/text/deploy?path=/spring-petclinic&amp;amp;update=true&amp;#34; OK - Deployed application at context path /spring-petclinic "><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-03-20T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-04T23:29:17+01:00"><meta property="article:tag" content="Jenkins"><meta property="article:tag" content="Tomcat"><meta property="article:tag" content="Docker"><meta property="og:image" content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta property="fb:admins" content="bruno.kinoshita"><meta name=twitter:title content="Deploying WAR files to Tomcat with Jenkins"><meta name=twitter:description content='Table of Contents

Deploying with custom scripts
Deploying with a build tool
Deploying with a build server
Final thoughts

A co-worker asked me this week about how to deploy a WAR file to Tomcat with Jenkins. In my team we are
currently maintaining and deploying about 10 Java web systems, but we have no consistent way of deploying
the applications to Tomcat yet. In the past I used Ant, Maven, Cargo, Grunt, and Jenkins, so I
decided to write this short post to show a few different ways it can be achieved, à la
Perl&rsquo;s TMTOWTDI motto.
#1 Deploying with custom scripts
At first you may be tempted to write your own script to deploy to Tomcat with some Shell, Perl, Python
or Java. But I think I would choose this option only because either I needed some feature that is not
available in the other options, or in order to call other tasks or debug some problem.
Example:
$ docker run -d -p 8888:8080 jeanblanchard/tomcat:8
$ git clone https://github.com/spring-projects/spring-petclinic.git && cd spring-petclinic && mvn package
$ curl --upload-file target/petclinic.war "http://admin:admin@localhost:8888/manager/text/deploy?path=/spring-petclinic&amp;update=true"
OK - Deployed application at context path /spring-petclinic
'><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kinoshita.eti.br/assets/photos/about/2023-me-closeup.png"><meta name=twitter:site content="@kinow"><link rel=alternate type=application/rss+xml href=https://kinoshita.eti.br/2016/03/20/deploying-war-files-to-tomcat-with-jenkins/feed.xml title=kinow><link rel=stylesheet type=text/css href=https://kinoshita.eti.br/sass/main.ecb27dc5d5ced6616f17336fdf32a78aff8278ec4b599f9e5cdc5bb8a09a9f28.css integrity="sha256-7LJ9xdXO1mFvFzNv3zKniv+CeOxLWZ+eXNxbuKCanyg="><title>kinow | Deploying WAR files to Tomcat with Jenkins</title><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Deploying WAR files to Tomcat with Jenkins","headline":"Deploying WAR files to Tomcat with Jenkins","alternativeHeadline":"","description":"\u003cp\u003e\u003cstrong\u003eTable of Contents\u003c\/strong\u003e\u003c\/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\u0022#1-deploying-with-custom-scripts\u0022\u003eDeploying with custom scripts\u003c\/a\u003e\u003c\/li\u003e\n\u003cli\u003e\u003ca href=\u0022#2-deploying-with-a-build-tool\u0022\u003eDeploying with a build tool\u003c\/a\u003e\u003c\/li\u003e\n\u003cli\u003e\u003ca href=\u0022#3-deploying-with-a-build-server\u0022\u003eDeploying with a build server\u003c\/a\u003e\u003c\/li\u003e\n\u003cli\u003e\u003ca href=\u0022#final-thoughts\u0022\u003eFinal thoughts\u003c\/a\u003e\u003c\/li\u003e\n\u003c\/ul\u003e\n\u003cp\u003eA co-worker asked me this week about how to deploy a WAR file to Tomcat with Jenkins. In my team we are\ncurrently maintaining and deploying about 10 Java web systems, but we have no consistent way of deploying\nthe applications to Tomcat yet. In the past I used Ant, Maven, Cargo, Grunt, and Jenkins, so I\ndecided to write this short post to show a few different ways it can be achieved, à la\n\u003ca href=\u0022https:\/\/en.wikipedia.org\/wiki\/There\u0027s_more_than_one_way_to_do_it\u0022\u003ePerl\u0026rsquo;s TMTOWTDI\u003c\/a\u003e motto.\u003c\/p\u003e\n\u003ch2\u003e\u003ca name=\u00221-deploying-with-custom-scripts\u0022 style=\u0022color: #222222;\u0022\u003e#1 Deploying with custom scripts\u003c\/a\u003e\u003c\/h2\u003e\n\u003cp\u003eAt first you may be tempted to write your own script to deploy to Tomcat with some Shell, Perl, Python\nor Java. But I think I would choose this option only because either I needed some feature that is not\navailable in the other options, or in order to call other tasks or debug some problem.\u003c\/p\u003e\n\u003cp\u003eExample:\u003c\/p\u003e\n\u003cdiv class=\u0022highlight\u0022\u003e\u003cpre tabindex=\u00220\u0022 style=\u0022background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;\u0022\u003e\u003ccode class=\u0022language-bash\u0022 data-lang=\u0022bash\u0022\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e$ docker run -d -p 8888:8080 jeanblanchard\/tomcat:8\n\u003c\/span\u003e\u003c\/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e$ git clone https:\/\/github.com\/spring-projects\/spring-petclinic.git \u003cspan style=\u0022color:#000\u0022\u003e\u0026amp;\u0026amp;\u003c\/span\u003e \u003cspan style=\u0022color:#a90d91\u0022\u003ecd\u003c\/span\u003e spring-petclinic \u003cspan style=\u0022color:#000\u0022\u003e\u0026amp;\u0026amp;\u003c\/span\u003e mvn package\n\u003c\/span\u003e\u003c\/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003e$ curl --upload-file target\/petclinic.war \u003cspan style=\u0022color:#c41a16\u0022\u003e\u0026#34;http:\/\/admin:admin@localhost:8888\/manager\/text\/deploy?path=\/spring-petclinic\u0026amp;update=true\u0026#34;\u003c\/span\u003e\n\u003c\/span\u003e\u003c\/span\u003e\u003cspan style=\u0022display:flex;\u0022\u003e\u003cspan\u003eOK - Deployed application at context path \/spring-petclinic\n\u003c\/span\u003e\u003c\/span\u003e\u003c\/code\u003e\u003c\/pre\u003e\u003c\/div\u003e","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kinoshita.eti.br\/2016\/03\/20\/deploying-war-files-to-tomcat-with-jenkins.html"},"author":{"@type":"Person","name":""},"creator":{"@type":"Person","name":""},"accountablePerson":{"@type":"Person","name":""},"copyrightHolder":"kinow","copyrightYear":"2016","dateCreated":"2016-03-20T00:00:00.00Z","datePublished":"2016-03-20T00:00:00.00Z","dateModified":"2025-01-04T23:29:17.00Z","publisher":{"@type":"Organization","name":"kinow","url":"https://kinoshita.eti.br/","logo":{"@type":"ImageObject","url":"https:\/\/kinoshita.eti.br\/","width":"32","height":"32"}},"image":"https://kinoshita.eti.br/","url":"https:\/\/kinoshita.eti.br\/2016\/03\/20\/deploying-war-files-to-tomcat-with-jenkins.html","wordCount":"1435","genre":["jenkins","tomcat","docker"],"keywords":[]}</script></head><body><header role=banner class=content><nav id=nav aria-label=Main role=navigation class=content><ul style=position:relative><li><a href=/><i data-feather=about></i> About</a></li><li><a href=/blog/><i data-feather=blog></i> Blog</a></li><li><a href=/portfolio/><i data-feather=portfolio></i> Portfolio</a></li><li style=position:absolute;right:0;bottom:-.75rem;text-align:right><span style=text-transform:uppercase;font-weight:700;font-size:3rem;color:#fffefa;line-height:normal;letter-spacing:-.1rem>Kinow</span></li></ul></nav></header><main><article class=content><h1>Deploying WAR files to Tomcat with Jenkins</h1><div class=metadata><i data-feather=calendar></i>
<time datetime=2016-03-20>Mar 20, 2016</time></div><aside><nav id=TableOfContents><ul><li><ul><li><a href=#pros>Pros</a></li><li><a href=#cons>Cons</a></li><li><a href=#pros-1>Pros</a></li><li><a href=#cons-1>Cons</a></li><li><a href=#pros-2>Pros</a></li><li><a href=#cons-2>Cons</a></li></ul></li></ul></nav></aside><p><strong>Table of Contents</strong></p><ul><li><a href=#1-deploying-with-custom-scripts>Deploying with custom scripts</a></li><li><a href=#2-deploying-with-a-build-tool>Deploying with a build tool</a></li><li><a href=#3-deploying-with-a-build-server>Deploying with a build server</a></li><li><a href=#final-thoughts>Final thoughts</a></li></ul><p>A co-worker asked me this week about how to deploy a WAR file to Tomcat with Jenkins. In my team we are
currently maintaining and deploying about 10 Java web systems, but we have no consistent way of deploying
the applications to Tomcat yet. In the past I used Ant, Maven, Cargo, Grunt, and Jenkins, so I
decided to write this short post to show a few different ways it can be achieved, à la
<a href="https://en.wikipedia.org/wiki/There's_more_than_one_way_to_do_it">Perl&rsquo;s TMTOWTDI</a> motto.</p><h2><a name=1-deploying-with-custom-scripts style=color:#222>#1 Deploying with custom scripts</a></h2><p>At first you may be tempted to write your own script to deploy to Tomcat with some Shell, Perl, Python
or Java. But I think I would choose this option only because either I needed some feature that is not
available in the other options, or in order to call other tasks or debug some problem.</p><p>Example:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run -d -p 8888:8080 jeanblanchard/tomcat:8
</span></span><span style=display:flex><span>$ git clone https://github.com/spring-projects/spring-petclinic.git <span style=color:#000>&amp;&amp;</span> <span style=color:#a90d91>cd</span> spring-petclinic <span style=color:#000>&amp;&amp;</span> mvn package
</span></span><span style=display:flex><span>$ curl --upload-file target/petclinic.war <span style=color:#c41a16>&#34;http://admin:admin@localhost:8888/manager/text/deploy?path=/spring-petclinic&amp;update=true&#34;</span>
</span></span><span style=display:flex><span>OK - Deployed application at context path /spring-petclinic
</span></span></code></pre></div><h3 id=pros>Pros</h3><ul><li>Flexible option. You can customise the deployment and even call other tasks before, after or during the
deployment</li><li>Easy to get it working, as you have few dependencies and no learning curve for learning about any tool</li></ul><h3 id=cons>Cons</h3><ul><li>Susceptible to bugs (<a href="https://en.wikipedia.org/wiki/Don't_repeat_yourself">DRY</a>)</li><li>You will have to spend time maintaining your scripts if Tomcat changes (e.g. from Tomcat 6 to 7,
the deploy URL changed adding a &lsquo;/text&rsquo; token)</li><li>Integration with other tools, such as a build tool or build server may not be simple</li></ul><h2><a name=2-deploying-with-a-build-tool style=color:#222>#2 Deploying with a build tool</a></h2><p>For this example I will use Apache Maven, but you can achieve the same with Grunt, Ant, Gradle,
or Make. Each of these tools provide different mechanisms to call external tools, some providing
plug-ins that can be used to deploy a WAR file to Tomcat, like Maven and the
<a href=https://codehaus-cargo.github.io/cargo/Maven2+Plugin+Getting+Started.html>Cargo plug-in</a>.</p><p>But even with Maven you have a few options. For example.</p><ul><li>You can use Cargo Maven Plug-in. This plug-in contains several options and lets you abstract how
you interface with Tomcat</li><li>You can use Maven Exec Plug-in and call some command or script that deploys your application to
Tomcat. This script can use Tomcat web services to deploy the application, or execute commands remotely
via SSH in the server, copying the file and stop/starting the services</li><li>You can even write your own plug-in, where it wouldn&rsquo;t be much different than option #1</li></ul><p>Example:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone https://github.com/spring-projects/spring-petclinic.git <span style=color:#000>&amp;&amp;</span> <span style=color:#a90d91>cd</span> spring-petclinic
</span></span></code></pre></div><p>Add the following to the pom.xml file, under the right XML tags, of course.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#177500>&lt;!-- from https://gist.github.com/mdread/5900034 --&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>&lt;plugins&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;plugin&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;groupId&gt;</span>org.codehaus.cargo<span style=color:#000>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;artifactId&gt;</span>cargo-maven2-plugin<span style=color:#000>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;container&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;containerId&gt;</span>tomcat7x<span style=color:#000>&lt;/containerId&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;type&gt;</span>remote<span style=color:#000>&lt;/type&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;/container&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;configuration&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;type&gt;</span>runtime<span style=color:#000>&lt;/type&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;cargo.hostname&gt;</span>${cargo.hostname}<span style=color:#000>&lt;/cargo.hostname&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;cargo.servlet.port&gt;</span>${cargo.servlet.port}<span style=color:#000>&lt;/cargo.servlet.port&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;cargo.tomcat.manager.url&gt;</span>${cargo.tomcat.manager.url}<span style=color:#000>&lt;/cargo.tomcat.manager.url&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;cargo.remote.username&gt;</span>${cargo.remote.username}<span style=color:#000>&lt;/cargo.remote.username&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;cargo.remote.password&gt;</span>${cargo.remote.password}<span style=color:#000>&lt;/cargo.remote.password&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;/properties&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;deployer&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;type&gt;</span>remote<span style=color:#000>&lt;/type&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;/deployer&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;deployables&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;deployable&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;groupId&gt;</span>${project.groupId}<span style=color:#000>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;artifactId&gt;</span>${project.artifactId}<span style=color:#000>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#000>&lt;type&gt;</span>${project.packaging}<span style=color:#000>&lt;/type&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#000>&lt;/deployable&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;/deployables&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;/configuration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/plugin&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>&lt;/plugins&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#000>&lt;profiles&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;profile&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;id&gt;</span>prod<span style=color:#000>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;deploy.env&gt;</span>prod<span style=color:#000>&lt;/deploy.env&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.hostname&gt;</span>srvprd001<span style=color:#000>&lt;/cargo.hostname&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.servlet.port&gt;</span>8080<span style=color:#000>&lt;/cargo.servlet.port&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.tomcat.manager.url&gt;</span>http://srvprd001:8080/manager<span style=color:#000>&lt;/cargo.tomcat.manager.url&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.remote.username&gt;</span>user<span style=color:#000>&lt;/cargo.remote.username&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.remote.password&gt;</span>pass<span style=color:#000>&lt;/cargo.remote.password&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;/properties&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/profile&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;profile&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;id&gt;</span>test<span style=color:#000>&lt;/id&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;properties&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;deploy.env&gt;</span>dev<span style=color:#000>&lt;/deploy.env&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.hostname&gt;</span>srvtst001<span style=color:#000>&lt;/cargo.hostname&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.servlet.port&gt;</span>9090<span style=color:#000>&lt;/cargo.servlet.port&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.tomcat.manager.url&gt;</span>http://srvtst001:9090/manager<span style=color:#000>&lt;/cargo.tomcat.manager.url&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.remote.username&gt;</span>user<span style=color:#000>&lt;/cargo.remote.username&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#000>&lt;cargo.remote.password&gt;</span>pass<span style=color:#000>&lt;/cargo.remote.password&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;/properties&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/profile&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>&lt;/profiles&gt;</span>
</span></span></code></pre></div><p>And finally start Tomcat and call the Cargo Maven plug-in.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run -d -p 8888:8080 jeanblanchard/tomcat:8
</span></span><span style=display:flex><span>$ mvn package org.codehaus.cargo:cargo-maven2-plugin:deploy -Ptest -Dcargo.hostname<span style=color:#000>=</span>localhost -Dcargo.servlet.port<span style=color:#000>=</span><span style=color:#1c01ce>8888</span> -Dcargo.tomcat.manager.url<span style=color:#000>=</span>http://localhost:8888/manager/text -Dcargo.remote.username<span style=color:#000>=</span>admin -Dcargo.remote.password<span style=color:#000>=</span>admin
</span></span></code></pre></div><p>What I like about this approach is that using profiles and environments with Maven, you can have pre-defined
variables per profile, but also overwrite them when necessary. For example in the previous command line,
the host, port, user and password are overwritten to match the default values from the Docker image used.</p><h3 id=pros-1>Pros</h3><ul><li>You are using a tool that is being used by other people. So bugs are fixed much faster and by
a lot of people, with different environments and use cases</li><li>Normally, build tools provide some mechanism for you to parameterise your build, controlling flags
and allowing a more flexible process</li><li>It is a lot easier to find examples and workarounds online</li></ul><h3 id=cons-1>Cons</h3><ul><li>New features depend on how well maintained your build tool or plug-in is. For example, with the Maven Cargo
Plug-in, it took some time till Java 7 was fully supported (but you can submit pull requests/patches)</li><li>There is a learning curve for either learning about the build tool or about its plug-ins and extension
points</li><li>Sometimes you may have to dig into the build tool or plug-in source code to debug problems in your build,
such as JVM or some system library incompatibility</li></ul><h2><a name=3-deploying-with-a-build-server style=color:#222>#3 Deploying with a build server</a></h2><p>Deploying with a build server is not very different from approach #2. For this example I will use Jenkins,
as this is the build server I am most familiar with, and also the one that I am using at work.</p><p>Example:</p><p>Install the <a href=https://wiki.jenkins-ci.org/display/JENKINS/Deploy+Plugin>Deploy Plugin</a> in
Jenkins (it appears as &ldquo;Deploy to container Plugin&rdquo; in the plug-in selection screen), as well as the
git plug-in to check out the project.</p><p>In your job configuration, add a SCM step to clone the petclinic war project, and another step
to invoke a Maven top level target execute <code>mvn package</code>. Also add a post build step to deploy with the following
settings.</p><ul><li>WAR/EAR files: target/*.war</li><li>Context-path: spring-petclinic</li><li>Containers: add Tomcat 7.x</li><li><ul><li>Manager user name: admin</li></ul></li><li><ul><li>Manager password: admin</li></ul></li><li><ul><li>Tomcat URL: http://localhost:8888</li></ul></li></ul><p>Instead of a screenshot, here is the config.xml file for my example job - easier to diff your job
configuration.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#633820>&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>&lt;project&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;actions/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;description&gt;&lt;/description&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;keepDependencies&gt;</span>false<span style=color:#000>&lt;/keepDependencies&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;properties/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;scm</span> <span style=color:#836c28>class=</span><span style=color:#c41a16>&#34;hudson.plugins.git.GitSCM&#34;</span> <span style=color:#836c28>plugin=</span><span style=color:#c41a16>&#34;git@2.4.3&#34;</span><span style=color:#000>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;configVersion&gt;</span>2<span style=color:#000>&lt;/configVersion&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;userRemoteConfigs&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;hudson.plugins.git.UserRemoteConfig&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;url&gt;</span>https://github.com/spring-projects/spring-petclinic.git<span style=color:#000>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;/hudson.plugins.git.UserRemoteConfig&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/userRemoteConfigs&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;branches&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;hudson.plugins.git.BranchSpec&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;name&gt;</span>*/master<span style=color:#000>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;/hudson.plugins.git.BranchSpec&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/branches&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;doGenerateSubmoduleConfigurations&gt;</span>false<span style=color:#000>&lt;/doGenerateSubmoduleConfigurations&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;submoduleCfg</span> <span style=color:#836c28>class=</span><span style=color:#c41a16>&#34;list&#34;</span><span style=color:#000>/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;/scm&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;canRoam&gt;</span>true<span style=color:#000>&lt;/canRoam&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;disabled&gt;</span>false<span style=color:#000>&lt;/disabled&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;blockBuildWhenDownstreamBuilding&gt;</span>false<span style=color:#000>&lt;/blockBuildWhenDownstreamBuilding&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;blockBuildWhenUpstreamBuilding&gt;</span>false<span style=color:#000>&lt;/blockBuildWhenUpstreamBuilding&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;triggers/&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;concurrentBuild&gt;</span>false<span style=color:#000>&lt;/concurrentBuild&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;builders&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;hudson.tasks.Maven&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;targets&gt;</span>clean package<span style=color:#000>&lt;/targets&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;mavenName&gt;</span>3.3.9<span style=color:#000>&lt;/mavenName&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;usePrivateRepository&gt;</span>false<span style=color:#000>&lt;/usePrivateRepository&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;settings</span> <span style=color:#836c28>class=</span><span style=color:#c41a16>&#34;jenkins.mvn.DefaultSettingsProvider&#34;</span><span style=color:#000>/&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;globalSettings</span> <span style=color:#836c28>class=</span><span style=color:#c41a16>&#34;jenkins.mvn.DefaultGlobalSettingsProvider&#34;</span><span style=color:#000>/&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/hudson.tasks.Maven&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;/builders&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;publishers&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;hudson.plugins.deploy.DeployPublisher</span> <span style=color:#836c28>plugin=</span><span style=color:#c41a16>&#34;deploy@1.10&#34;</span><span style=color:#000>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;adapters&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;hudson.plugins.deploy.tomcat.Tomcat7xAdapter&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#000>&lt;userName&gt;</span>admin<span style=color:#000>&lt;/userName&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#000>&lt;passwordScrambled&gt;</span>YWRtaW4=<span style=color:#000>&lt;/passwordScrambled&gt;</span>
</span></span><span style=display:flex><span>          <span style=color:#000>&lt;url&gt;</span>http://localhost:8888<span style=color:#000>&lt;/url&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#000>&lt;/hudson.plugins.deploy.tomcat.Tomcat7xAdapter&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;/adapters&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;contextPath&gt;</span>spring-petclinic<span style=color:#000>&lt;/contextPath&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;war&gt;</span>target/*.war<span style=color:#000>&lt;/war&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#000>&lt;onFailure&gt;</span>false<span style=color:#000>&lt;/onFailure&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#000>&lt;/hudson.plugins.deploy.DeployPublisher&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;/publishers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#000>&lt;buildWrappers/&gt;</span>
</span></span><span style=display:flex><span><span style=color:#000>&lt;/project&gt;</span>
</span></span></code></pre></div><p>When running this job, you should see in the end of the console output, something similar to this.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> Building war: /tmp/1/jobs/deploy01/workspace/target/petclinic.war
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> ------------------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> BUILD SUCCESS
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> ------------------------------------------------------------------------
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> Total time: 20.590 s
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> Finished at: 2016-03-20T19:13:51+13:00
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> Final Memory: 36M/359M
</span></span><span style=display:flex><span><span style=color:#000>[</span>INFO<span style=color:#000>]</span> ------------------------------------------------------------------------
</span></span><span style=display:flex><span>Deploying /tmp/1/jobs/deploy01/workspace/target/petclinic.war to container Tomcat 7.x Remote
</span></span><span style=display:flex><span>  <span style=color:#000>[</span>/tmp/1/jobs/deploy01/workspace/target/petclinic.war<span style=color:#000>]</span> is not deployed. Doing a fresh deployment.
</span></span><span style=display:flex><span>  Deploying <span style=color:#000>[</span>/tmp/1/jobs/deploy01/workspace/target/petclinic.war<span style=color:#000>]</span>
</span></span><span style=display:flex><span>Finished: SUCCESS
</span></span></code></pre></div><p>You can chain several jobs, creating a pipeline with one job to build, one for functional tests, and
another job to deploy.</p><h3 id=pros-2>Pros</h3><ul><li>Since you are using Jenkins you can also chain other tools together, as well as other jobs, creating a build
pipeline (doable with the other two approaches, but just harder IMO)</li><li>Like in option #2, you can use parameters and customise the behaviour of the tools used</li><li>You can use Jenkins remote API or CLI to chain other tools or react to events in other systems
(harder to achieve with the other approaches)</li></ul><h3 id=cons-2>Cons</h3><ul><li>There is a learning curve for learning Jenkins, as well as any plug-in or other tools that you may be using</li><li>You have to maintain a new infrastructure with Jenkins</li><li>When new versions of containers are released, Jenkins developers, and plug-in developers may have to update and
release an updated plug-in to be able to support these versions. You have to wait till that happens to use
the plug-in (or submit a patch/pull request)</li></ul><h2><a name=final-thoughts style=color:#222>Final thoughts</a></h2><p>Whenever I can, I try to avoid reinventing the wheel. The less code I write, and the more good quality
code that I reuse, the merrier for me. So approach #1 is my less favorite way of deploying WAR files to
Tomcat.</p><p><strong>My preferred approach for deploying WAR files to Tomcat, is a mix of #2 and #3</strong>.</p><p>You configure the deploy tasks in your build tool, be it Maven, Grunt, Ant, or etc. And configure a job
in Jenkins to check out the code and deploy it, calling your build tool.</p><p>Using the previous examples, you would configure profiles in your pom.xml, and also combine parameters
in Jenkins to define which profile to activate (as well as override parameters if necessary).</p><p>This way you give developers the power to choose how/where to deploy. In case they need to deploy to a
different environment, they can change the build scripts, commit, and wait for Jenkins to be ready to
deploy. Leaving the deployment environment configuration in Jenkins jobs would require developers to
request changes in jobs, which would slow down the development pipeline.</p><p>Furthermore, you can also overwrite values in the build tools, so you can still control it in the build
server too. And you are getting the best of both worlds, having Jenkins parameters, over 1000 plug-ins,
and being able to create a build workflow/pipeline.</p><p>But remember, that is my opinion. I hope you can assimilate everything you have read here, and choose
what will work best in your case.</p><p>Happy hacking!</p><p>Categories:
<a href=/categories/blog.html>Blog</a></p><p>Tags:
<a href=/tags/jenkins.html>Jenkins</a>,
<a href=/tags/tomcat.html>Tomcat</a>,
<a href=/tags/docker.html>Docker</a></p><aside class=links><a class=previous href=https://kinoshita.eti.br/2016/03/20/drawing-sketch-cheese.html>&#171; Previous</a><a class=next href=https://kinoshita.eti.br/2016/04/08/geek-vacation-2016.html>Next &#187;</a></aside></article></main><footer role=contentinfo><ul id=social-media-icons><li><a href=https://www.instagram.com/brunokinoshita/><img src=/assets/icons/instagram.png alt="Instagram link"></a></li><li><a href=https://bsky.app/profile/kinow.bsky.social><img src=/assets/icons/bluesky.png alt="BlueSky link"></a></li><li><a href=https://twitter.com/kinow/><img src=/assets/icons/twitter.png alt="Twitter link"></a></li><li><a href=https://github.com/kinow/><img src=/assets/icons/github.png alt="GitHub link"></a></li><li><a href=/feed.xml><img src=/assets/icons/news.png alt="RSS feed link"></a></li></ul></footer></body></html>