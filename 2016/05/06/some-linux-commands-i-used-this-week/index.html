  
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head profile="http://gmpg.org/xfn/11">
    <title>Bruno P. Kinoshita &mdash; Some Linux commands I used this week</title> 
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="Bruno de Paula Kinoshita personal web site" />
    <meta name="keywords"
        content="kinoshita, bruno de paula kinoshita, geek, geek stuff, java, python, c, c++, msn now playing, neural network, mackenzie, sao paulo, brasil, brazil, nerd, nerd stuff, cool, jenkins, illustration, quadrinhos, machine learning, linguistic, apache, open source, codigo livre, codigo aberto" />
    <meta name="author" content="" />
    <meta name="generator" content="PieCrust 3.2.1" />
    <meta name="template-engine" content="Twig" />
    <meta name="robots" content="all=index,follow" />
    <meta name="revisit-after" content="15 days" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta name="distribution" content="Global" />
    <meta name="url" content="/" />
    <meta name="copyright" content="Bruno de Paula Kinoshita" />
    <meta name="Googlebot" content="all" />
    <meta name="rating" content="general" />
    <meta http-equiv="expires" content="0" />
    <meta name="city" content="Sao Paulo" />
    <meta name="state" content="Brasil, Sao Paulo" />
    <meta http-equiv="content-language" content="en" />
    <meta http-equiv="imagetoolbar" content="no" />
    <meta id="page_favicon" href="/favicon.ico" rel="icon" type="image/x-icon" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="alternate" type="application/rss+xml" title="Bruno P. Kinoshita &raquo; Feed" href="/feed.xml" />
    <link rel="stylesheet" href="/css/semantic/dist/semantic.min.css" type="text/css" media="screen, projection" />
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen, projection" />
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="/css/blueprint/ie.css" type="text/css" media="screen, projection" />
    <![endif]-->
    <link rel="stylesheet" href="/css/prettyPhoto.css" type="text/css" media="all" />
</head>
<body id="body">
    <div class="ui vertical sidebar menu" id="toc">
        <nav class="menu" role="navigation">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/art">Art</a>
    </div>
    <div class="item">
      <a href="/presentations/">Presentations</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
</nav>
<a href="/about/"><img src="/img/bruno.jpg" title="Hmmmm" alt="My picture" width="134px" height="215px" /></a>
    </div>
    <div class="ui black big launch right attached fixed button">
        <i class="content icon"></i>
        <span class="text">Menu</span>
    </div>
    <div class="ui fixed inverted main menu">
        <div class="ui container">
            <a class="launch icon item">
                <i class="content icon"></i>
            </a>
            <div class="item">
                Some Linux commands I used this week
            </div>
        </div>
    </div>
    <div class="pusher">
        <div class="full height">
            <div class="toc">
                <div class="ui vertical sticky fixed top menu">
                    <nav class="menu" role="navigation">
    <div class="item">
        <a href="/" class="main-link">Kinoshita</a>
    </div>
    <div class="item">
        <a href="/art">Art</a>
    </div>
    <div class="item">
      <a href="/presentations/">Presentations</a>
    </div>
    <div class="item">
        <a href="/contact/">Contact</a>
    </div>
</nav>
<a href="/about/"><img src="/img/bruno.jpg" title="Hmmmm" alt="My picture" width="134px" height="215px" /></a>
                </div>
            </div>
            <div class="article">
                <div class="main container" role="main">

                
<div class="ui raised padded container segment">
  <h1 class='post-topic'>Some Linux commands I used this week</h1>
  <small>kinow</small> @
	<small>2016-05-06&nbsp;23:26:03 (<span class='stardate' data-input-date='2016-05-06'></span>)</small>
  <div class="entry">
    





<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://kinoshita.eti.br/2016/05/06/some-linux-commands-i-used-this-week" data-text="Some Linux commands I used this week" data-via="kinow" data-hashtags="opensource">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p='https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

	  <p>These are some commands I used on Linux servers this week. Adding them here in case someone else
find them interesting, and also due to my bad memory :-)</p>
<h2>Listing latest installed packages in SLES</h2>
<div class="highlight"><pre><span></span>rpm -qa --last
</pre></div>

<p>This will display the last packages installed. Useful when there are packages being updated, and you
need to confirm what changed, and when.</p>
<h2>Listing packages in SLES and origin repository</h2>
<div class="highlight"><pre><span></span>rpm -qa --qf <span class="s1">&#39;%-30{DISTRIBUTION} %{NAME}\n&#39;</span><span class="p">|</span> sort
</pre></div>

<p>The output will have two columns. The first containing the repository name, and the second column with
the package name. For example.</p>
<div class="highlight"><pre><span></span>devel:languages:R:base / SLE_11_SP2 R-base
devel:languages:R:base / SLE_11_SP2 R-base-devel
home:flacco:sles / SLE_11_SP3 php53-phar
home:happenpappen / SLE_11_SP2 nodejs
</pre></div>

<h2>Grep for content in XML tags</h2>
<p>Be it for web services, or for finding things in Jenkins XML files. Being able to grep the tag attribute
or tag name might be useful. Look at the following example that uses the 
<a href="https://msdn.microsoft.com/en-us/library/ms762271%28v=vs.85%29.aspx">books XML provided by Microsoft for testing</a>.</p>
<div class="highlight"><pre><span></span>grep -oP <span class="s2">&quot;(?&lt;=&lt;genre&gt;).*?(?=&lt;/genre&gt;)&quot;</span> books.xml <span class="p">|</span> sort <span class="p">|</span> uniq
</pre></div>

<p>Which will outputs the following.</p>
<div class="highlight"><pre><span></span>Computer
Fantasy
Horror
Romance
Science Fiction
</pre></div>

<h2>Find Python site packages directory</h2>
<p>Sometimes you have Anaconda, but also the system installation, and maybe even other Python distributions.
Knowing where Python is looking for site packages can be helpful to confirm the package exists, and also
to inspect its sources.</p>
<div class="highlight"><pre><span></span>python -c <span class="s2">&quot;from distutils.sysconfig import get_python_lib; print(get_python_lib())&quot;</span>
</pre></div>

<p>An example of the output of the script.</p>
<div class="highlight"><pre><span></span>/usr/lib/python2.7/dist-packages
</pre></div>

<h2>Force no-cache via curl for a list of files</h2>
<p>Useful when you have a proxy like squid caching some requests from an application and you
want to flush the cache and get the latest content (which will be cached again, but then
you can fix it once confirmed).</p>
<div class="highlight"><pre><span></span>curl --silent -H <span class="s1">&#39;Cache-Control: no-cache&#39;</span> http://systemcachingvalues.local/somedoc.html
</pre></div>

<h2>Find to which servers a Linux process is talking to</h2>
<p>You have to find the pid of the process that you would like to investigate (e.g. 6364) and have
<a href="http://linux.die.net/man/1/strace">strace</a> installed.</p>
<div class="highlight"><pre><span></span>strace -p <span class="m">6364</span> -f -e <span class="nv">trace</span><span class="o">=</span>network -o output.txt
</pre></div>

<p>The command above creates output.txt with the trace information. Then you can grep for
the IP addresses with the following regex.</p>
<div class="highlight"><pre><span></span>grep -E -o <span class="s2">&quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;</span> output.txt
</pre></div>

<p>Which will output something similar to the following example.</p>
<div class="highlight"><pre><span></span><span class="m">127</span>.0.1.1
<span class="m">127</span>.0.1.1
<span class="m">127</span>.0.1.1
<span class="m">192</span>.168.20.4
<span class="m">10</span>.10.0.12
...
</pre></div>

<p>And finally, you can call dig to get the server name, and also remove duplicates.</p>
<div class="highlight"><pre><span></span>grep -E -o <span class="s2">&quot;(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)&quot;</span> output.txt <span class="p">|</span> xargs -l dig +noall +answer +nocmd -x <span class="p">|</span> awk <span class="s1">&#39;{ print $5}&#39;</span> <span class="p">|</span> sort <span class="p">|</span> uniq
</pre></div>

<p>Which gives you the following.</p>
<div class="highlight"><pre><span></span>ec2-52-13-43-205.compute-1.amazonaws.com.
ec2-52-32-244-147.compute-1.amazonaws.com.
ec2-52-44-11-85.compute-1.amazonaws.com.
ec2-52-55-36-20.us-west-2.compute.amazonaws.com.
ec2-52-11-19-24.us-west-2.compute.amazonaws.com.
ec2-52-2-21-13.compute-1.amazonaws.com.
ec2-54-33-249-49.us-west-2.compute.amazonaws.com.
ec2-54-180-165-17.us-west-2.compute.amazonaws.com.
ec2-54-2-177-91.compute-1.amazonaws.com.
ec2-54-8-163-15.compute-1.amazonaws.com.
syd11s01-in-f124.1e110.net.
syd11s02-in-f5.1e110.net.
syd12s02-in-f3.1e110.net.
...
</pre></div>

<p>That&#8217;s all for today.</p>
<p>Happy hacking!</p>
  </div>
  <p class="postmetadata">
    
    <small>tags [&nbsp;<a href="/tag/linux" rel="tag">linux</a>&nbsp;]&nbsp;</small>
    
    
    <br/>
    <small>posted in [&nbsp;<a href="/blog" title="View all posts in blog" rel="category tag">blog</a>&nbsp;]&nbsp; category </small>
    
  </p>
  
</div>

                </div>
            </div>
        </div>
        <div class="ui vertical footer segment">
            <div class="ui center aligned container">
                           <div id="copy" class="">
                <p>&copy; <a href="/about"><span
                            class="b">Bru</span><span
                            class="r">no de</span> <span
                            class="a">Paula</span> <span
                            class="s"></span><span
                            class="i">Kinos</span><span
                            class="l">hita</span></a>
                </p>
            </div>
            </div>
         </div>
    </div>
</body>
</html>
<script src="/js/jquery-2.2.3.min.js"  type="text/javascript"></script>
<script src="/css/semantic/dist/semantic.min.js"  type="text/javascript"></script>
<script src="/js/jquery.prettyPhoto.js"></script>
<script src="/js/site.js"></script>